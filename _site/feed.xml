<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-12-15T23:04:24+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Joshua Kim</title><subtitle>Data Analyst</subtitle><entry><title type="html">Data Warehouse #05</title><link href="http://localhost:4000/data-warehouse-05/" rel="alternate" type="text/html" title="Data Warehouse #05" /><published>2023-12-06T00:00:00+09:00</published><updated>2023-12-06T00:00:00+09:00</updated><id>http://localhost:4000/data-warehouse-05</id><content type="html" xml:base="http://localhost:4000/data-warehouse-05/"><![CDATA[<blockquote>
  <p>In this article, Iâ€™ll summarize key takeaways from:</p>
  <ul>
    <li>SECTION 05. Facts</li>
  </ul>
</blockquote>

<h3 id="disclaimer">DISCLAIMER</h3>
<blockquote>
  <p>This article is a compilation of key takeaways after completing  <a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Data Warehouse â€” The Ultimate Guide</a>  on Udemy. However, it may be challenging to achieve a comprehensive and deep understanding of Data Warehouse solely through this article. For your in-depth learning, please take the course, which is an excellent resource, and I personally highly recommend it to those who are eager to master data warehousing, dimensional modeling, and the ETL process.</p>
</blockquote>

<p><img src="/assets/2023-12-06-data-warehouse-05/data-warehouse.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Source</a></p>
</blockquote>

<h1 id="additivity-in-facts">Additivity in Facts</h1>

<p><strong>1. Fully Additive Facts</strong></p>
<ul>
  <li>Can be added across  <strong>all dimensions</strong></li>
  <li>Most Flexible &amp; Useful</li>
  <li><strong>Most fact tables</strong>  are fully additive!</li>
</ul>

<p><strong>2. Semi-additive Facts</strong></p>
<ul>
  <li>Can be added across  <strong>a few dimensions</strong></li>
  <li>Less Flexible &amp; Used Carefully</li>
  <li><strong>Averaging</strong>  might be an alternative! (i.e.,  <strong>Balance</strong>)</li>
</ul>

<p><strong>3. Non-additive Facts</strong></p>
<ul>
  <li>Can  <strong>NOT</strong>  be added across  <strong>any dimensions</strong></li>
  <li>Limited Analytical</li>
  <li>Store the  <strong>underlying values</strong>  instead! (i.e.,  <strong>Ratio</strong>,  <strong>Percentage</strong>,  <strong>Price</strong>, etc.)</li>
</ul>

<h3 id="1-fully-additive-facts">1. Fully Additive Facts</h3>
<ul>
  <li>Given the tables below:</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/fully-additive-facts-1.webp" alt="" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">units</code>  are  <strong>additive</strong>.</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/fully-additive-facts-2.webp" alt="" /></p>

<h3 id="2-semi-additive-facts">2. Semi-additive Facts</h3>

<ul>
  <li>Given the tables below:</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/semi-additive-facts-1.webp" alt="" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">balance</code>  is  <strong>semi-additive</strong>.</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/semi-additive-facts-2.webp" alt="" /></p>

<h3 id="3-non-additive-facts">3. Non-additive Facts</h3>

<ul>
  <li>Given the tables below:</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/non-additive-facts-1.webp" alt="" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">price</code>  is  <strong>non-additive</strong>.</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/non-additive-facts-2.webp" alt="" /></p>

<h1 id="year-to-date-in-facts">Year-to-Date in Facts</h1>

<p><strong>Month-to-Date, Quarter-to-Date, Year-to-Date</strong></p>
<ul>
  <li>Often requested by business users</li>
  <li>Tempted to store them in columns</li>
  <li><strong>DO NOT store them in Fact Tables!</strong>
    <ul>
      <li>Instead, better store  <strong>the underlying values</strong>  in Fact Tables!</li>
    </ul>
  </li>
</ul>

<h1 id="types-of-fact-tables">Types of Fact Tables</h1>

<p><strong>1. Transactional Fact Tables</strong>
<strong>2. Periodic Snapshot Fact Tables</strong>
<strong>3. Accumulating Snapshot Fact Tables</strong></p>

<h3 id="1-transactional-fact-tables">1. Transactional Fact Tables</h3>

<ul>
  <li>1 Row = Measurement of 1 Event/Transaction</li>
  <li>It takes place at a specific time.</li>
  <li>One transaction defines the lowest grain.</li>
</ul>

<p><strong>Characteristics</strong></p>
<ul>
  <li>Most Common &amp; Very Flexible</li>
  <li>Typically Additive</li>
  <li>Other dimension tables associated â¬†ï¸</li>
  <li>Size â¬†ï¸â¬†ï¸</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/transactional-fact-tables.webp" alt="" /></p>

<h3 id="2-periodic-snapshot-fact-tables">2. Periodic Snapshot Fact Tables</h3>

<ul>
  <li>1 Row = Summarizes Measurement of Many Events/Transactions</li>
  <li>Summarized of standard period (i.e., 1 day, 1 week, etc.)</li>
  <li>One period defines the lowest grain.</li>
</ul>

<p><strong>Characteristics</strong></p>
<ul>
  <li>No Events = NULL or 0</li>
  <li>Typically Additive</li>
  <li>Other fact tables associated â¬†ï¸ / Other dimension tables associated â¬‡ï¸</li>
  <li>Size â¬‡ï¸</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/periodic-snapshot-fact-tables.webp" alt="" /></p>

<h3 id="3-accumulating-snapshot-fact-tables">3. Accumulating Snapshot Fact Tables</h3>

<ul>
  <li>1 Row = Summarizes Measurement of Many Events/Transactions</li>
  <li>Summarized of the lifespan of 1 process (i.e., order fulfillment)</li>
  <li>Definite beginning &amp; Definite ending (with steps)</li>
</ul>

<p><strong>Characteristics</strong></p>
<ul>
  <li>Least Common</li>
  <li>Workflow or Process Analysis</li>
  <li>Multiple Datetime Foreign Keys (for each process step)</li>
  <li>Other Datetime dimension tables associated â¬†ï¸â¬†ï¸â¬†ï¸</li>
  <li>Size â¬‡ï¸â¬‡ï¸â¬‡ï¸</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/accumulating-snapshot-fact-tables.webp" alt="" /></p>

<h1 id="steps-to-create-a-fact-table">Steps to Create a Fact Table</h1>

<p><img src="/assets/2023-12-06-data-warehouse-05/steps-to-create-a-fact-table.webp" alt="" /></p>

<h3 id="4-key-decisions">4 Key Decisions</h3>

<p><strong>1. Identify a business process for analysis.</strong></p>
<ul>
  <li>Examples: Sales, Order processing</li>
</ul>

<p><strong>2. Declare the grain.</strong></p>
<ul>
  <li>Examples: Transaction, Order, Order lines, Daily, Location</li>
</ul>

<p><strong>3. Identify relevant dimensions.</strong></p>
<ul>
  <li>â€œFiltering &amp; Groupingâ€</li>
  <li>â€œSoulâ€ for Analysis</li>
  <li>Examples: Time, Locations, Product Category, Users</li>
</ul>

<p><strong>4. Identify facts for measurement.</strong></p>
<ul>
  <li>Defined by the grain! (Not by specific use cases)</li>
  <li>Examples: Revenue, Order Amount</li>
</ul>

<h1 id="factless-fact-tables">Factless Fact Tables</h1>

<p>Only dimensional aspects of an event are recorded.</p>
<ul>
  <li>How many employees have been registered last month?</li>
  <li>How many employees have been registered in a certain region?</li>
</ul>

<p>There are no measurement columns in the Factless Fact Tables.</p>

<p><img src="/assets/2023-12-06-data-warehouse-05/factless-fact-tables.webp" alt="" /></p>
<blockquote>
  <p><a href="https://learn.microsoft.com/ko-kr/power-bi/guidance/star-schema#factless-fact-tables">Source</a></p>
</blockquote>

<h1 id="natural-vs-surrogate-key">Natural vs. Surrogate Key</h1>

<h3 id="natural-key">Natural Key</h3>
<ul>
  <li>Comes out of the source system</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/natural-keys.webp" alt="" /></p>

<h3 id="surrogate-key">Surrogate Key</h3>
<ul>
  <li>Artificial Keys</li>
  <li>Integer Number</li>
  <li><code class="language-plaintext highlighter-rouge">_PK</code> or <code class="language-plaintext highlighter-rouge">_FK</code> suffixes</li>
  <li>Created by the Database or ETL Tool</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/surrogate-keys.webp" alt="" /></p>

<p><strong>Benefits of Surrogate Key</strong></p>
<ul>
  <li>Improve performance (Storage â¬‡ï¸, Easy Joins â¬†ï¸)</li>
  <li>Handle dummy values such as NULLs or Missing Values (using 999 or -1)</li>
  <li>Integrate multiple source systems</li>
  <li>Easier Administration &amp; Updates</li>
  <li>Sometimes there are even NO Natural Keys available.</li>
</ul>

<p><strong>Practical Guidelines of Surrogate Key</strong></p>
<ul>
  <li>Always use Surrogate Keys in tables as Main PK and FK</li>
  <li>Use Surrogate Keys both for Fact &amp; Dimension Tables (Except the Date Dimension Tables)</li>
  <li>Optionally keep the Natural Keys</li>
</ul>

<h1 id="case-study-e-commerce">Case Study: E-commerce</h1>

<h3 id="data-collection">Data Collection</h3>
<ul>
  <li>Shopping Cart Checkouts</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/data-collection-1.webp" alt="" /></p>

<p><img src="/assets/2023-12-06-data-warehouse-05/data-collection-2.webp" alt="" /></p>

<h3 id="goals">Goals</h3>
<ul>
  <li>Maximizing Profits (profit margins, sales volume, product cost, promotions, and discounts)</li>
</ul>

<h3 id="1-identify-a-business-process-for-analysis">1. Identify a business process for analysis.</h3>
<ul>
  <li>Which products have been sold?</li>
  <li>How much is the sales profit?</li>
  <li>How much is the sales profit for each website?</li>
  <li>How much is the performance on each different day?</li>
  <li>What does the sales trend look like over time?</li>
</ul>

<h3 id="2-declare-the-grain">2. Declare the grain.</h3>
<ul>
  <li>The grains should have the most analytical values</li>
  <li>The grains should have the highest dimensionalities.</li>
  <li>In this case:  <code class="language-plaintext highlighter-rouge">order_id</code>  and  <code class="language-plaintext highlighter-rouge">product_id</code></li>
</ul>

<h3 id="3-identify-relevant-dimensions">3. Identify relevant dimensions.</h3>
<ul>
  <li>Dimensions should be the descriptive aspects of measures.</li>
  <li>Dimensions should be naturally derived after the grains are defined.</li>
  <li>In this case:  <code class="language-plaintext highlighter-rouge">customers</code>,  <code class="language-plaintext highlighter-rouge">products</code>,  <code class="language-plaintext highlighter-rouge">promotions</code>,  <code class="language-plaintext highlighter-rouge">datetimes</code>,  <code class="language-plaintext highlighter-rouge">websites</code></li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/identify-relevant-dimensions.webp" alt="" /></p>

<h3 id="4-identify-facts-for-measurement">4. Identify facts for measurement.</h3>
<ul>
  <li>The facts must comply with the grains that we have defined above.</li>
  <li><code class="language-plaintext highlighter-rouge">discount</code>: additive vs. non-additive</li>
  <li><code class="language-plaintext highlighter-rouge">profit</code> : also complies with the grain</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-05/identify-facts-for-measurement.webp" alt="" /></p>

<h3 id="5-final-results">5. Final Results</h3>

<p><img src="/assets/2023-12-06-data-warehouse-05/final-results.webp" alt="" /></p>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="sql" /><category term="data_warehouse" /><summary type="html"><![CDATA[In this article, Iâ€™ll summarize key takeaways from: SECTION 05. Facts]]></summary></entry><entry><title type="html">Data Warehouse #03</title><link href="http://localhost:4000/data-warehouse-03/" rel="alternate" type="text/html" title="Data Warehouse #03" /><published>2023-12-06T00:00:00+09:00</published><updated>2023-12-06T00:00:00+09:00</updated><id>http://localhost:4000/data-warehouse-03</id><content type="html" xml:base="http://localhost:4000/data-warehouse-03/"><![CDATA[<blockquote>
  <p>In this article, Iâ€™ll summarize key takeaways from:</p>
  <ul>
    <li>SECTION 03. Data Warehouse Architecture</li>
  </ul>
</blockquote>

<h3 id="disclaimer">DISCLAIMER</h3>

<blockquote>
  <p>This article is a compilation of key takeaways after completing  <a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Data Warehouse â€” The Ultimate Guide</a>  on Udemy. However, it may be challenging to achieve a comprehensive and deep understanding of Data Warehouse solely through this article. For your in-depth learning, please take the course, which is an excellent resource, and I personally highly recommend it to those who are eager to master data warehousing, dimensional modeling, and the ETL process.</p>
</blockquote>

<p><img src="/assets/2023-12-06-data-warehouse-03/data-warehouse.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Source</a></p>
</blockquote>

<h1 id="data-lake-vs-data-warehouse">Data Lake vs. Data Warehouse</h1>

<p><img src="/assets/2023-12-06-data-warehouse-03/data-lake-vs-data-warehouse.webp" alt="" /></p>

<h1 id="pentaho--postgresql">Pentaho &amp; PostgreSQL</h1>

<h3 id="pentaho">Pentaho</h3>

<ul>
  <li><strong>ETL Tool</strong></li>
  <li><a href="https://www.hitachivantara.com/en-us/products/pentaho-plus-platform/data-integration-analytics/pentaho-community-edition.html">Pentaho Community Edition Download</a></li>
  <li><code class="language-plaintext highlighter-rouge">pdi-ce-9.4.0.0-343.zip</code></li>
  <li>After unzipping the downloaded file, click the  <code class="language-plaintext highlighter-rouge">spoon</code>  file.</li>
</ul>

<h3 id="postgresql">PostgreSQL</h3>

<ul>
  <li><strong>Database Management System</strong></li>
  <li><a href="https://www.postgresql.org/download/">PostgreSQL Download</a></li>
  <li>After installing the downloaded file, run  <code class="language-plaintext highlighter-rouge">PGAdmin</code>.</li>
</ul>

<h1 id="the-layers-of-a-data-warehouse">The Layers of a Data Warehouse</h1>

<p><img src="/assets/2023-12-06-data-warehouse-03/The Layers of a Data Warehouse.webp" alt="" /></p>

<h3 id="data-sources--the-staging-layer">Data Sources â†’ The Staging Layer</h3>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">E</code></strong> of ETL Process</li>
  <li><strong>â€œThe Landing Zone Extracted Dataâ€</strong>
    <ul>
      <li>Data in Tables and on a Separate Database</li>
      <li>As little â€œtoughingâ€ as possible</li>
      <li>We donâ€™t charge the source systems.</li>
      <li>Temporary or Persistent Staging Layers</li>
    </ul>
  </li>
  <li>Short Time on the Source Systems</li>
  <li>Quickly Extracted</li>
  <li>Move the Data into Relational Database</li>
  <li>Start Transformations from There</li>
  <li>Minimal Transformation</li>
</ul>

<h3 id="the-staging-layer--the-cleansing-layer">The Staging Layer â†’ The Cleansing Layer</h3>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">TL</code></strong> of ETL Process</li>
</ul>

<h3 id="the-cleansing-layer--core--access-layer--data-warehouse">The Cleansing Layer â†’ Core / Access Layer / Data Warehouse</h3>
<ul>
  <li><strong>â€œCoreâ€</strong>
    <ul>
      <li>Business Logic</li>
    </ul>
  </li>
</ul>

<h3 id="core--access-layer--data-warehouse--data-mart">Core / Access Layer / Data Warehouse â†’ Data Mart</h3>
<ul>
  <li><strong>â€œData Martâ€</strong>
    <ul>
      <li>Subset of a Data Warehouse</li>
      <li>Dimensional Model</li>
      <li>Can be Further Aggregated.</li>
      <li>Usability + Acceptance</li>
      <li>Performance</li>
    </ul>
  </li>
  <li>Can Vary depending on Each Tool, Each Department, Each Region, Each Usecase</li>
</ul>

<h1 id="in-memory-databases">In-memory Databases</h1>

<h3 id="traditional-databases">Traditional Databases</h3>

<p><img src="/assets/2023-12-06-data-warehouse-03/traditional-databases.webp" alt="" /></p>

<h3 id="in-memory-databases-1">In-memory Databases</h3>

<p><img src="/assets/2023-12-06-data-warehouse-03/in-memory-databases.webp" alt="" /></p>

<ul>
  <li>Highly Optimized for Query Performance</li>
  <li>Good for Analytics &amp; High Query Volume</li>
  <li>Usually Used for Data Marts</li>
  <li>Relational &amp; Non-relational</li>
  <li>Techniques: Columnar Storage, Parallel Query Plans, and Others</li>
</ul>

<h1 id="demo-setting-up-the-staging-area-with-postgresql">Demo: Setting up the Staging Area with PostgreSQL</h1>

<p><img src="/assets/2023-12-06-data-warehouse-03/pgadmin4.webp" alt="" /></p>
<ul>
  <li>Created a  <strong>database</strong>  named  <code class="language-plaintext highlighter-rouge">DataWarehouseX</code>.</li>
  <li>Created a  <strong>schema</strong>  named  <code class="language-plaintext highlighter-rouge">Staging</code>.</li>
</ul>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="sql" /><category term="data_warehouse" /><summary type="html"><![CDATA[In this article, Iâ€™ll summarize key takeaways from: SECTION 03. Data Warehouse Architecture]]></summary></entry><entry><title type="html">Data Warehouse #01-02</title><link href="http://localhost:4000/data-warehouse-01-02/" rel="alternate" type="text/html" title="Data Warehouse #01-02" /><published>2023-12-06T00:00:00+09:00</published><updated>2023-12-06T00:00:00+09:00</updated><id>http://localhost:4000/data-warehouse-01-02</id><content type="html" xml:base="http://localhost:4000/data-warehouse-01-02/"><![CDATA[<blockquote>
  <p>In this article, Iâ€™ll summarize key takeaways from:</p>
  <ul>
    <li>SECTION 01. Introduction</li>
    <li>SECTION 02. Data Warehouse Basics</li>
  </ul>
</blockquote>

<h3 id="disclaimer">DISCLAIMER</h3>

<blockquote>
  <p>This article is a compilation of key takeaways after completing  <a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Data Warehouse â€” The Ultimate Guide</a>  on Udemy. However, it may be challenging to achieve a comprehensive and deep understanding of Data Warehouse solely through this article. For your in-depth learning, please take the course, which is an excellent resource, and I personally highly recommend it to those who are eager to master data warehousing, dimensional modeling, and the ETL process.</p>
</blockquote>

<p><img src="/assets/2023-12-06-data-warehouse-01-02/data-warehouse.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Source</a></p>
</blockquote>

<h1 id="what-will-you-learn">What Will You Learn?</h1>

<ul>
  <li>Data Warehouse Basics</li>
  <li>Data Warehouse Architecture</li>
  <li>Dimensional Modeling</li>
  <li>Fact Tables</li>
  <li>Dimension Tables</li>
  <li>Slowly Changing Dimensions</li>
  <li>ETL Process</li>
  <li>ETL Tools</li>
  <li>Case Study: Create a Data Warehouse</li>
  <li>ETL vs. ELT</li>
  <li>Using a Data Warehouse</li>
  <li>Optimizing a Data Warehouse</li>
  <li>The Modern Data Warehouse</li>
</ul>

<h1 id="why-do-we-need-a-data-warehouse">Why Do We Need a Data Warehouse?</h1>

<p><img src="/assets/2023-12-06-data-warehouse-01-02/Why Do We Need a Data Warehouse.webp" alt="" /></p>

<h1 id="what-is-a-data-warehouse">What is a Data Warehouse?</h1>

<p>ğŸ—£ï¸  <strong>A database used and optimized for analytical purposes.</strong></p>
<ul>
  <li>User-friendly</li>
  <li>Fast query performance</li>
  <li>Enabling data analysis</li>
</ul>

<h1 id="etl">ETL</h1>

<ul>
  <li><strong>Extract</strong>  +  <strong>Transform</strong>  +  <strong>Load</strong>  â†’  <strong><code class="language-plaintext highlighter-rouge">Data Warehouse</code></strong></li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-01-02/etl-flowchart.webp" alt="" /></p>

<h1 id="goals-of-data-warehouse">Goals of Data Warehouse</h1>
<ul>
  <li>Centralized and Consistent Location for Data</li>
  <li>Data Must be Accessible Fast (<strong>Query Performance</strong>)</li>
  <li>User-friendly (<strong>Easy to Understand</strong>)</li>
  <li>Must Load Data Consistently and repeatedly (<strong>ETL</strong>)</li>
  <li><strong>Reporting</strong>  and  <strong>Data Visualization</strong>  Built on Top</li>
</ul>

<h1 id="understanding-a-data-warehouse">Understanding a Data Warehouse</h1>

<p><img src="/assets/2023-12-06-data-warehouse-01-02/data-warehouse-flowchart.webp" alt="" /></p>

<h1 id="business-intelligence">Business Intelligence</h1>
<ul>
  <li>We Create a Data Warehouse for  <strong>Business Intelligence</strong>!</li>
</ul>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="sql" /><category term="data_warehouse" /><summary type="html"><![CDATA[In this article, Iâ€™ll summarize key takeaways from: SECTION 01. Introduction SECTION 02. Data Warehouse Basics]]></summary></entry><entry><title type="html">Data Warehouse #04</title><link href="http://localhost:4000/data-warehouse-04/" rel="alternate" type="text/html" title="Data Warehouse #04" /><published>2023-12-06T00:00:00+09:00</published><updated>2023-12-06T00:00:00+09:00</updated><id>http://localhost:4000/data-warehouse-04</id><content type="html" xml:base="http://localhost:4000/data-warehouse-04/"><![CDATA[<blockquote>
  <p>In this article, Iâ€™ll summarize key takeaways from:</p>
  <ul>
    <li>SECTION 04. Dimensional Modeling</li>
  </ul>
</blockquote>

<h3 id="disclaimer">DISCLAIMER</h3>
<blockquote>
  <p>This article is a compilation of key takeaways after completing  <a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Data Warehouse â€” The Ultimate Guide</a>  on Udemy. However, it may be challenging to achieve a comprehensive and deep understanding of Data Warehouse solely through this article. For your in-depth learning, please take the course, which is an excellent resource, and I personally highly recommend it to those who are eager to master data warehousing, dimensional modeling, and the ETL process.</p>
</blockquote>

<p><img src="/assets/2023-12-06-data-warehouse-04/data-warehouse.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.udemy.com/course/data-warehouse-the-ultimate-guide/">Source</a></p>
</blockquote>

<h1 id="what-is-dimensional-modeling">What is Dimensional Modeling?</h1>

<p><strong>Dimensional Modeling</strong></p>
<ul>
  <li>Unique Technique of Structuring Data</li>
  <li>Commonly Used in Data Warehouse</li>
  <li>Optimized for Faster Data Regrieval</li>
  <li>Performance &amp; Usability Oriented</li>
  <li>Designed Reporting &amp; OLAP</li>
</ul>

<p><strong>Details</strong></p>
<ul>
  <li>It is the  <strong>Method of Organizing Data</strong>  in a Data Warehouse.</li>
  <li><code class="language-plaintext highlighter-rouge">Profit</code>  by  <code class="language-plaintext highlighter-rouge">Year</code>?  <code class="language-plaintext highlighter-rouge">Profit</code>  by  <code class="language-plaintext highlighter-rouge">Category</code>?
    <ul>
      <li><strong>Facts</strong>:  <strong>Measurements</strong>  like  <code class="language-plaintext highlighter-rouge">Profit</code></li>
      <li><strong>Dimensions</strong>:  <strong>Contexts</strong>  like  <code class="language-plaintext highlighter-rouge">Period</code>  or  <code class="language-plaintext highlighter-rouge">Category</code></li>
    </ul>
  </li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-04/star-schema.webp" alt="" /></p>

<h1 id="why-is-dimensional-modeling">Why is Dimensional Modeling?</h1>

<ul>
  <li>Dimensional Modeling â†’ <code class="language-plaintext highlighter-rouge">Performance</code> â¬†ï¸ / <code class="language-plaintext highlighter-rouge">Usability</code> â¬†ï¸</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-04/dimensional-modeling.webp" alt="" /></p>

<h1 id="facts">Facts</h1>

<p><strong>Facts</strong> usuallyâ€¦</p>
<ul>
  <li>Aggregatable (with Numeric Values)</li>
  <li>Measurable</li>
  <li>Event or Transactional Data</li>
  <li>Date or Time in a Fact Table</li>
  <li>Foundation of Data Warehouse</li>
  <li>Key Measurements</li>
  <li>Aggregated and Analyzed</li>
</ul>

<h1 id="dimensions">Dimensions</h1>

<p><strong>Dimensions</strong> usuallyâ€¦</p>
<ul>
  <li>Non-aggregatable</li>
  <li>Descriptive</li>
  <li>More Static than Facts</li>
  <li>Categorizes Facts</li>
  <li>Supportive &amp; Descriptive</li>
  <li>Filtering, Grouping, and Labeling</li>
</ul>

<p><img src="/assets/2023-12-06-data-warehouse-04/star-vs-snowflake.webp" alt="" /></p>
<blockquote>
  <p><a href="https://nidhig631.medium.com/star-schema-vs-snowflake-schema-78dc9424a8a2">Source</a></p>
</blockquote>

<p><strong>Star Schema</strong></p>
<ul>
  <li>Most Common Schema in Data Mart</li>
  <li>Simplest Form (vs. Snowflake Schema)</li>
  <li>Works Best for Specific Needs (Simple Queries vs. Complex Queries)</li>
  <li>Usability + Query Performance (<code class="language-plaintext highlighter-rouge">Read</code>)</li>
</ul>

<p><strong>Denormalized</strong> (= Star Schema)</p>
<ul>
  <li>Data Redundancy â¬†ï¸</li>
  <li>Optimized to get data out â¬†ï¸</li>
  <li>Query Performance (<code class="language-plaintext highlighter-rouge">Read</code>) â¬†ï¸</li>
  <li>User Experience â¬†ï¸</li>
</ul>

<p><strong>Normalized</strong> (= Snowflake Schema)</p>
<ul>
  <li>Data Redundancy â¬‡ï¸</li>
  <li>Storage â¬‡ï¸</li>
  <li>Query Performance (<code class="language-plaintext highlighter-rouge">Write &amp; Update</code>) â¬†ï¸</li>
  <li>Number of Tables â¬†ï¸</li>
  <li>Joins Necessary â¬†ï¸</li>
</ul>

<h1 id="snowflake-schema">Snowflake Schema</h1>

<p><strong>Advantages</strong></p>
<ul>
  <li>Storage Cost â¬‡ï¸</li>
  <li>Data Redundancy â¬‡ï¸</li>
  <li>Query Performance (<code class="language-plaintext highlighter-rouge">Write &amp; Update</code>) â¬†ï¸</li>
</ul>

<p><strong>Disadvantages</strong></p>
<ul>
  <li>Complex Queries with Joins</li>
  <li>Query Performance (<code class="language-plaintext highlighter-rouge">Read</code>) â¬‡ï¸</li>
</ul>

<p><strong>Star Schema vs. Snowflake Schema</strong></p>
<ul>
  <li><strong>Data Mart</strong>  â†’  <code class="language-plaintext highlighter-rouge">Star Schema</code>  is Preferred!</li>
  <li><strong>Core</strong>  â†’  <code class="language-plaintext highlighter-rouge">Star Schema</code>  is Preferred, but  <code class="language-plaintext highlighter-rouge">Snowflake Schema</code>  can be considered!</li>
</ul>

<h1 id="demo-product--category-dimensions-snowflake-schema">Demo: Product &amp; Category Dimensions (<code class="language-plaintext highlighter-rouge">Snowflake Schema</code>)</h1>

<p>(1) With  <code class="language-plaintext highlighter-rouge">products.csv</code>, we are now trying to create a â€œ<strong>Category Dimension</strong>â€ using PostgreSQL!</p>

<p><img src="/assets/2023-12-06-data-warehouse-04/products-csv.webp" alt="" /></p>

<p>(2) In PGAdmin, Click â€œ<code class="language-plaintext highlighter-rouge">Query Tool</code>â€ on the  <strong>public schema</strong>.</p>

<p><img src="/assets/2023-12-06-data-warehouse-04/query-tool.webp" alt="" /></p>

<p>(3) Run the code block to create  <code class="language-plaintext highlighter-rouge">products</code>  table, then youâ€™ll see the table has been created.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">products</span> <span class="p">(</span>  
    <span class="n">product_id</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>  
    <span class="n">product_name</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>  
    <span class="n">category</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>  
    <span class="n">subcategory</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>  
<span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/2023-12-06-data-warehouse-04/public.webp" alt="" /></p>

<p>(4) Right-click on the  <code class="language-plaintext highlighter-rouge">products</code>  table, then click â€œ<strong>Import/Export Data</strong>â€ button.</p>

<p><img src="/assets/2023-12-06-data-warehouse-04/import-export-data.webp" alt="" /></p>

<p>(5) Designate the  <strong>products.csv</strong>  file to import on  <code class="language-plaintext highlighter-rouge">products</code>  table.</p>

<p><img src="/assets/2023-12-06-data-warehouse-04/import.webp" alt="" /></p>

<p><img src="/assets/2023-12-06-data-warehouse-04/options.webp" alt="" /></p>

<p><img src="/assets/2023-12-06-data-warehouse-04/columns.webp" alt="" /></p>

<p>(6) Run the code block to see if your data has been imported.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">products</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023-12-06-data-warehouse-04/data-output.webp" alt="" /></p>

<p>(7) Run the code block to see what kind of unique  <strong>category</strong>  is in  <code class="language-plaintext highlighter-rouge">products</code>  table.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
    <span class="k">DISTINCT</span> <span class="n">category</span>  
<span class="k">FROM</span> <span class="n">products</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023-12-06-data-warehouse-04/data-output-category.webp" alt="" /></p>

<p>(8) Run the code block to create a dimension table named  <code class="language-plaintext highlighter-rouge">categories</code>.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
    <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">category</span><span class="p">)</span> <span class="k">AS</span> <span class="n">category_id</span><span class="p">,</span>  
    <span class="n">category</span>  
<span class="k">INTO</span> <span class="n">categories</span>  
<span class="k">FROM</span> <span class="p">(</span>  
    <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">category</span>  
    <span class="k">FROM</span> <span class="n">products</span>  
<span class="p">)</span> <span class="n">SUB</span>  
<span class="p">;</span>
</code></pre></div></div>

<p>(9) See if the  <code class="language-plaintext highlighter-rouge">categories</code>  table has been created.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">categories</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="/assets/2023-12-06-data-warehouse-04/data-output-category-id.webp" alt="" /></p>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="sql" /><category term="data_warehouse" /><summary type="html"><![CDATA[In this article, Iâ€™ll summarize key takeaways from: SECTION 04. Dimensional Modeling]]></summary></entry><entry><title type="html">ã€ë§ˆìŠ¤í„°ë§ ì´ë”ë¦¬ì›€ã€ ì¤‘ìš”í•œ ë‚´ìš© ëª¨ì¡°ë¦¬ ìš”ì•½</title><link href="http://localhost:4000/mastering-ethereum/" rel="alternate" type="text/html" title="ã€ë§ˆìŠ¤í„°ë§ ì´ë”ë¦¬ì›€ã€ ì¤‘ìš”í•œ ë‚´ìš© ëª¨ì¡°ë¦¬ ìš”ì•½" /><published>2023-12-05T00:00:00+09:00</published><updated>2023-12-05T00:00:00+09:00</updated><id>http://localhost:4000/mastering-ethereum</id><content type="html" xml:base="http://localhost:4000/mastering-ethereum/"><![CDATA[<blockquote>
  <p>ê°œë°œì ì¸ ìš©ì–´ê°€ ë‚œë¬´í•´ì„œ ë‹¹ì‹œì—ëŠ” ë„ì €íˆ í¼ì³ ë³¼ ì—„ë‘ê°€ ì•ˆ ë‚¬ì§€ë§Œ, ì´ ì—…ê³„ì—ì„œ ì•½ 3ë…„ ê°€ê¹Œì´ êµ¬ë¥´ë‹¤ë³´ë‹ˆ ì–´ëŠ ì •ë„ ì˜ ì½íˆê²Œ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ 2023ë…„ 1ì›” 1ì¼ ìƒˆí•´ ëª©í‘œ ì¤‘ í•˜ë‚˜ë¡œ â€œ<strong>ë§ˆìŠ¤í„°ë§ ì´ë”ë¦¬ì›€ ì™„ë…í•˜ê³  ì •ë¦¬í•˜ê¸°</strong>â€ë¥¼ ì„¸ìš°ê²Œ ë˜ì—ˆë‹¤. ê·¸ë¦¬ê³  ì•½ 1ê°œì›” ë§Œì— ë‹¤ ì½ê²Œ ë˜ì—ˆë‹¤.</p>
</blockquote>

<h3 id="contents">CONTENTS</h3>
<ol>
  <li>ë“¤ì–´ê°€ëŠ” ê¸€</li>
  <li>ì£¼ì˜ì‚¬í•­</li>
  <li><strong>[Chapter 01â€“02]</strong> What is Ethereum? &amp; Intro to Ethereum</li>
  <li><strong>[Chapter 03]</strong> Ethereum Clients</li>
  <li><strong>[Chapter 04]</strong> Cryptography</li>
  <li><strong>[Chapter 05]</strong> Wallets</li>
  <li><strong>[Chapter 06]</strong> Transactions</li>
  <li><strong>[Chapter 07]</strong> Smart Contracts &amp; Solidity</li>
  <li><strong>[Chapter 08]</strong> Smart Contracts &amp; Vyper</li>
  <li><strong>[Chapter 09]</strong> Smart Contracts &amp; Security</li>
  <li><strong>[Chapter 10]</strong> Tokens</li>
  <li><strong>[Chapter 11]</strong> Oracles</li>
  <li><strong>[Chapter 12]</strong> Decentralized Applications (dApps)</li>
  <li><strong>[Chapter 13]</strong> Ethereum Virtual Machine (EVM)</li>
  <li><strong>[Chapter 14]</strong> Consensus</li>
</ol>

<hr />

<h3 id="disclaimer">DISCLAIMER</h3>
<p>ë³¸ ì•„í‹°í´ì€ ì‘ì„±ìì˜ ì „/í˜„ì§ ê¸°ì—…ì˜ ì‚¬ì—… ë‚´ìš©ê³¼ ì „í˜€ ê´€ë ¨ì´ ì—†ìœ¼ë©°, ê°œì¸ì ì¸ í•™ìŠµì„ í†µí•´ ì‘ì„±í•œ ê²ƒì„ì„ ë°í™ë‹ˆë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/textbook.webp" alt="" /></p>
<blockquote>
  <p><a href="https://product.kyobobook.co.kr/detail/S000001916933">Source</a></p>
</blockquote>

<h1 id="1-ë“¤ì–´ê°€ëŠ”-ê¸€">1. ë“¤ì–´ê°€ëŠ” ê¸€</h1>

<p>ë•ŒëŠ” 2021ë…„ 3ì›”, ë¸”ë¡ì²´ì¸ê³¼ ê°€ìƒìì‚°ì— ëŒ€í•´ ë¬´ì§€ëª½ë§¤í•œ ìƒíƒœë¡œ ì—…ê³„ì— ì²˜ìŒ ë°œì„ ë“¤ì˜€ë‹¤. ìƒì†Œí•œ ë¸”ë¡ì²´ì¸ ê¸°ìˆ ê³¼ ì•„í‚¤í…ì²˜ë¥¼ ì´í•´í•˜ë ¤ê³  ë…¸ë ¥í•´ë„ ë„ë¬´ì§€ ê°ì´ ì•ˆ ì¡í˜€ì„œ ê³ í†µìŠ¤ëŸ½ê¸°ë„ í–ˆë‹¤. ë§ì€ ê²ƒì„ ì˜ì§€í–ˆë˜ ë‹¹ì‹œ ì˜† ìë¦¬ ì„ ë°°ë‹˜ì˜ ì±…ìƒì—ëŠ” ë§ˆìŠ¤í„°ë§ ì´ë”ë¦¬ì›€ ì±…ì´ ë†“ì—¬ ìˆì—ˆë‹¤.</p>

<blockquote>
  <p>â€œì´ ì±…ì´ ì œì¼ ì¢‹ì•„ìš”. ê·¸ëŸ°ë° ê·¸ë§Œí¼ ì—„ì²­ ì–´ë ¤ì›Œìš”.â€</p>
</blockquote>

<p>ê°œë°œì ì¸ ìš©ì–´ê°€ ë‚œë¬´í•´ì„œ ë‹¹ì‹œì—ëŠ” ë„ì €íˆ í¼ì³ ë³¼ ì—„ë‘ê°€ ì•ˆ ë‚¬ì§€ë§Œ, ì´ ì—…ê³„ì—ì„œ ì•½ 3ë…„ ê°€ê¹Œì´ êµ¬ë¥´ë‹¤ë³´ë‹ˆ ì–´ëŠ ì •ë„ ì˜ ì½íˆê²Œ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ 2023ë…„ 1ì›” 1ì¼ ìƒˆí•´ ëª©í‘œ ì¤‘ í•˜ë‚˜ë¡œ â€œ<strong>ë§ˆìŠ¤í„°ë§ ì´ë”ë¦¬ì›€ ì™„ë…í•˜ê³  ì •ë¦¬í•˜ê¸°</strong>â€ë¥¼ ì„¸ìš°ê²Œ ë˜ì—ˆë‹¤. ê·¸ë¦¬ê³  ì•½ 1ê°œì›” ë§Œì— ë‹¤ ì½ê²Œ ë˜ì—ˆë‹¤.</p>

<h1 id="2-ì£¼ì˜ì‚¬í•­">2. ì£¼ì˜ì‚¬í•­</h1>

<ul>
  <li>ê°œë°œì„ ìœ„í•œ ì†ŒìŠ¤ ì½”ë“œ ë‚´ìš©ì´ë‚˜ ì•”í˜¸í•™ ì´ë¡  ë“± ì§€ë‚˜ì¹˜ê²Œ ê¹Šì€ ë‚´ìš©ì€ Skimmingí•˜ì—¬ ì •ë¦¬í–ˆë‹¤.</li>
  <li>ê°œë°œìëŠ” ì•„ë‹ˆì§€ë§Œ í”„ë¡œê·¸ë˜ë°ê³¼ ë°ì´í„°ì— ëŒ€í•œ ì´í•´ë¥¼ í•˜ê³  ìˆëŠ” ì…ì¥ì—ì„œ, ì™„ë²½í•˜ì§€ëŠ” ì•Šì§€ë§Œ ê·¸ë˜ë„ ë‚˜ë¦„ ì˜ ì •ë¦¬í•´ë´¤ë‹¤.</li>
  <li>ì´ë”ë¦¬ì›€ì˜ ë°”ì´ë¸”ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ì´ ì±…ì„ ì§ì ‘ ì½ê¸°ì—ëŠ” ë¶€ë‹´ì„ ëŠë¼ì‹œëŠ” ë¶„ë“¤ê»˜ì„œ ë¹ ë¥´ê²Œ í›‘ì–´ë³´ê³  ì‹¶ì„ ë•Œ ìœ ìš©í•˜ê²Œ ì“°ì‹¤ ìˆ˜ ìˆê¸°ë¥¼ ë°”ë€ë‹¤.</li>
  <li>ë‚´ìš©ì„ ìš”ì•½í•˜ëŠ” ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì •í™•í•œ ë ˆí¼ëŸ°ìŠ¤ëŠ” ë°˜ë“œì‹œ ë³¸ì„œë¥¼ ì°¸ê³ í•´ì£¼ì‹œê¸°ë¥¼ ë°”ë€ë‹¤.</li>
</ul>

<h1 id="3-chapter-0102-what-is-ethereum--intro-to-ethereum">3. [Chapter 01â€“02] What is Ethereum? &amp; Intro to Ethereum</h1>

<p>ë¹„íŠ¸ì½”ì¸ì˜ ìŠ¤í¬ë¦½íŠ¸(Script) ì–¸ì–´ê°€ ì˜ë„ì ìœ¼ë¡œ ì§€ë¶ˆ ì¡°ê±´ì— ëŒ€í•œ ë‹¨ìˆœí•œ True/False í‰ê°€ì—ë§Œ ì œí•œë˜ì–´ ìˆëŠ” ë°˜ë©´, ì´ë”ë¦¬ì›€ ì–¸ì–´ëŠ” íŠœë§ ì™„ì „ ì–¸ì–´ë‹¤. ì´ê²ƒì€ ì´ë”ë¦¬ì›€ì´ ë²”ìš© ì»´í“¨í„°ë¡œ ì§ì ‘ ì‘ë™í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤.</p>

<p>ì—¬ëŸ¬ ë¸”ë¡ì²´ì¸ì˜ ì„±ê²©ì„ íŒŒì•…í•˜ê¸° ìœ„í•´  <strong>ê°œë°©ì„±</strong>,  <strong>ê³µê³µì„±</strong>,  <strong>êµ­ì œí™”</strong>,  <strong>íƒˆì¤‘ì•™í™”</strong>,  <strong>ì¤‘ë¦½ì„±</strong>,  <strong>ê²€ì—´ì €í•­ì„±</strong>  ë“±ì˜ í‰ê°€ ê¸°ì¤€ì´ í•„ìš”í•˜ë‹¤.</p>

<p>ì´ë”ë¦¬ì›€ì€ íƒˆì¤‘ì•™í™”ëœ State Machineìœ¼ë¡œì„œ, Key-Value Tupleë¡œ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” ì €ì¥ì†Œì˜ ìƒíƒœ ì „ì´(State Change)ë¥¼ ì¶”ì í•œë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/state-change.webp" alt="" /></p>
<blockquote>
  <p><a href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Source</a></p>
</blockquote>

<p>ì´ë”ë¦¬ì›€ ìƒíƒœ ì „ì´ëŠ” Bytecodeë¥¼ ì‹¤í–‰í•˜ëŠ” ìŠ¤íƒ ê¸°ë°˜ ê°€ìƒë¨¸ì‹ ì¸ EVMì— ì˜í•´ ì²˜ë¦¬ëœë‹¤.</p>

<p>ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¼ëŠ” EVM í”„ë¡œê·¸ë¨ì€:</p>

<ul>
  <li>ê³ ìˆ˜ì¤€ ì–¸ì–´ì¸ Solidityë¡œ ì‘ì„±ë˜ê³ ,</li>
  <li>EVMì—ì„œ ì‹¤í–‰ë˜ë„ë¡ Bytecodeë¡œ ì»´íŒŒì¼ëœë‹¤.</li>
</ul>

<p>ì´ë”ë¦¬ì›€ì˜ StateëŠ” íŠ¸ëœì­ì…˜ ë° ì‹œìŠ¤í…œ ìƒíƒœê°€ ë¨¸í´ íŒ¨íŠ¸ë¦¬ìƒ¤ íŠ¸ë¦¬(<a href="https://ethereum.org/en/developers/docs/data-structures-and-encoding/patricia-merkle-trie/">MERKLE PATRICIA TRIE</a>)ë¼ê³  í•˜ëŠ” ì‹œë¦¬ì–¼ë¼ì´ì¦ˆëœ í•´ì‹œ ë°ì´í„° êµ¬ì¡°ë¡œ, ê° ë…¸ë“œì˜ DBì— ì €ì¥ëœë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/merkle-patricia-trie.webp" alt="" /></p>
<blockquote>
  <p><a href="https://medium.com/codechain/modified-merkle-patricia-trie-how-ethereum-saves-a-state-e6d7555078dd">Source</a></p>
</blockquote>

<p>ì‚¬ì‹¤ ì•”í˜¸í™”í ê¸°ëŠ¥ì€ íƒˆì¤‘ì•™í™”ëœ ì›”ë“œ ì»´í“¨í„°ë¡œì„œì˜ ì´ë”ë¦¬ì›€ ê¸°ëŠ¥ì— ë¶€ì°¨ì ì¸ ê²ƒì´ë‹¤.</p>

<ul>
  <li>ETHëŠ” EVMì´ë¼ê³  í•˜ëŠ” ì—ë®¬ë ˆì´íŠ¸ëœ ì»´í“¨í„°ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì»´í“¨í„° í”„ë¡œê·¸ë¨ì¸ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ê¸° ìœ„í•œ ê²ƒì´ë‹¤.</li>
</ul>

<p>EOAë§Œ íŠ¸ëœì­ì…˜ë¥¼ ì‹œì‘(Initiate)í•  ìˆ˜ ìˆê³ , ì»¨íŠ¸ë™íŠ¸ëŠ” ë³µì¡í•œ ì‹¤í–‰ ê²½ë¡œë¥¼ êµ¬ì¶•í•˜ì—¬ ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ í˜¸ì¶œí•´ì„œ ë°˜ì‘(React)í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ ì‚¬ìš©í•˜ëŠ” ì „í˜•ì ì¸ ë°©ë²•ì€ Multi-sig ìŠ¤ë§ˆíŠ¸ íŠ¸ëœì­ì…˜ ì§€ê°‘ì— ì§€ê¸‰ ìš”ì²­ íŠ¸ëœì­ì…˜ì„ ì „ì†¡í•˜ì—¬ ì¼ë¶€ ETHë¥¼ ë‹¤ë¥¸ ì£¼ì†Œë¡œ ë³´ë‚´ëŠ” ê²ƒì´ë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/eoa-ca.webp" alt="" /></p>
<blockquote>
  <p><a href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Source</a></p>
</blockquote>

<ul>
  <li><strong>EOA</strong>  (Externally Owned Account): íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•  ìˆ˜ ìˆìŒ</li>
  <li><strong>CA</strong>  (Contract Account): EOAì˜ í•¨ìˆ˜ í˜¸ì¶œì— ì˜í•´ ë°˜ì‘í•  ìˆ˜ ìˆìŒ</li>
</ul>

<p>ë¸”ë¡ì²´ì¸ì— ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬</p>
<ul>
  <li>ëª©ì ì§€ ì£¼ì†Œê°€  <code class="language-plaintext highlighter-rouge">0x00â€¦0</code>ì¸ íŠ¹ìˆ˜ íŠ¸ëœì­ì…˜ì„ ë§Œë“œëŠ” ê²ƒ</li>
</ul>

<p>ì»¨íŠ¸ë™íŠ¸ì—ì„œ ì‹œì‘ëœ Internal Transactionì€ Messageë¼ê³ ë„ í•œë‹¤.</p>

<h1 id="4-chapter-03-ethereum-clients">4. [Chapter 03] Ethereum Clients</h1>

<p>ë¸”ë¡ì²´ì¸ì˜ ê±´ì „ì„±, ë³µì›ë ¥, ê²€ì—´ì €í•­ íŠ¹ì„±ì€ ë…ë¦½ì ìœ¼ë¡œ ìš´ìš©ë˜ê³  ì§€ë¦¬ì ìœ¼ë¡œ ë¶„ì‚°ëœ Full Nodesê°€ ì–¼ë§ˆë‚˜ ë§ì€ì§€ì— ë‹¬ë ¤ ìˆë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/clients.webp" alt="" /></p>
<blockquote>
  <p><a href="https://ethereum.org/en/developers/docs/nodes-and-clients/client-diversity/">Source</a></p>
</blockquote>

<h1 id="5-chapter-04-cryptography">5. [Chapter 04] Cryptography</h1>

<p>íƒ€ì› ê³¡ì„  ì‚°ìˆ ì—ì„œ ì†Œìˆ˜ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¥¼ ê³±í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•˜ì§€ë§Œ, ë‚˜ëˆ—ì…ˆì€ ì‚¬ì‹¤ìƒ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì´ê²ƒì„ ì´ì‚°ë¡œê·¸ë¬¸ì œë¼ê³  í•˜ë©°, í˜„ì¬ëŠ” ì•Œë ¤ì§„ íŠ¸ë©ë„ì–´ëŠ” ì—†ë‹¤.</p>

<p>íƒ€ì› ê³¡ì„  ì•”í˜¸í™”ëŠ” ìµœì‹  ì»´í“¨í„° ì‹œìŠ¤í…œì—ì„œ ê´‘ë²”ìœ„í•˜ê²Œ í™œìš©ë˜ë©°, ì´ë”ë¦¬ì›€ì—ì„œ ê°œì¸í‚¤ì™€ ë””ì§€í„¸ ì„œëª…ì„ ì‚¬ìš©í•˜ëŠ” ê¸°ì´ˆê°€ ëœë‹¤.</p>

<p>ì´ë”ë¦¬ì›€ ê³µê°œí‚¤ëŠ” íƒ€ì› ê³¡ì„ ì— ìˆëŠ” ì ìœ¼ë¡œ, íƒ€ì› ê³¡ì„  ë°©ì •ì‹ì„ ë§Œì¡±í•˜ëŠ” xì™€ y ì¢Œí‘œì˜ ì§‘í•©ì„ ì˜ë¯¸í•œë‹¤.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ê³µê°œí‚¤(K) = ê°œì¸í‚¤(k) * G(generator point)</code>
    <ul>
      <li>(ì—¬ê¸°ì—ì„œ *ì€ ì¼ë°˜ì ì¸ ê³±ì…ˆì´ ì•„ë‹Œ, íŠ¹ìˆ˜ íƒ€ì› ê³¡ì„  ê³±í•˜ê¸° ì—°ì‚°)</li>
    </ul>
  </li>
</ul>

<h1 id="6-chapter-05-wallets">6. [Chapter 05] Wallets</h1>

<p><img src="/assets/2023-12-05-mastering-ethereum/key-flowchart.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>ì§€ê°‘ì€ ë³´ìœ  ì¤‘ì¸ Private Keyë“¤ì´ ì„œë¡œ ê´€ë ¨ì´ ìˆëŠëƒ ì—†ëŠëƒì— ë”°ë¼ ë¹„ê²°ì •ì  ì§€ê°‘ê³¼ ê²°ì •ì  ì§€ê°‘ìœ¼ë¡œ êµ¬ë¶„ëœë‹¤.</p>

<ul>
  <li><strong>ë¹„ê²°ì •ì  ì§€ê°‘</strong>: ê°ê¸° ë‹¤ë¥¸ ë¬´ì‘ìœ„ ìˆ˜ë¡œë¶€í„° ê° Private Keyë¥¼ ë¬´ì‘ìœ„ì ìœ¼ë¡œ ì¶”ì¶œí•œë‹¤.</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/ë¹„ê²°ì •ì -ì§€ê°‘.webp" alt="" /></p>
<blockquote>
  <p><a href="http://wiki.hash.kr/index.php/HD_%EC%A7%80%EA%B0%91">Source</a></p>
</blockquote>

<ul>
  <li><strong>ê²°ì •ì  ì§€ê°‘</strong>: ëª¨ë“  Private Keyê°€ ë‹¨ì¼ ë§ˆìŠ¤í„° í‚¤ì¸ seedë¡œë¶€í„° íŒŒìƒëœë‹¤. seedëŠ” ë‹¨ì–´ ëª©ë¡ì¸ ë‹ˆëª¨ë‹‰ ì½”ë“œ ë‹¨ì–´ë¡œ ì¸ì½”ë”©ë˜ì–´ ë¶ˆì˜ì˜ ì‚¬ê³ ì— ëŒ€ë¹„í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/ê²°ì •ì -ì§€ê°‘.webp" alt="" /></p>
<blockquote>
  <p><a href="http://wiki.hash.kr/index.php/HD_%EC%A7%80%EA%B0%91">Source</a></p>
</blockquote>

<ul>
  <li>(ì°¸ê³ ) <a href="http://wiki.hash.kr/index.php/HD_%EC%A7%80%EA%B0%91"><strong>HD ì§€ê°‘</strong></a>: ê²°ì •ì  ì§€ê°‘ì€ ë‹¨ì¼ ì‹œë“œì—ì„œ ë§ì€ í‚¤ë¥¼ ì‰½ê²Œ ìœ ë„í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì¡Œë‹¤. í˜„ì¬ ê°€ì¥ ì§„ë³´í•œ í˜•íƒœì˜ ê²°ì •ì  ì§€ê°‘ì€ ë¹„íŠ¸ì½”ì¸ì˜ BIP32 í‘œì¤€ìœ¼ë¡œ ì •ì˜ëœ HD ì§€ê°‘ì´ë‹¤. HD ì§€ê°‘ì€ ë¶€ëª¨ í‚¤ê°€ ì—°ì†ëœ ìì‹ í‚¤ë¥¼ ìœ ë„í•  ìˆ˜ ìˆê³ , ê°ê°ì˜ ìì‹í‚¤ëŠ” ì†ì í‚¤ë¥¼ ìœ ë„í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ì¸ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ íŒŒìƒëœ í‚¤ë¥¼ í¬í•¨í•œë‹¤. ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ë¶€ëª¨ í‚¤ê°€ ìì‹ í‚¤ì˜ ì‹œí€€ìŠ¤ë¥¼ ìœ ë„í•  ìˆ˜ ìˆê³ , ê°ê°ì˜ ìì‹ì€ ë‹¤ì‹œ ë˜ ì†ì í‚¤ì˜ ì‹œí€€ìŠ¤ë¥¼ ìœ ë„í•  ìˆ˜ ìˆë‹¤. HD ì§€ê°‘ì€ ê²°ì •ì  ì§€ê°‘ì— ë¹„í•´ ëª‡ ê°€ì§€ ì¥ì ì´ ìˆë‹¤. ë¨¼ì € HD ì§€ê°‘ì˜ íŠ¸ë¦¬ êµ¬ì¡°ëŠ” ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì„œë¸Œ í‚¤ì˜ íŠ¹ì • ë¶„ê¸°ëŠ” ì…ê¸ˆì„ ìœ„í•´ ì‚¬ìš©í•˜ê³ , ë‹¤ë¥¸ ë¸Œëœì¹˜ëŠ” ì¶œê¸ˆì˜ ì”ëˆì„ ë°›ê¸° ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ë¶€ì„œ, ìíšŒì‚¬, íŠ¹ì • ê¸°ëŠ¥ ë˜ëŠ” íšŒê³„ ì¹´í…Œê³ ë¦¬ë¡œ ë‹¤ë¥¸ ë¶„ê¸°ë¥¼ í• ë‹¹í•˜ì—¬ ê¸°ì—… ì„¤ì •ê³¼ ê°™ì€ êµ¬ì¡°ì ì¸ ì˜ë¯¸ë¥¼ í‘œí˜„í•˜ëŠ” ë°ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. HD ì§€ê°‘ì˜ ë˜ ë‹¤ë¥¸ ì¥ì ì€ ì‚¬ìš©ìê°€ ê°œì¸í‚¤ì— ì ‘ê·¼í•˜ì§€ ì•Šê³ , ì—°ì†ëœ ê³µê°œí‚¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. HD ì§€ê°‘ì€ ë³´ì•ˆìƒ ì•ˆì „í•˜ì§€ ì•Šì€ ì„œë²„, ë³´ê¸° ì „ìš©, ìˆ˜ì‹  ì „ìš©ì˜ ìš©ë„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, ì´ë•Œ ì§€ê°‘ì—ëŠ” ìê¸ˆì„ ì›€ì§ì´ëŠ” ê°œì¸í‚¤ê°€ ë“¤ì–´ ìˆì§€ ì•Šê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/HD-ì§€ê°‘.webp" alt="" /></p>
<blockquote>
  <p><a href="http://wiki.hash.kr/index.php/HD_%EC%A7%80%EA%B0%91">Source</a></p>
</blockquote>

<h1 id="7-chapter-06-transactions">7. [Chapter 06] Transactions</h1>

<p>ì´ë”ë¦¬ì›€ì€ Global Singleton State Machineì´ë©°, íŠ¸ëœì­ì…˜ì€ ì´ State Machineì„ ì›€ì§ì—¬ì„œ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ ë§Œë“ ë‹¤.</p>

<p>íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” serialized binary messageë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/transaction.webp" alt="" /></p>
<blockquote>
  <p><a href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Source</a></p>
</blockquote>

<ul>
  <li><strong>nonce</strong>,  <strong>gas price</strong>,  <strong>gas limit</strong>,  <strong>recipient</strong>,  <strong>value</strong>,  <strong>data</strong>,  <strong>v</strong>,  <strong>r</strong>,  <strong>s</strong></li>
</ul>

<p>íŠ¸ëœì­ì…˜ ë©”ì‹œì§€ êµ¬ì¡°ëŠ” RLP(Recursive Length Prefix) ì¸ì½”ë”© ì²´ê³„ë¥¼ ì‚¬ìš©í•˜ì—¬ serializeëœë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/rlp.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>(1)  <strong>Nonce</strong>: í•´ë‹¹ addressì—ì„œ ë³´ë‚¸ tx ê±´ìˆ˜ OR ì»¨íŠ¸ë™íŠ¸ ìƒì„± ê±´ìˆ˜ (scalar value). ì‚¬ìš©ìƒì˜ ê¸°ëŠ¥ ë° íŠ¸ëœì­ì…˜ ë³µì œ ë°©ì§€ì˜ íš¨ê³¼ë¥¼ ì§€ë‹˜.</p>

<p>(2)  <strong>Gas Price &amp; Limit</strong>: DoS ê³µê²©ì´ë‚˜ ì‹¤ìˆ˜ë¡œ ë§‰ëŒ€í•œ ìì›ì„ ì†Œëª¨í•˜ëŠ” txë¥¼ í”¼í•˜ê¸° ìœ„í•œ metering ì—­í• ì„ í•¨.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/gas.webp" alt="" /></p>
<blockquote>
  <p><a href="https://ethereum.org/en/developers/docs/transactions/">Source</a></p>
</blockquote>

<p>(3)  <strong>Recipient</strong>: ì´ë”ë¦¬ì›€ì€ to_addressì˜ ìœ íš¨ì„±ì„ ê²€ì¦í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ ìœ íš¨ì„± ê²€ì •ì€ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ìˆ˜ì¤€ì—ì„œ ìˆ˜í–‰ë˜ì–´ì•¼ í•¨.</p>
<ul>
  <li>recipientë¥¼ zero address(<code class="language-plaintext highlighter-rouge">0x00â€¦0</code>)ë¡œ ë‘ë©´, ì»¨íŠ¸ë™íŠ¸ ìƒì„± íŠ¸ëœì­ì…˜ì„ ì˜ë¯¸í•¨</li>
</ul>

<p>(4)  <strong>value &amp; data</strong>: valueëŠ” ì§€ê¸‰ëŸ‰, dataëŠ” í˜¸ì¶œ. EOAë‚˜ CAì— ì§€ê¸‰ëŸ‰ í˜¹ì€ í˜¸ì¶œì— í•„ìš”í•œ data payloadë¥¼ ì „ë‹¬í•¨.</p>

<p>(5)  <strong>v, r, s</strong>: rê³¼ sëŠ” tx ë©”ì‹œì§€ì— private keyë¡œ ì„œëª…í•œ ê²°ê³¼ê°’. vëŠ” ì„œëª…ì„ í™•ì¸í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ë³µêµ¬ ì‹ë³„ìì™€ chain id.</p>

<p><strong>íŠ¸ëœì­ì…˜ ì„œëª… í”„ë¡œì„¸ìŠ¤</strong></p>
<ul>
  <li>(1) nonce, gasPrice, gasLimit, to, value, data, chainID, 0, 0ì˜ 9ê°œ í•„ë“œë¥¼ í¬í•¨í•˜ëŠ” tx ë°ì´í„° êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤.</li>
  <li>(2) RLPë¡œ ì¸ì½”ë”©í•˜ì—¬ serialized messageë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>(3) serialized messageë¥¼ Keccak-256 í•´ì‹œë¥¼ ë¦¬í„´í•œë‹¤.</li>
  <li>(4) ë¦¬í„´ëœ í•´ì‹œë¥¼ private keyë¡œ ECDSA ì„œëª…ì„ ê³„ì‚°í•œë‹¤.</li>
  <li>(5) ê³„ì‚°ëœ ê²°ê³¼ë¥¼ messageì˜ v, r, sì— ì¶”ê°€í•œë‹¤.</li>
</ul>

<p><strong>ì„œëª… ë° ì „ì†¡ ë¶„ë¦¬ (Offline Signing)</strong></p>

<ul>
  <li>Unsigned tx msgë¥¼ ì˜¨ë¼ì¸ì—ì„œ ìƒì„±, ì˜¤í”„ë¼ì¸ì—ì„œ private keyë¥¼ í†µí•´ Signí•˜ì—¬ Signed tx msgë¥¼ ì˜¨ë¼ì¸ì— ì „ë‹¬, ì˜¨ë¼ì¸ì—ì„œ ë„¤íŠ¸ì›Œí¬ë¡œ flood.</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/offline-signing.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>íŠ¸ëœì­ì…˜ ì „íŒŒ</strong></p>
<ul>
  <li>(1) flood routing í”„ë¡œí† ì½œì„ ì‚¬ìš©í•œë‹¤.</li>
  <li>(2) ê° ë…¸ë“œëŠ” ì ì–´ë„ 13ê°œì˜ ë‹¤ë¥¸ ë…¸ë“œì— ëŒ€í•œ ì—°ê²°ì„ ìœ ì§€í•œë‹¤.</li>
  <li>(3) íŠ¸ëœì­ì…˜ì„ ìƒì„±í•œ â€˜ì§ì ‘â€™ ì—°ê²°ëœ ë‹¤ë¥¸ ëª¨ë“  ë…¸ë“œë¡œ ì „ì†¡ëœë‹¤.</li>
  <li>(4) ê° ë…¸ë“œì˜ ê´€ì ì—ì„œ ë³´ë©´, ìˆ˜ì‹ ëœ txì˜ ì¶œì²˜ë¥¼ ì‹ë³„í•  ìˆ˜ ì—†ë‹¤. ë°œì‹ í•œ ë…¸ë“œëŠ” txì˜ ìƒì„±ìì¼ ìˆ˜ë„ ìˆê³ , ë˜‘ê°™ì€ tx ìˆ˜ì‹ ìì¼ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</li>
  <li>(5) ë¹„íŠ¸ì½”ì¸ì€ multi-sig ê³„ì •ì„ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ, ì´ë”ë¦¬ì›€ì˜ ê¸°ë³¸ EOAì—ëŠ” multi-sig ê¸°ëŠ¥ì´ ì—†ë‹¤. ì»¨íŠ¸ë™íŠ¸ ê³„ì •ì„ ìƒì„±í•˜ì—¬ multi-sigì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
  <li>(6) ì»¨íŠ¸ë™íŠ¸ë¥¼ í†µí•´ ë”ìš± ë‹¤ì–‘í•œ í˜•íƒœì˜ multi-sigë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ì¸¡ë©´ì—ì„œ ìœ ì—°ì„±ì´ ìˆì§€ë§Œ, ì»¨íŠ¸ë™íŠ¸ ì½”ë“œ ìì²´ì— ì˜í•´ ë³´ì•ˆ ì·¨ì•½ì ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, multi-sigë¥¼ ì»¨íŠ¸ë™íŠ¸ ìˆ˜ì¤€ì´ ì•„ë‹Œ, EVM ìˆ˜ì¤€ì—ì„œ ì²˜ë¦¬í•˜ê²Œ í•˜ìëŠ” ì œì•ˆì´ ë§ë‹¤.</li>
</ul>

<h1 id="8-chapter-07-smart-contracts--solidity">8. [Chapter 07] Smart Contracts &amp; Solidity</h1>

<p>ì»¨íŠ¸ë™íŠ¸ ê³„ì •ì€ ê°œì¸í‚¤ë¥¼ ê°–ì§€ ì•Šìœ¼ë¯€ë¡œ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì— ê·œì •ëœ ë¯¸ë¦¬ ê²°ì •ëœ ë°©ì‹ìœ¼ë¡œ â€˜ìŠ¤ìŠ¤ë¡œ ì œì–´â€™í•˜ëŠ” ë°˜ë©´, EOAëŠ” í”„ë¡œí† ì½œì˜ ì™¸ë¶€ì˜ ë…ë¦½ì ì¸ â€˜ì‹¤ì œ ì„¸ê³„â€™ì˜ ê°œì¸í‚¤ë¡œ ìƒì„±ë˜ê³  ì•”í˜¸ë¡œ ì„œëª…ëœ ê±°ë˜ì— ì˜í•´ ì œì–´ëœë‹¤.</p>
<ul>
  <li><strong>ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸</strong>: ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ(íƒˆì¤‘ì•™í™”ëœ ì´ë”ë¦¬ì›€ ì›”ë“œ ì»´í“¨í„°)ì˜ ì¼ë¶€ì¸ EVM ì»¨í…ìŠ¤íŠ¸ ìƒì—ì„œ ê²°ì •ë¡ ì ìœ¼ë¡œ(deterministically) ì‘ë™í•˜ëŠ” ë¶ˆë³€ì ì¸(immutable) ì»´í“¨í„° í”„ë¡œê·¸ë¨</li>
</ul>

<p><strong>ì»¨íŠ¸ë™íŠ¸ ìƒì„±</strong></p>
<ul>
  <li>ì»¨íŠ¸ë™íŠ¸ ìƒì„± íŠ¸ëœì­ì…˜ì€ ê³ ìœ í•œ ì»¨íŠ¸ë™íŠ¸ ìƒì„± ì£¼ì†Œ, ì¦‰  <code class="language-plaintext highlighter-rouge">0x0</code>ìœ¼ë¡œ ì „ì†¡ëœë‹¤.</li>
  <li>ì»¨íŠ¸ë™íŠ¸ ìƒì„±ìëŠ” í”„ë¡œí† ì½œ ìˆ˜ì¤€ì—ì„œ íŠ¹ë³„í•œ ê¶Œí•œì„ ì–»ì§€ ëª»í•œë‹¤. (ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ê³„ì •ì„ ìœ„í•œ ê°œì¸í‚¤ê°€ ì—†ê¸° ë•Œë¬¸)</li>
</ul>

<p>ì˜¤ë¥˜ë¡œ ì¸í•´ ì»¨íŠ¸ë™íŠ¸ ì‹¤í–‰ì´ ì‹¤íŒ¨í•˜ë©´ ëª¨ë“  ìƒíƒœ ë³€ê²½ì€ íŠ¸ëœì­ì…˜ì´ ì‹¤í–‰ë˜ì§€ ì•Šì€ ê²ƒì²˜ëŸ¼ ë¡¤ë°±(rolled back)ëœë‹¤.</p>

<p><strong>ì»¨íŠ¸ë™íŠ¸ ì‚­ì œ</strong></p>
<ul>
  <li>ì»¨íŠ¸ë™íŠ¸ë¥¼ â€˜ì‚­ì œâ€™í•˜ì—¬ í•´ë‹¹ ì£¼ì†Œì—ì„œ ì½”ë“œì™€ ë‚´ë¶€ ìƒíƒœë¥¼ ì œê±°í•˜ê³  ë¹ˆ ê³„ì •ìœ¼ë¡œ ë‚¨ê¸¸ ìˆ˜ ìˆë‹¤. (<strong>SELFDESTRUCT</strong>) ì´ ì‘ì—…ì€ Negative Gas, ì¦‰ ê°€ìŠ¤ í™˜ë¶ˆì´ ì¼ì–´ë‚˜ê¸° ë•Œë¬¸ì— ì €ì¥ëœ ìƒíƒœì˜ ì‚­ì œë¡œ ì¸í•œ ë„¤íŠ¸ì›Œí¬ í´ë¼ì´ì–¸íŠ¸ ìì›ì„ ë°˜í™˜í•˜ë„ë¡ í•˜ëŠ” ë™ê¸°ë¶€ì—¬ë¥¼ ë§Œë“ ë‹¤.</li>
</ul>

<p>EVMì€ x86_64 ê°™ì€ ë¨¸ì‹  ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì»´í“¨í„°ì˜ CPUì™€ ìœ ì‚¬í•œ EVM Bytecodeë¼ëŠ” íŠ¹ìˆ˜í•œ í˜•íƒœì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê°€ìƒ ë¨¸ì‹ ì´ë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/evm.webp" alt="" /></p>
<blockquote>
  <p><a href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Source</a></p>
</blockquote>

<p><strong>Solidity í”„ë¡œì íŠ¸ì˜ ì£¼ëœ ê¸°ëŠ¥</strong></p>
<ul>
  <li>Solidity ì–¸ì–´ë¡œ ì‘ì„±ëœ í”„ë¡œê·¸ë¨ì„ EVM Bytecodeë¡œ ë³€í™˜í•˜ëŠ” ì»´íŒŒì¼ëŸ¬ì¸ solcì´ë‹¤.</li>
  <li>ì´ë”ë¦¬ì›€ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ìœ„í•œ ì¤‘ìš”í•œ ABI(Application Binary Interface) í‘œì¤€ì„ ê´€ë¦¬í•œë‹¤.</li>
</ul>

<p><strong>ABI (Application Binary Interface)</strong></p>
<ul>
  <li>ABIëŠ” ë°ì´í„° êµ¬ì¡°ì™€ í•¨ìˆ˜ê°€ ì–´ë–»ê²Œ ê¸°ê³„ ì½”ë“œì—ì„œ ì‚¬ìš©ë˜ëŠ”ì§€ ê·¸ ë°©ë²•ì„ ì •ì˜í•œë‹¤. ì¦‰, ê¸°ê³„ ì½”ë“œì™€ ë°ì´í„°ë¥¼ êµí™˜í•˜ê¸° ìœ„í•´ ì¸ì½”ë”© ë° ë””ì½”ë”©í•˜ëŠ” ê¸°ë³¸ ë°©ë²•ì´ë‹¤.</li>
  <li>ì´ë”ë¦¬ì›€ì—ì„œ ABIëŠ” EVMì—ì„œ ì»¨íŠ¸ë™íŠ¸ í˜¸ì¶œì„ ì¸ì½”ë”©í•˜ê³  íŠ¸ëœì­ì…˜ì—ì„œ ë°ì´í„°ë¥¼ ì½ëŠ” ë° ì‚¬ìš©ëœë‹¤.</li>
  <li>ABIì˜ ëª©ì ì€ ì»¨íŠ¸ë™íŠ¸ì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  ê° í•¨ìˆ˜ê°€ ì¸ìˆ˜ë¥¼ ë°›ì•„ë“¤ì´ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ëŠ” ê²ƒì´ë‹¤.</li>
  <li>ì»¨íŠ¸ë™íŠ¸ì˜ ABIëŠ” í•¨ìˆ˜ ì„¤ëª… ë° ì´ë²¤íŠ¸ì˜ JSON ë°°ì—´ë¡œ ì§€ì •ëœë‹¤.</li>
  <li>ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì»¨íŠ¸ë™íŠ¸ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë° í•„ìš”í•œ ê²ƒ: ABI + ì»¨íŠ¸ë™íŠ¸ ì£¼ì†Œ</li>
</ul>

<p><strong>ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë§Œë“¤ ë•Œ í•¨ìˆ˜ í˜¸ì¶œì˜ ê°€ìŠ¤ ë¹„ìš©ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ ê¶Œì¥í•˜ëŠ” ì§€ì¹¨</strong></p>
<ul>
  <li>(1) Dynamic Array í”¼í•˜ê¸°</li>
  <li>(2) ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ í˜¸ì¶œ í”¼í•˜ê¸°</li>
</ul>

<h1 id="9-chapter-08-smart-contracts--vyper">9. [Chapter 08] Smart Contracts &amp; Vyper</h1>
<p>Chapter 07 ì†”ë¦¬ë””í‹° í¸ì„ ì •ë…í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤ê³  íŒë‹¨í•˜ì—¬ ê³¼ê°íˆ ìƒëµí•¨</p>

<h1 id="10-chapter-09-smart-contracts--security">10. [Chapter 09] Smart Contracts &amp; Security</h1>
<p>ì§€ë‚˜ì¹˜ê²Œ ê°œë°œê³¼ ë³´ì•ˆì ì¸ ë‚´ìš©ì´ë¼ê³  íŒë‹¨í•˜ì—¬ ê³¼ê°íˆ ìƒëµí•¨</p>

<h1 id="11-chapter-10-tokens">11. [Chapter 10] Tokens</h1>

<p><strong>ETH vs Token ì”ì•¡ ë¹„êµ</strong></p>
<ul>
  <li>ì´ë”ë¦¬ì›€ ê³„ì •ì˜ ETH ì”ì•¡ì€  <strong>í”„ë¡œí† ì½œ ìˆ˜ì¤€</strong>ì—ì„œ ì²˜ë¦¬ë˜ëŠ” ë°˜ë©´,</li>
  <li>ì´ë”ë¦¬ì›€ ê³„ì •ì˜ Token ì”ì•¡ì€  <strong>ì»¨íŠ¸ë™íŠ¸ ìˆ˜ì¤€</strong>ì—ì„œ ì²˜ë¦¬ëœë‹¤.</li>
  <li>ë”°ë¼ì„œ ì´ë”ë¦¬ì›€ í”„ë¡œí† ì½œì€ Tokenì— ëŒ€í•´ ì•„ë¬´ê²ƒë„ ëª¨ë¥¸ë‹¤.</li>
</ul>

<p>ì´ë”ë¦¬ì›€ì—ì„œ ìƒˆ Tokenì„ ë§Œë“¤ë ¤ë©´ ìƒˆë¡œìš´ ì»¨íŠ¸ë™íŠ¸ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ë°°í¬ëœ ì»¨íŠ¸ë™íŠ¸ëŠ” Tokenì˜ ì†Œìœ ê¶Œ, ì´ì „ ë° ì ‘ê·¼ ê¶Œí•œì„ í¬í•¨í•œ ëª¨ë“  ê²ƒì„ ì²˜ë¦¬í•œë‹¤.</p>

<h2 id="erc20-tokens"><strong>ERC20 Tokens</strong></h2>

<p>ERC20ì„ ì¤€ìˆ˜í•œ í† í° ì»¨íŠ¸ë™íŠ¸ëŠ” ìµœì†Œí•œ ë‹¤ìŒ Function &amp; Eventsë¥¼ ì œê³µí•´ì•¼ í•œë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// í•„ìˆ˜ Functions</span>

<span class="kd">function</span> <span class="nf">totalSupply</span><span class="p">()</span>
   <span class="c1">// í˜„ì¬ ì¡´ì¬í•˜ëŠ” ì´ í† í°ì˜ ì „ì²´ ê°œìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤. (ERC20 í† í°ì˜ ê³µê¸‰ëŸ‰ì€ ê³ ì • or ê°€ë³€)</span>
<span class="kd">function</span> <span class="nf">balanceOf</span><span class="p">(</span><span class="nx">account</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ ì£¼ì†Œì˜ í† í° ì”ì•¡ì„ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">transfer</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ ì£¼ì†Œë¡œ ì£¼ì–´ì§„ ê¸ˆì•¡ì˜ í† í°ì„ ì „ì†¡í•œë‹¤. ê·¸ë¦¬ê³  ì„±ê³µ ì—¬ë¶€ë¥¼ boolë¡œ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">approve</span><span class="p">(</span><span class="nx">spender</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ ì£¼ì†Œë¡œ ì£¼ì–´ì§„ ìµœëŒ€ ê¸ˆì•¡ê¹Œì§€ ì—¬ëŸ¬ ë²ˆ ì†¡ê¸ˆí•  ìˆ˜ ìˆë„ë¡ ìŠ¹ì¸í•œë‹¤. ê·¸ë¦¬ê³  ì„±ê³µ ì—¬ë¶€ë¥¼ boolë¡œ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">transferFrom</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span>
   <span class="c1">// ë³´ë‚´ëŠ” ì£¼ì†Œì—ì„œ ë°›ëŠ” ì£¼ì†Œë¡œ ì£¼ì–´ì§„ ê¸ˆì•¡ì˜ í† í°ì„ ì „ì†¡í•œë‹¤. ë³´ë‚´ëŠ” ì£¼ì†Œë¡œë¶€í„° approveë¥¼ ë°›ì€ ìƒíƒœì—ì„œ ìµœëŒ€ ê¸ˆì•¡ê¹Œì§€ ê°€ëŠ¥í•˜ë‹¤. ê·¸ë¦¬ê³  ì„±ê³µ ì—¬ë¶€ë¥¼ boolë¡œ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">allowance</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">spender</span><span class="p">)</span>
   <span class="c1">// approveë¡œ ìŠ¹ì¸ëœ ì£¼ì†Œì—ì„œ ì†¡ê¸ˆí•  ìˆ˜ ìˆëŠ” ì”ì•¡ì„ ë¦¬í„´í•œë‹¤.</span>

<span class="c1">// í•„ìˆ˜ Events</span>

<span class="nx">event</span> <span class="nc">Transfer</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
   <span class="c1">// transferë‚˜ transferFromì´ ì„±ê³µë˜ë©´ Transfer ì´ë²¤íŠ¸ê°€ íŠ¸ë¦¬ê±°ëœë‹¤.</span>
<span class="nx">event</span> <span class="nc">Approval</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">spender</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
   <span class="c1">// approveê°€ ì„±ê³µë˜ë©´ Approval ì´ë²¤íŠ¸ê°€ íŠ¸ë¦¬ê±°ëœë‹¤.</span>

<span class="c1">// ì„ íƒ Functions</span>

<span class="kd">function</span> <span class="nf">name</span><span class="p">()</span>
   <span class="c1">// í† í°ì˜ ì´ë¦„ì„ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">symbol</span><span class="p">()</span>
   <span class="c1">// í† í°ì˜ ì‹¬ë³¼ì„ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">decimals</span><span class="p">()</span>
   <span class="c1">// í† í°ì„ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ì†Œìˆ˜ ìë¦¿ìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤.</span>
</code></pre></div></div>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>ERC20 ì»¨íŠ¸ë™íŠ¸ëŠ” 2ê°œì˜ ë°ì´í„° êµ¬ì¡°ë¥¼ í¬í•¨í•˜ê³  ìˆë‹¤.</p>
<ul>
  <li>(1) ì”ê³  ì¶”ì í•˜ê¸° (<strong>balance</strong>)</li>
  <li>(2) í—ˆìš©ëŸ‰ì„ ì¶”ì í•˜ê¸° (<strong>approve</strong>)</li>
</ul>

<p><strong>approve â†’ transferFrom</strong>  êµ¬ì¡°ëŠ” ê±°ë˜ì†Œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>ì˜ˆë¥¼ ë“¤ì–´, íšŒì‚¬ê°€ ICOë¥¼ ìœ„í•´ í† í°ì„ íŒë§¤í•˜ëŠ” ê²½ìš°, í¬ë¼ìš°ë“œì„¸ì¼ ì»¨íŠ¸ë™íŠ¸ë¥¼ approveí•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/josh-ico-1.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><img src="/assets/2023-12-05-mastering-ethereum/josh-ico-2.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>ì¼ë°˜ì ìœ¼ë¡œ ì»¨íŠ¸ë™íŠ¸ì˜  <code class="language-plaintext highlighter-rouge">transfer(from, to, 100 JOSH)</code>ë¥¼ ì‹¤í–‰í•  ë•Œ, ë°›ëŠ” ì£¼ì†Œë¥¼ ì»¨íŠ¸ë™íŠ¸ ìì²´ì˜ ì£¼ì†Œë¡œ ì…ë ¥í•  ê²½ìš° í† í°ì´ ì˜ì›íˆ ê°‡í˜€ ì†ì‹¤ëœë‹¤.</p>
<ul>
  <li>ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë°©ë²•ì€ í•´ë‹¹ ì»¨íŠ¸ë™íŠ¸ê°€  <strong>approve &amp; transferFrom</strong>  ì›Œí¬í”Œë¡œ í•¨ìˆ˜ë¥¼ í†µí•´ ë³´ë‚´ëŠ” ì£¼ì†Œê°€ transferFromì„ ì‚¬ìš©í•˜ì—¬ ë°˜í™˜í•˜ë„ë¡ í•˜ëŠ” ì½”ë“œë„ ë‚´ì¥ëœ ìƒíƒœê°€ ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒì´ë‹¤. ë¬¼ë¡ , ì´ëŠ” ë³´ë‚´ëŠ” ì£¼ì†Œì˜ ì§€ê°‘ ì•±ì´ transferFrom í•¨ìˆ˜ í˜¸ì¶œ ê¸°ëŠ¥ì„ ë³´ìœ í•´ì•¼ í•œë‹¤.</li>
</ul>

<p>í† í° ì „ì†¡ì—ì„œ íŠ¸ëœì­ì…˜ì´ í† í° ìˆ˜ì‹ ìì—ê²Œ ì‹¤ì œë¡œ ë³´ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. ëŒ€ì‹ , ë°›ëŠ” ì‚¬ëŒì˜ ì£¼ì†Œê°€ í† í° ì»¨íŠ¸ë™íŠ¸ ìì²´ì˜ ë§µì— ì¶”ê°€ëœë‹¤.</p>

<p><strong>ìƒíƒœ ë³€ê²½</strong></p>
<ul>
  <li>ETHë¥¼ ì£¼ì†Œë¡œ ë³´ë‚´ëŠ” íŠ¸ëœì­ì…˜: ì£¼ì†Œì˜ ìƒíƒœë¥¼ ë³€ê²½</li>
  <li>í† í°ì„ ì£¼ì†Œë¡œ ì „ì†¡í•˜ëŠ” íŠ¸ëœì­ì…˜: í† í° ì»¨íŠ¸ë™íŠ¸ì˜ ìƒíƒœë¥¼ ë³€ê²½ (ì£¼ì†Œì˜ ìƒíƒœëŠ” ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤.)</li>
</ul>

<p><strong>ERC20 í† í°ì˜ ë¬¸ì œì </strong></p>
<ul>
  <li>ERC20 í† í°ì„ ì§€ì›í•˜ëŠ” ì§€ê°‘ì¡°ì°¨ë„ ì‚¬ìš©ìê°€ í† í° ì»¨íŠ¸ë™íŠ¸ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì¶”ê°€í•˜ì§€ ì•ŠëŠ” í•œ í† í° ì”ì•¡ì„ ì¸ì‹í•˜ì§€ ëª»í•œë‹¤.</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/metamask.webp" alt="" /></p>
<blockquote>
  <p>ë©”íƒ€ë§ˆìŠ¤í¬ê°€ í† í° ì»¨íŠ¸ë™íŠ¸ë¥¼ ë§¤í•‘í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œëŠ” ìµœì¢… ì‚¬ìš©ìê°€ ì§ì ‘ Import Tokensë¥¼ í†µí•´ ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤. (ì¶œì²˜: Metamask Chrome Extension)</p>
</blockquote>

<ul>
  <li>ê±°ë˜ì†Œë¥¼ í†µí•´ ETHë¥¼ ERC20 í† í°ìœ¼ë¡œ êµí™˜í•  ë•ŒëŠ” ì†¡ê¸ˆ ëŒ€ìƒê³¼ ìˆ˜ìˆ˜ë£Œ ëŒ€ìƒì´ ëª¨ë‘ ETHì˜€ëŠ”ë°, ERC20 í† í°ì„ ETHë¡œ êµí™˜í•  ë•ŒëŠ” ì†¡ê¸ˆ ëŒ€ìƒê³¼ ìˆ˜ìˆ˜ë£Œ ëŒ€ìƒì´ ì„œë¡œ ë‹¬ë¼ì§„ë‹¤. ì´ëŠ” UX ì¸¡ë©´ì—ì„œ ë¶ˆí¸í•¨ì´ í•´ì†Œë˜ì–´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.</li>
</ul>

<h2 id="erc223-tokens">ERC223 Tokens</h2>

<p>ERC223ì€ tokenFallback í•¨ìˆ˜ë¥¼ í†µí•´ ëª©ì ì§€ ì£¼ì†Œë¥¼ ì»¨íŠ¸ë™íŠ¸ë¡œ ì„¤ì •í•˜ì—¬ ì˜ëª» ì†¡ê¸ˆí•˜ëŠ” ê²½ìš°ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ì œì•ˆëœ í‘œì¤€ì´ë‹¤.</p>

<h2 id="erc721-tokens">ERC721 Tokens</h2>

<p>ERC721ì€ ì¦ì„œ(deed)ë¡œë„ ì•Œë ¤ì§„ ëŒ€ì²´í•  ìˆ˜ ì—†ëŠ”(non-fungible) í† í°ì— ëŒ€í•œ í‘œì¤€ì„ ìœ„í•œ ê²ƒì´ë‹¤.</p>

<p>ERC721 í‘œì¤€ì€ ì¦ì„œì— ì˜í•´ ê·¸ ì†Œìœ ê¶Œì´ ê³ ìœ í•˜ê²Œ ì¶”ì ë  ìˆ˜ ìˆëŠ” í•œ, ê·¸ ëŒ€ìƒì˜ ì¢…ë¥˜ì— ëŒ€í•´ ì œí•œì´ë‚˜ ê·œì •ì„ ë‘ì§€ ì•Šìœ¼ë©°, ì´ëŸ¬í•œ ì¶”ì ì€ 256bit ì‹ë³„ìì— ì˜í•´ ì´ë£¨ì–´ì§„ë‹¤.</p>

<p><strong>ERC20 vs. ERC721 ë¹„êµ</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>êµ¬ë¶„</strong></th>
      <th><strong>ERC20</strong></th>
      <th><strong>ERC721</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ê¸°ë³¸ Mapping Key</strong></td>
      <td>address</td>
      <td>ì¦ì„œ(deed) ID</td>
    </tr>
    <tr>
      <td><strong>ì¶”ì  ëŒ€ìƒ</strong></td>
      <td>ê° addressì˜ ì”ì•¡</td>
      <td>ì¦ì„œ IDì™€ ownerâ€™s address</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>ERC721 ì»¨íŠ¸ë™íŠ¸ì˜ Interface í•„ìˆ˜ ì‚¬ì–‘ &amp; ì„ íƒ ì‚¬ì–‘</strong></p>

<ul>
  <li>í•„ìˆ˜ ì‚¬ì–‘ = ERC165</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// í•„ìˆ˜ Functions (ERC165)</span>
<span class="nf">balanceOf</span><span class="p">(</span><span class="nx">owner</span><span class="p">)</span>
   <span class="c1">// íŠ¹ì • ì£¼ì†Œê°€ ì†Œìœ í•œ ì¦ì„œì˜ ê°œìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤.</span>
<span class="nf">ownerOf</span><span class="p">(</span><span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// íŠ¹ì • ì¦ì„œì˜ ì†Œìœ ì ì£¼ì†Œë¥¼ ë¦¬í„´í•œë‹¤.</span>
<span class="nf">transfer</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// íŠ¹ì • ì¦ì„œë¥¼ í•´ë‹¹ ì£¼ì†Œë¡œ ì „ì†¡í•œë‹¤. payable ìƒíƒœê°€ ë¦¬í„´ëœë‹¤.</span>
<span class="nf">approve</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ ì£¼ì†Œê°€ íŠ¹ì • ì¦ì„œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìŠ¹ì¸í•œë‹¤. payable ìƒíƒœê°€ ë¦¬í„´ëœë‹¤.</span>
<span class="nf">setApprovalForAll</span><span class="p">(</span><span class="nx">operator</span><span class="p">,</span> <span class="nx">approved</span><span class="p">)</span>
   <span class="c1">//  í•´ë‹¹ ì£¼ì†Œë¡œ ëª¨ë“  ì¦ì„œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìŠ¹ì¸í•œë‹¤. payable ìƒíƒœê°€ ë¦¬í„´ëœë‹¤.</span>
<span class="nf">transferFrom</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// ë³´ë‚´ëŠ” ì£¼ì†Œì—ì„œ ë°›ëŠ” ì£¼ì†Œë¡œ íŠ¹ì • ì¦ì„œë¥¼ ì „ì†¡í•œë‹¤. ë³´ë‚´ëŠ” ì£¼ì†Œë¡œë¶€í„° approveë¥¼ ë°›ì€ ê²½ìš°ì—ë§Œ ê°€ëŠ¥í•˜ë‹¤. ê·¸ë¦¬ê³  payable ìƒíƒœê°€ ë¦¬í„´ëœë‹¤.</span>
<span class="nf">supportsInterface</span><span class="p">(</span><span class="nx">interfaceId</span><span class="p">)</span>
   <span class="c1">// Interface ê²€ì¦ì„ í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ interface ì§€ì› ì—¬ë¶€ë¥¼ boolë¡œ ë¦¬í„´í•œë‹¤.</span>

<span class="c1">// í•„ìˆ˜ Events (ERC165)</span>
<span class="nx">event</span> <span class="nc">Transfer</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// transferë‚˜ transferFromì´ payable ë˜ë©´ Transfer ì´ë²¤íŠ¸ê°€ íŠ¸ë¦¬ê±°ëœë‹¤.</span>
<span class="nx">event</span> <span class="nc">Approval</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">approved</span><span class="p">,</span> <span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// approveê°€ payable ë˜ë©´ Approval ì´ë²¤íŠ¸ê°€ íŠ¸ë¦¬ê±°ëœë‹¤.</span>
<span class="nx">event</span> <span class="nc">ApprovalForAll</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">operator</span><span class="p">,</span> <span class="nx">approved</span><span class="p">)</span>
   <span class="c1">// setApprovalForAllì´ payable ë˜ë©´ ApprovalForAll ì´ë²¤íŠ¸ê°€ íŠ¸ë¦¬ê±°ëœë‹¤.</span>
</code></pre></div></div>

<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<ul>
  <li>ì„ íƒ ì‚¬ì–‘</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì„ íƒ Functions (ë©”íƒ€ë°ì´í„°) (ERC721)</span>
<span class="kd">function</span> <span class="nf">name</span><span class="p">()</span>
   <span class="c1">// ë³¸ ì»¨íŠ¸ë™íŠ¸ì˜ ì´ë¦„ì„ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">symbol</span><span class="p">()</span>
   <span class="c1">// ë³¸ ì»¨íŠ¸ë™íŠ¸ì˜ ì‹¬ë³¼ì„ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">tokenUri</span><span class="p">(</span><span class="nx">tokenId</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ ì¦ì„œì— ì—°ê²°ëœ ë©”íƒ€ë°ì´í„° ì£¼ì†Œì¸ URIë¥¼ ë¦¬í„´í•œë‹¤.</span>

<span class="c1">// ì„ íƒ Functions (ì¦ì„œ ë° ì†Œìœ ì ì—´ê±°) (ERC721)</span>
<span class="kd">function</span> <span class="nf">totalSupply</span><span class="p">()</span>
   <span class="c1">// í˜„ì¬ ì¡´ì¬í•˜ëŠ” ì¦ì„œì˜ ì „ì²´ ê°œìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">tokenByIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ indexì— ìœ„ì¹˜í•˜ëŠ” ì¦ì„œì˜ IDë¥¼ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">countOfOwners</span><span class="p">()</span>
   <span class="c1">// í˜„ì¬ ì¡´ì¬í•˜ëŠ” ì†Œìœ ì ì£¼ì†Œì˜ ì „ì²´ ê°œìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">ownerByIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ indexì— ìœ„ì¹˜í•˜ëŠ” ì¦ì„œì˜ ì†Œìœ ì ì£¼ì†Œë¥¼ ë¦¬í„´í•œë‹¤.</span>
<span class="kd">function</span> <span class="nf">tokenOfOwnerByIndex</span><span class="p">(</span><span class="nx">owner</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span>
   <span class="c1">// í•´ë‹¹ indexì— ìœ„ì¹˜í•˜ëŠ” ì¦ì„œì™€ ì†Œìœ ì ì£¼ì†Œë¥¼ í†µí•´ ì¦ì„œì˜ IDë¥¼ ë¦¬í„´í•œë‹¤.</span>
</code></pre></div></div>

<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>í† í° í‘œì¤€ì˜ ëª©ì </strong></p>
<ul>
  <li>ì»¨íŠ¸ë™íŠ¸ ê°„ì˜ ìƒí˜¸ìš´ìš©ì„±(Interoperability)ì„ ì¥ë ¤í•˜ëŠ” ê²ƒì´ë‹¤.</li>
  <li>ì¦‰, ERC20 í‘œì¤€ì„ ë”°ë¥´ëŠ” ì»¨íŠ¸ë™íŠ¸ë¥¼ ë°°í¬í•˜ë©´ ê¸°ì¡´ ì§€ê°‘ ì‚¬ìš©ìëŠ” ì§€ê°‘ì„ ì—…ê·¸ë ˆì´ë“œí•˜ëŠ” ë…¸ë ¥ì„ ë“¤ì´ì§€ ì•Šê³ ë„ í† í°ì„ ì›í™œí•˜ê²Œ ì „ì†¡í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<h1 id="12-chapter-11-oracles">12. [Chapter 11] Oracles</h1>

<p>í•©ì˜ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ EVM ì‹¤í–‰ì€ ì™„ì „íˆ ê²°ì •ë¡ ì ì´ê³ , ì´ë”ë¦¬ì›€ ìƒíƒœì™€ ì„œëª…ëœ íŠ¸ëœì­ì…˜ì˜ ê³µìœ  ì»¨í…ìŠ¤íŠ¸ì— ê¸°ë°˜ì„ ë‘ê³  ìˆì–´ì•¼ í•œë‹¤.</p>
<ul>
  <li>(1) EVM ë° ìŠ¤ë§ˆí¬ ì»¨íŠ¸ë™íŠ¸ëŠ” ì„ì˜ì„±ì„ ìœ„í•œ ê³ ìœ í•œ ì†ŒìŠ¤ê°€ ì—†ë‹¤.</li>
  <li>(2) ì™¸ë¶€ ë°ì´í„°ëŠ” íŠ¸ëœì­ì…˜ì˜ ë°ì´í„° payloadë¡œì„œë§Œ ìœ ì…ë  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p>ì˜ˆë¥¼ ë“¤ë©´, EVMì´ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì— Random Functionì˜ ì‚¬ìš©ì„ ê¸ˆì§€í•˜ëŠ” ë§¥ë½ì€ ëŒ€ê°• ê·¸ë¦¼ê³¼ ê°™ë‹¤.</p>

<p><img src="/assets/2023-12-05-mastering-ethereum/random-function.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>ì˜¤ë¼í´ì€ ì´ìƒì ìœ¼ë¡œ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¥¼ ìœ„í•´ ì´ë”ë¦¬ì›€ í”Œë«í¼ìœ¼ë¡œ ì¶•êµ¬ ê²½ê¸°ì˜ ê²°ê³¼ë‚˜ ê¸ˆ ê°€ê²© í˜¹ì€ ìˆœìˆ˜ ë‚œìˆ˜ì™€ ê°™ì€ ì™¸ë¶€ (Off-chain) ì •ë³´ë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” ë° Trustless ë°©ë²•ì„ ì œê³µí•œë‹¤.</p>

<p><strong>ì˜¤ë¼í´ì˜ í•µì‹¬ ë””ìì¸</strong></p>
<ul>
  <li>(1) Off-chain ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³ ,</li>
  <li>(2) ì´ ë°ì´í„°ë¥¼ Signed Msgë¡œ On-chainì— ì „ì†¡í•˜ê³ ,</li>
  <li>(3) ì´ë¥¼ ì»¨íŠ¸ë™íŠ¸ì˜ Storageì— ì €ì¥í•˜ì—¬ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<h2 id="ì˜¤ë¼í´-ì„¤ì •í•˜ëŠ”-ì„¸-ê°€ì§€-ë°©ë²•"><strong>ì˜¤ë¼í´ ì„¤ì •í•˜ëŠ” ì„¸ ê°€ì§€ ë°©ë²•</strong></h2>

<p><strong>(1) ì¦‰ì‹œ ì½ê¸°</strong></p>
<ul>
  <li>ì¦‰ì‹œ ì½ê¸° ë°©ì‹ì˜ ì˜¤ë¼í´ì€ â€˜<a href="http://ethereumbook.info/">http://ethereumbook.info</a>ì˜ ì£¼ì†ŒëŠ” ë¬´ì—‡ì¸ê°€?â€™ ë˜ëŠ” â€˜ì´ ì‚¬ëŒì€ 18ì„¸ ì´ìƒì¸ê°€?â€™ì™€ ê°™ì€ ì¦‰ê°ì ì¸ ê²°ì •ì´ í•„ìš”í•œ ë°ì´í„°ë§Œì„ ì œê³µí•œë‹¤.</li>
  <li>ì´ëŸ° ì¢…ë¥˜ì˜ ì˜¤ë¼í´ì€ ì»¨íŠ¸ë™íŠ¸ Storageì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³ , ë‹¤ë¥¸ ì»¨íŠ¸ë™íŠ¸ëŠ” ì˜¤ë¼í´ ì»¨íŠ¸ë™íŠ¸ì— ìš”ì²­ì„ í•´ì„œ ì´ëŸ¬í•œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ì´ ë°ì´í„°ëŠ” ì—…ë°ì´íŠ¸ë  ìˆ˜ë„ ìˆë‹¤.</li>
  <li>ì˜¤ë¼í´ Storageì— ìˆëŠ” ë°ì´í„°ëŠ” dAppì— ì˜í•´ ì§ì ‘ ì¡°íšŒë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë²ˆê±°ë¡œìš´ ì ˆì°¨ë‚˜ íŠ¸ëœì­ì…˜ì„ ì²˜ë¦¬í•˜ëŠ” Gas Feeê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤.</li>
  <li>ì´ ì €ì¥ëœ ë°ì´í„°ëŠ” íš¨ìœ¨ì„±ì´ë‚˜ í”„ë¼ì´ë²„ì‹œ ë•Œë¬¸ì— Raw Dataê°€ ì•„ë‹Œ, ë¨¸í´ íŠ¸ë¦¬ì—ì„œ Hashingëœ Root Hashë¥¼ ì €ì¥í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>(2) ê²Œì‹œ-êµ¬ë…</strong></p>
<ul>
  <li>ê²Œì‹œ-êµ¬ë… ë°©ì‹ì˜ ì˜¤ë¼í´ì€ ê°’ì˜ ì—…ë°ì´íŠ¸ê°€ ë¹ˆë²ˆí•œ ë°ì´í„°ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸í•˜ëŠ” ì—­í• ë¡œ ì œê³µí•œë‹¤.</li>
  <li>ì´ ë°ì´í„°ëŠ” ì˜¨ì²´ì¸ ì»¨íŠ¸ë™íŠ¸ì— ì˜í•´ pollingë˜ê±°ë‚˜ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ Off-chain ë°ëª¬ì— ì˜í•´ ëª¨ë‹ˆí„°ë§ëœë‹¤.</li>
  <li>ì¦‰, ì˜¤ë¼í´ì´ ìƒˆë¡œìš´ ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸ë˜ë©´, ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì“¸ ìˆ˜ ìˆìŒì„ êµ¬ë…ìë“¤ì—ê²Œ ì•Œë¦°ë‹¤.</li>
  <li>Pollingì´ ì»¨íŠ¸ë™íŠ¸ë¡œë¶€í„° ìˆ˜í–‰ë˜ì–´ì•¼ í•˜ëŠ” ê²½ìš° ìƒë‹¹í•œ Gas Feeê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>(3) ìš”ì²­-ì‘ë‹µ</strong></p>
<ul>
  <li>ìš”ì²­-ì‘ë‹µ ë°©ì‹ì˜ ì˜¤ë¼í´ì€ ì»¨íŠ¸ë™íŠ¸ì— ì €ì¥í•˜ê¸°ì—ëŠ” ë°ì´í„°ê°€ ë„ˆë¬´ í¬ê³ , ì‚¬ìš©ìëŠ” ê·¸ ì¤‘ ì¼ë¶€ì˜ ë°ì´í„°ë§Œ í•„ìš”í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ëœë‹¤.</li>
  <li>ìš”ì²­-ì‘ë‹µ ë°©ì‹ì€ ê·¸ë¦¼ê³¼ ê°™ì´ ì—¬ëŸ¬ ë‹¨ê³„ì— ê±¸ì¹œ ë¹„ë™ê¸° í”„ë¡œì„¸ìŠ¤ì´ë‹¤.</li>
</ul>

<pre><code class="language-plain"># ìš”ì²­-ì‘ë‹µ ë°©ì‹ ì˜¤ë¼í´ì˜ í”„ë¡œì„¸ìŠ¤
   (1) ì˜¤ë¼í´ CAê°€ dAppìœ¼ë¡œë¶€í„° ì§ˆì˜(query)ë¥¼ ë°›ëŠ”ë‹¤.
   (2) ì˜¤ë¼í´ CAëŠ” í•´ë‹¹ ì§ˆì˜ë¥¼ ë¶„ì„í•œë‹¤.
   (3) ì˜¤ë¼í´ CAëŠ” dAppì˜ ë¹„ìš© ì§€ë¶ˆ ì—¬ë¶€ì™€ ì ‘ê·¼ ê¶Œí•œ ë“±ì„ í™•ì¸í•œë‹¤.
   (4) ì˜¤ë¼í´ CAëŠ” Off-chain ì†ŒìŠ¤ì—ì„œ ê´€ë ¨ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•œë‹¤.
   (5) ì˜¤ë¼í´ CAëŠ” ê²€ìƒ‰ëœ ë°ì´í„°ê°€ í¬í•¨ëœ TXì— Signí•œë‹¤.
   (6) ì˜¤ë¼í´ CAëŠ” Signed TXë¥¼ ë„¤íŠ¸ì›Œí¬ë¡œ ì „íŒŒí•œë‹¤.
   (7) ì•Œë¦¼ ë“± í•„ìš”í•œ ì¶”ê°€ TXë¥¼ ìŠ¤ì¼€ì¤„ë§í•œë‹¤.
</code></pre>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<h2 id="ê³„ì‚°-ì˜¤ë¼í´">ê³„ì‚° ì˜¤ë¼í´</h2>

<p>ì§€ê¸ˆê¹Œì§€ëŠ” ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê³  ì „ë‹¬í•˜ëŠ” ë§¥ë½ì˜ ì˜¤ë¼í´ì´ì—ˆë‹¤ë©´, ê³„ì‚° ì˜¤ë¼í´ì€ On-chainì—ì„œ ì‹¤í–‰ ë¶ˆê°€ëŠ¥í•œ ê³„ì‚°ì„ ë¦¬í„´í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>ì˜ˆë¥¼ ë“¤ë©´, ê³„ì‚° ì˜¤ë¼í´ì„ í†µí•´ íšŒê·€ ê³„ì‚°ì´ë‚˜ ë¨¸ì‹ ëŸ¬ë‹ì„ ìˆ˜í–‰í•˜ì—¬ ì±„ê¶Œ ì»¨íŠ¸ë™íŠ¸ì˜ ìˆ˜ìµë¥ ì„ ì¶”ì •í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ì¤‘ì•™í™”ëœ ë°ì´í„° ë˜ëŠ” ê³„ì‚° ì˜¤ë¼í´ì€ ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì—ì„œëŠ” ë‹¨ì¼ ì‹¤íŒ¨ ì§€ì (SPOF)ì´ ëœë‹¤.</li>
</ul>

<p><strong>ê³„ì‚° ì˜¤ë¼í´ ë¬¸ì œì˜ ê°œì„  ë°©ë²•: íƒˆì¤‘ì•™í™” ì˜¤ë¼í´</strong></p>
<ul>
  <li>íƒˆì¤‘ì•™í™” ì˜¤ë¼í´ì€ ë°ì´í„° ê°€ìš©ì„±ì„ ë³´ì¥í•˜ê³  On-chain ë°ì´í„° Aggregation ì‹œìŠ¤í…œì„ ê°–ì¶˜ ê°œë³„ ë°ì´í„° ì œê³µìì˜ ë„¤íŠ¸ì›Œí¬ë¥¼ ë§Œë“œëŠ” ìˆ˜ë‹¨ì´ë‹¤.</li>
  <li><strong>ì²´ì¸ë§í¬</strong>: í‰íŒ CA, ì˜¤ë”ë§¤ì¹­ CA, Aggregation CAë¼ëŠ” 3ê°€ì§€ í•µì‹¬ ì»¨íŠ¸ë™íŠ¸ì™€ ë°ì´í„° ê³µê¸‰ìì˜ Off-chain ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œ êµ¬ì„±ëœ íƒˆì¤‘ì•™í™” ì˜¤ë¼í´ ë„¤íŠ¸ì›Œí¬ì´ë‹¤.</li>
  <li><strong>Aggregation CA</strong>: ì—¬ëŸ¬ ì˜¤ë¼í´ë¡œë¶€í„° ì‘ë‹µì„ ìˆ˜ì§‘í•˜ê³ , ìµœì¢… ê²°ê³¼ë¥¼ ê³„ì‚°í•˜ì—¬, ê·¸ ê²°ê³¼ë¥¼ í”¼ë“œë°±í•´ì¤€ë‹¤.</li>
  <li>Aggregationì„ ìœ„í•œ í•¨ìˆ˜ë¥¼ ê³µì‹í™”í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì–´ë ¤ìš´ ë¬¸ì œì¸ë°, ê°’ì˜ ë¶„í¬ë¥¼ í†µí•œ penalizing, median ë“± ë‹¤ì–‘í•œ ì§‘ê³„ ë°©ë²•ë“¤ì´ ìˆë‹¤.</li>
</ul>

<h1 id="13-chapter-12-decentralized-applications-dapps">13. [Chapter 12] Decentralized Applications (dApps)</h1>

<p>dAppì€ ëŒ€ë¶€ë¶„ ë˜ëŠ” ì™„ì „íˆ íƒˆì¤‘ì•™í™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‹¤. ì…˜ì‹¤ì ìœ¼ë¡œ ì´ë”ë¦¬ì›€ ìƒíƒœê³„ì—ì„œ ì™„ì „íˆ íƒˆì¤‘ì•™í™”ëœ ì•±ì€ ë§¤ìš° ë“œë¬¼ë‹¤. ëŒ€ë¶€ë¶„ ì¤‘ì•™í™”ëœ ì„œë¹„ìŠ¤ì™€ ì„œë²„ë¥¼ ì‚¬ìš©í•˜ëŠ” í˜•íƒœì˜ dAppì´ë‹¤.</p>

<p><strong>ì „í˜•ì ì¸ ì¤‘ì•™í™”ëœ ì•„í‚¤í…ì²˜ì™€ ëŒ€ë¹„í•˜ì—¬ dAppì´ ê°€ì§„ ì¥ì </strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ì§€ì†ì„±</code></li>
  <li><code class="language-plaintext highlighter-rouge">íˆ¬ëª…ì„±</code></li>
  <li><code class="language-plaintext highlighter-rouge">ê²€ì—´ì €í•­ì„±</code></li>
</ul>

<h2 id="ì• í”Œë¦¬ì¼€ì´ì…˜ì´-íƒˆì¤‘ì•™í™”ë -ìˆ˜-ìˆëŠ”-ì¸¡ë©´ë“¤">ì• í”Œë¦¬ì¼€ì´ì…˜ì´ íƒˆì¤‘ì•™í™”ë  ìˆ˜ ìˆëŠ” ì¸¡ë©´ë“¤</h2>

<p><strong>(1) ë°±ì—”ë“œ: ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸</strong></p>
<ul>
  <li>ì•±ì˜ ë°±ì—”ë“œ í˜¹ì€ ì„œë²„ êµ¬ì„±ìš”ì†Œë¥¼ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡ , ì»¨íŠ¸ë™íŠ¸ì˜ ì‹¤í–‰ ë¹„ìš©ì´ ë§¤ìš° ë¹„ì‹¸ê¸° ë•Œë¬¸ì— ìµœì†Œí•œì˜ ë¶€ë¶„ë§Œ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.</li>
  <li>ì»¨íŠ¸ë™íŠ¸ê°€ ë°°í¬ëœ í›„ ì½”ë“œë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.  <strong>SELFDESTRUCT</strong>  ì—°ì‚°ì½”ë“œê°€ í”„ë¡œê·¸ë˜ë°ëœ ê²½ìš°ì™„ì „íˆ ì œê±°í•˜ëŠ” ê²ƒ ì™¸ì—ëŠ” ì½”ë“œ ìì²´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤.</li>
</ul>

<p><strong>(2) í”„ë¡ íŠ¸ì—”ë“œ: ì›¹ UI</strong></p>
<ul>
  <li>dApp í´ë¼ì´ì–¸íŠ¸ ìª½ ì¸í„°í˜ì´ìŠ¤ëŠ” HTML/CSS/JSë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë©”ì‹œì§€ ì„œëª…, TX ì „ì†¡, í‚¤ ê´€ë¦¬ ê°™ì€ ì´ë”ë¦¬ì›€ê³¼ì˜ ìƒí˜¸ì‘ìš©ì€ Metamask ê°™ì€ ìµìŠ¤í…ì…˜ì„ í†µí•´ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ìˆ˜í–‰ëœë‹¤.</li>
</ul>

<p><strong>(3) ë°ì´í„° ìŠ¤í† ë¦¬ì§€</strong></p>
<ul>
  <li>ë†’ì€ Gas Priceì™€ ë‚®ì€ Block Gas Limit ë•Œë¬¸ì— ì»¨íŠ¸ë™íŠ¸ëŠ” ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì²˜ë¦¬í•˜ëŠ” ë° ì í•©í•˜ì§€ ì•Šë‹¤.</li>
  <li>ë”°ë¼ì„œ ëŒ€ë¶€ë¶„ì˜ dAppì€ Off-chain ë°ì´í„° ìŠ¤í† ë¦¬ì§€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°, ì‚¬ì´ì¦ˆê°€ í° ë°ì´í„°ë“¤ì„ ì´ë”ë¦¬ì›€ ì²´ì¸ìœ¼ë¡œë¶€í„° ë°ì´í„° ìŠ¤í† ë¦¬ì§€ í”Œë«í¼ìœ¼ë¡œ ì˜®ê²¨ ì €ì¥í•œë‹¤.</li>
  <li>í´ë¼ìš°ë“œ ì²˜ëŸ¼ ì¤‘ì•™í™”ëœ ë°©ì‹, í˜¹ì€ IPFSë‚˜ ì´ë”ë¦¬ì›€ì˜ Swarm ê°™ì€ íƒˆì¤‘ì•™í™”ëœ ë°©ì‹</li>
  <li><strong>IPFS(Inter-planetary File System)</strong>: ì €ì¥ëœ ê°ì²´ë¥¼ P2P ë„¤íŠ¸ì›Œí¬ ë‚´ Peerë“¤ì—ê²Œ ë°°í¬í•˜ëŠ” content-addressable ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œì´ë‹¤.</li>
  <li>content-addressableì´ë€, ê° íŒŒì¼ì´ hashingë˜ê³ , ê·¸ hashë¥¼ í†µí•´ í•´ë‹¹ íŒŒì¼ì„ ì‹ë³„í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤. ì¦‰, hashë¡œ ìš”ì²­í•˜ì—¬ ëª¨ë“  IPFS ë…¸ë“œì—ì„œ íŒŒì¼ì„ ê²€ìƒ‰í•  ìˆ˜ ìˆë‹¤.</li>
  <li><strong>Swarm</strong>: IPFSì™€ ìœ ì‚¬í•œ content-addressable P2P ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œì´ë‹¤.</li>
</ul>

<p><strong>(4) ë©”ì‹œì§€ í†µì‹ </strong></p>
<ul>
  <li>ì•± ê°„, ì•± ë‚´ ì¸ìŠ¤í„°ìŠ¤ ê°„, í˜¹ì€ ì•± ì‚¬ìš©ì ê°„ì˜ ë©”ì‹œì§€ë¥¼ êµí™˜í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ê°€ì§€ íƒˆì¤‘ì•™í™” í”„ë¡œí† ì½œì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ëŒ€í‘œì ìœ¼ë¡œ Go-ethereumì˜ ì¼ë¶€ ë„êµ¬ì¸ Whisper</li>
</ul>

<p><strong>(5) ë„¤ì„ ë ˆì¡¸ë£¨ì…˜ (Name Resolution)</strong></p>
<ul>
  <li>ENS(Ethereum Name Service)</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/ens.webp" alt="" /></p>
<blockquote>
  <p><a href="https://docs.ens.domains/">Source</a></p>
</blockquote>

<p><strong>ê²½ë§¤ dAppì˜ ì•„í‚¤í…ì²˜ ìš´ìš© ì‚¬ë¡€</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/auction-dapp.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>ê²½ë§¤ dAppì˜ ì£¼ìš” êµ¬ì„±ìš”ì†Œ</strong></p>
<ul>
  <li>ERC721 ì»¨íŠ¸ë™íŠ¸</li>
  <li>ê²½ë§¤ ì»¨íŠ¸ë™íŠ¸</li>
  <li>Vue JS í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” Web Frontend</li>
  <li>ì´ë”ë¦¬ì›€ì— ì—°ê²°í•˜ëŠ” web3.js ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
  <li>ë°ì´í„° ìŠ¤í† ë¦¬ì§€ì¸ Swarm í´ë¼ì´ì–¸íŠ¸</li>
  <li>ê²½ë§¤ ëŒ€í™”ë°©ì„ ìœ„í•œ Whisper í´ë¼ì´ì–¸íŠ¸</li>
</ul>

<p><strong>ê²½ë§¤ dAppì„ ë” íƒˆì¤‘ì•™í™”í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ í¬ê²Œ ë‘ ê°€ì§€</strong></p>
<ul>
  <li>ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ŒìŠ¤ì½”ë“œë¥¼ Swarmì´ë‚˜ IPFSì— ì €ì¥í•œë‹¤.</li>
  <li>ENSë¥¼ ì‚¬ìš©í•˜ì—¬ Nameì„ ì°¸ì¡°í•˜ì—¬ dAppì— ì ‘ê·¼í•œë‹¤.</li>
</ul>

<p><strong>dApp ê±°ë²„ë„ŒìŠ¤ëŠ” í¬ê²Œ ë‘ ê°€ì§€ ì˜µì…˜ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ ë°°í¬í•  ìˆ˜ ìˆë‹¤.</strong></p>
<ul>
  <li>dAppì˜ ì»¨íŠ¸ë™íŠ¸ì— ëŒ€í•œ íŠ¹ì • í†µì œê¶Œì„ ì§€ë‹Œ EOAê°€ ìˆëŠ” ê²½ìš°</li>
  <li>dAppì˜ ì»¨íŠ¸ë™íŠ¸ì— ëŒ€í•œ íŠ¹ì • í†µì œê¶Œì„ ì§€ë‹Œ EOAê°€ ì—†ëŠ” ê²½ìš°</li>
</ul>

<p>dAppì„ êµ¬ì¶•í•  ë•Œ ì»¨íŠ¸ë™íŠ¸ë¥¼ ì™„ì „íˆ ë…ë¦½ì ìœ¼ë¡œ ë§Œë“¤ê³  ì¶œì‹œí•œ í›„ì— ì œì–´í•  ê¶Œí•œì„ ì—†ê²Œ ë§Œë“¤ë“ ì§€ ë˜ëŠ” íŠ¹ê¶Œ ê³„ì •ì„ ë§Œë“¤ê³  ìœ„í—˜ì— ë…¸ì¶œë  ìœ„í—˜ì„ ê°ìˆ˜í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ê²°ì •í•´ì•¼ í•œë‹¤.</p>
<ul>
  <li>í•˜ì§€ë§Œ ì¥ê¸°ì ìœ¼ë¡œ ì§„ì •í•œ dAppì€ íŠ¹ê¶Œ ê³„ì •ì„ ìœ„í•œ íŠ¹ìˆ˜ ì ‘ê·¼ ê¶Œí•œì„ í—ˆìš©í•˜ì§€ ë§ì•„ì•¼ í•œë‹¤. ì™œëƒí•˜ë©´ ê·¸ê²ƒì€ íƒˆì¤‘ì•™í™”ëœ ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.</li>
</ul>

<h2 id="ens-ethereum-name-service">ENS (Ethereum Name Service)</h2>

<p>ì „í†µì ì¸ ì¸í„°ë„·ì—ì„œ DNS(Domain Name System)ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ì´ë¦„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ì´ë”ë¦¬ì›€ ë¸”ë¡ì²´ì¸ì—ì„œëŠ” ENS(Ethereum Name Service)ê°€ ì´ì™€ ê°™ì€ ë¬¸ì œë¥¼ íƒˆì¤‘ì•™í™”ëœ ë°©ì‹ìœ¼ë¡œ í’€ì–´ì¤€ë‹¤.</p>
<ul>
  <li>ì´ë”ë¦¬ì›€ ì¬ë‹¨ì˜ ê¸°ë¶€ ì£¼ì†Œ  <strong>0xfB6916â€¦d359</strong>: ENSë¥¼ ì§€ì›í•˜ëŠ” ì§€ê°‘ì—ì„œëŠ” ê°„ë‹¨í•˜ê²Œ  <strong>ethereum.eth</strong></li>
  <li>Nameì˜ ë“±ë¡, ê´€ë¦¬, ê·¸ë¦¬ê³  ê²½ë§¤ë¥¼ ìœ„í•œ ì—¬ëŸ¬ dAppì´ ENS ê¸°ëŠ¥ì„ ì§€ì›</li>
</ul>

<p><strong>ENSì˜ ê°œì„  ì œì•ˆ 3ê°€ì§€</strong></p>
<ul>
  <li>ENSì˜ ê¸°ë³¸ ê¸°ëŠ¥ ì •ì˜í•œ EIP-137</li>
  <li><code class="language-plaintext highlighter-rouge">.eth</code> ë£¨íŠ¸ì˜ ê²½ë§¤ ì‹œìŠ¤í…œì„ ì„¤ëª…í•œ EIP-162</li>
  <li>ì£¼ì†Œì˜ ì—­ ë“±ë¡ì„ ì§€ì •í•œ EIP-181</li>
</ul>

<p><strong>ENSëŠ” ë‹¤ìŒ ê·¸ë¦¼ê³¼ ê°™ì´ â€˜ìƒŒë“œìœ„ì¹˜â€™ ë””ìì¸ ì² í•™</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/ens-sandwich.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>ë§¨ ì•„ë˜ ê³„ì¸µ (EIP-137)</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/eip-137.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>Namehash ì•Œê³ ë¦¬ì¦˜</p>
<ul>
  <li>ì–´ë–¤ ì´ë¦„ì´ë¼ë„ ê·¸ ì´ë¦„ì„ ì‹ë³„í•˜ëŠ” í•´ì‹œë¡œ ë³€í™˜í•  ìˆ˜ ìˆëŠ” Recursive ì•Œê³ ë¦¬ì¦˜</li>
  <li>ì¦‰, NamehashëŠ” ì¬ê·€ì ìœ¼ë¡œ ì´ë¦„ì˜ ê° êµ¬ì„±ìš”ì†Œë¥¼ í•´ì‹œí•˜ì—¬ ìœ íš¨í•œ ì…ë ¥ ë„ë©”ì¸ì— ëŒ€í•œ ê³ ìœ í•œ ê³ ì • ê¸¸ì´ ë¬¸ìì—´(ë˜ëŠ” node)ì„ ìƒì„±í•œë‹¤.</li>
  <li>ì¬ê·€ì„±ì´ ì¤‘ìš”í•œ ì´ìœ ëŠ” ê° nameì´ ì„œë¸Œë„ë©”ì¸ì„ ë¬´í•œíˆ ê°€ì§ˆ ìˆ˜ ìˆëŠ”ë°, ì´ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì¬ê³„ì‚°í•˜ë ¤ë©´ Gas Feeê°€ ë§ì´ ì†Œìš”ë˜ë¯€ë¡œ, ë£¨íŠ¸ ë„ë©”ì¸ì˜ node ê°’ì„ ë¯¸ë¦¬ ì»¨íŠ¸ë™íŠ¸ì— ì‚½ì…í•˜ì—¬ ê³„ì‚° íš¨ìœ¨ì„±ì„ ê°–ì¶”ê¸° ìœ„í•œ ê²ƒì´ë‹¤.</li>
  <li>ìœ„ ê·¸ë¦¼ì—ì„œ nodeëŠ” Namehash ì•Œê³ ë¦¬ì¦˜ì— ì˜í•´ ë³€í™˜ëœ hashë¥¼ ì˜ë¯¸í•œë‹¤.</li>
</ul>

<p>resolver ì»¨íŠ¸ë™íŠ¸</p>
<ul>
  <li>ì•±ê³¼ ê´€ë ¨ëœ Swarm ì£¼ì†Œ, ì•±ì— ì§€ë¶ˆí•  ì£¼ì†Œë‚˜ ì•±ì˜ Hashì™€ ê°™ì€ ì´ë¦„ì— ëŒ€í•œ ì§ˆë¬¸ì— ë‹µë³€í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ìƒì„± ì»¨íŠ¸ë™íŠ¸ì´ë‹¤.</li>
</ul>

<p><strong>ì¤‘ê°„ ê³„ì¸µ (EIP-162)</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/eip-162.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>ìµœìƒìœ„ ê³„ì¸µ (EIP-181)</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/eip-181.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>ENSì—ì„œ ì´ë¦„ì„ í™•ì¸í•˜ëŠ” ê³¼ì •</strong></p>
<ul>
  <li>(1) í•´ì„í•˜ê³  ì‹¶ì€ ì´ë¦„ì„ í†µí•´ ENS Registryê°€ í˜¸ì¶œëœë‹¤.</li>
  <li>(2) ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ë©´ ENS RegistryëŠ” resolverì˜ ì£¼ì†Œë¥¼ ë¦¬í„´í•œë‹¤.</li>
  <li>(3) í•´ë‹¹ ì£¼ì†Œì˜ resolverëŠ” ìš”ì²­ëœ ìì›ì— ì ì ˆí•œ methodë¥¼ í†µí•´ í˜¸ì¶œëœë‹¤.</li>
  <li>(4) resolverëŠ” ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ë¦¬í„´í•œë‹¤.</li>
</ul>

<p>ì´ í”„ë¡œì„¸ìŠ¤ëŠ” resolverì˜ ê¸°ëŠ¥ì„ naming system ìì²´ì™€ ë¶„ë¦¬í•˜ì—¬ ë” ë§ì€ ìœ ì—°ì„±ì„ ì–»ì„ ìˆ˜ ìˆë‹¤ëŠ” ì´ì ì´ ìˆë‹¤. ì¦‰, ENSì˜ í–¥í›„ í™•ì¥í•˜ê¸° ìš©ì´í•œ ê²ƒì´ë‹¤.</p>

<p><strong>ê²½ë§¤ dAppì„ ì™„ì „íˆ íƒˆì¤‘ì•™í™”ëœ ìƒíƒœì¼ ë•Œ ì•„í‚¤í…ì²˜ ì‚¬ë¡€</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/dapp-browser.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<h1 id="14-chapter-13-ethereum-virtual-machine-evm">14. [Chapter 13] Ethereum Virtual Machine (EVM)</h1>

<p>EVMì€ ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ì˜ .NET í”„ë ˆì„ì›Œí¬ VMì´ë‚˜ Javaì™€ ê°™ì€ Bytecode ì»´íŒŒì¼ëœ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì˜ Interpreterì™€ ë¹„ìŠ·í•œ ì—­í• ì„ í•˜ëŠ” ê³„ì‚° ì—”ì§„ì´ë‹¤.</p>

<p>EVMì€ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ë°°í¬ ë° ì‹¤í–‰ì„ ì²˜ë¦¬í•˜ëŠ” ì´ë”ë¦¬ì›€ì˜ ì¼ë¶€ë‹¤.</p>
<ul>
  <li>EOA to EOAë¡œì˜ ê°„ë‹¨í•œ ê°’ì„ ì „ì†¡í•˜ëŠ” TXëŠ” ì‚¬ì‹¤ìƒ EVMì´ í•„ìš” ì—†ì§€ë§Œ, ê·¸ ì™¸ ëª¨ë“  ê²ƒì€ EVMì— ì˜í•œ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜ë°˜í•œë‹¤.</li>
</ul>

<p>EVMì€ ìœ ì‚¬ íŠœë§ ì™„ì „ ìƒíƒœ ë¨¸ì‹ (quasi-Turing-complete state machine)ì´ë‹¤.</p>
<ul>
  <li>ì´ê²ƒì€ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì‹¤í–‰ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°€ìŠ¤ëŸ‰ì— ë”°ë¼ ëª¨ë“  ì‹¤í–‰ í”„ë¡œì„¸ìŠ¤ê°€ ìœ í•œ ê°œì˜ ê³„ì‚° ë‹¨ê³„ë¡œ ì œí•œëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.</li>
</ul>

<p>EVMì€ ë©”ëª¨ë¦¬ ë‚´ì˜ ëª¨ë“  ê°’ì„ ìŠ¤íƒì— ì €ì¥í•˜ëŠ” ìŠ¤íƒ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë‹¤.</p>
<ul>
  <li>256bitì˜ ë‹¨ì–´ í¬ê¸°ë¡œ ë™ì‘í•˜ë©°, ì£¼ì†Œ ì§€ì •ì´ ê°€ëŠ¥í•œ ì—¬ëŸ¬ ê°œì˜ ë°ì´í„° êµ¬ì„±ìš”ì†Œë¥¼ ê°€ì§€ê³  ìˆë‹¤.</li>
</ul>

<p><strong>EVMì˜ êµ¬ì„±ìš”ì†Œ</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/evm-architecture.webp" alt="" /></p>
<blockquote>
  <p><a href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Source</a></p>
</blockquote>

<ul>
  <li>(1) ì‹¤í–‰í•  ì»¨íŠ¸ë™íŠ¸ì˜ bytecodeê°€ ì €ì¥ë˜ëŠ” ë¶ˆë³€ í”„ë¡œê·¸ë¨ ì½”ë“œ ROM</li>
  <li>(2) ëª¨ë“  ìœ„ì¹˜ê°€ 0ìœ¼ë¡œ ì´ˆê¸°í™”ëœ íœ˜ë°œì„± ë©”ëª¨ë¦¬</li>
  <li>(3) ì´ë”ë¦¬ì›€ ìƒíƒœì˜ ì¼ë¶€ì¸ ì˜êµ¬ ìŠ¤í† ë¦¬ì§€ (0ìœ¼ë¡œ ì´ˆê¸°í™”ë¨)</li>
</ul>

<p>EVMì€ ì‹¤í–‰ ìˆœì„œê°€ ì™¸ë¶€ì—ì„œ êµ¬ì„±ë˜ê¸° ë•Œë¬¸ì— ìŠ¤ì¼€ì¤„ë§ ê¸°ëŠ¥ì´ ì—†ë‹¤.</p>
<ul>
  <li>ì¦‰, ì´ë”ë¦¬ì›€ í´ë¼ì´ì–¸íŠ¸ê°€ ê²€ì¦ëœ ë¸”ë¡ì˜ íŠ¸ëœì­ì…˜ì„ í†µí•´ ì–´ë–¤ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ê°€ ì–´ë–¤ ìˆœì„œë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ”ì§€ë¥¼ ê²°ì •í•œë‹¤.</li>
  <li>ì´ëŸ¬í•œ ì˜ë¯¸ì—ì„œ ì´ë”ë¦¬ì›€ ì›”ë“œ ì»´í“¨í„°ëŠ” JSì²˜ëŸ¼ ë‹¨ì¼ ìŠ¤ë ˆë“œë‹¤.</li>
</ul>

<p><strong>EVM ì•„í‚¤í…ì²˜ì™€ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/evm-architecture-context.webp" alt="" /></p>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p>EVMì€ ì¼ë°˜ì ì¸ Bytecode ì—°ì‚° ì‘ì—… ì™¸ì—ë„ ê³„ì • ì •ë³´(address, balance ë“±) ë° ë¸”ë¡ ì •ë³´(block number, current gas price ë“±)ì— ì ‘ê·¼í•  ìˆ˜ë„ ìˆë‹¤.</p>

<p>EVMì˜ ì‘ì—…ì€ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì½”ë“œì˜ ì‹¤í–‰ ê²°ê³¼ë¡œ ìœ íš¨í•œ ìƒíƒœ ë³€í™”ë¥¼ ê³„ì‚°í•˜ì—¬ ì´ë”ë¦¬ì›€ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì´ë‹¤.</p>
<ul>
  <li>ì´ëŸ¬í•œ ì¸¡ë©´ì—ì„œ ì´ë”ë¦¬ì›€ì„  <strong>transaction-based state machine</strong>ìœ¼ë¡œ ì„¤ëª…</li>
  <li>ì™¸ë¶€ ì£¼ì²´(ì¦‰, EOA ë° Miner)ê°€ TX ìƒì„±, ìˆ˜ë½ ë° ì£¼ë¬¸ì„ í†µí•´ ìƒíƒœ ë³€í™”ë¥¼ ì‹œì‘</li>
</ul>

<p>ì´ë”ë¦¬ì›€ ìƒíƒœì˜ ê°€ì¥ ìƒìœ„ ë ˆë²¨ì—ëŠ”  <strong>World State</strong>ê°€ ìˆë‹¤.</p>
<ul>
  <li>World StateëŠ” ì´ë”ë¦¬ì›€ ì£¼ì†Œ(160bit)ë¥¼ Accountì— ë§¤í•‘í•œ ê²ƒ</li>
  <li>ê° ì´ë”ë¦¬ì›€ ì£¼ì†ŒëŠ” ETH balance, nonce, account storage, programming codeë¥¼ ì˜ë¯¸</li>
</ul>

<p><strong>ì´ë”ë¦¬ì›€ ì£¼ì†Œì˜ Nonce</strong></p>
<ul>
  <li>EOAì¼ ê²½ìš°: ì„±ê³µì ìœ¼ë¡œ ì „ì†¡í•œ TXì˜ ìˆ˜</li>
  <li>CAì¼ ê²½ìš°: ìƒì„±ëœ ì»¨íŠ¸ë™íŠ¸ì˜ ìˆ˜</li>
</ul>

<p><strong>EOAì—ëŠ” storageê°€ ë¹„ì–´ ìˆê³ , programming codeê°€ ì—†ë‹¤.</strong></p>

<p><img src="/assets/2023-12-05-mastering-ethereum/eoa-ca.webp" alt="" /></p>
<blockquote>
  <p><a href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Source</a></p>
</blockquote>

<p><strong>TXê°€ ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´:</strong></p>
<ul>
  <li>EVMì€ ìƒì„± ì¤‘ì¸ í˜„ì¬ ë¸”ë¡ ë° ì²˜ë¦¬ ì¤‘ì¸ íŠ¹ì • TXì™€ ê´€ë ¨í•˜ì—¬ í•„ìš”í•œ ëª¨ë“  ì •ë³´ë¡œ instanceí™” ëœë‹¤.</li>
  <li>TXê°€ ì»¨íŠ¸ë™íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë‹¤ê°€ ì–´ë–¤ ì‹œì ì—ì„œ ê°€ìŠ¤ ë¶€ì¡±(Out of Gas) ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì‹¤í–‰ì´ ì¦‰ì‹œ ì¤‘ë‹¨ë˜ê³  TXê°€ ì¤‘ë‹¨ëœë‹¤.</li>
  <li>ì´ë”ë¦¬ì›€ ìƒíƒœëŠ” ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©°, ë‹¨ì§€ TX ë°œì‹ ìì˜ nonceê°€ ì¦ê°€ë˜ê³  ì¤‘ë‹¨ì‹œì ê¹Œì§€ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ëœ ê°€ìŠ¤ ë§Œí¼ ETH ì”ì•¡ì´ ì¤„ì–´ë“ ë‹¤.</li>
</ul>

<p><strong>ì •ì§€ ë¬¸ì œ (halting problem)</strong></p>
<ul>
  <li>ì–´ë– í•œ ìŠ¤ì¼€ì¤„ëŸ¬ ì—†ì´ ë‹¨ì¼ ìŠ¤ë ˆë“œ ë¨¸ì‹ ì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ì´ë”ë¦¬ì›€ì—ê²Œ ë§¤ìš° ì¤‘ìš”í•œ ë¬¸ì œë‹¤.</li>
  <li>ê·¸ëŸ¬ë‚˜ ê°€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ê²° ë°©ë²•ì´ ìƒê¸´ë‹¤.</li>
  <li>ë¯¸ë¦¬ ì§€ì •ëœ ìµœëŒ€ ê³„ì‚°ëŸ‰ì„ ìˆ˜í–‰í•œ í›„ì— ì‹¤í–‰ì´ ì¢…ë£Œë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ í”„ë¡œê·¸ë¨ ì‹¤í–‰ì€ EVMì— ì˜í•´ ì¤‘ë‹¨ëœë‹¤.</li>
  <li>ì´ë ‡ê²Œ í•˜ë©´ EVMì´ ìœ ì‚¬(quasi) íŠœë§ ì™„ì „ ë¨¸ì‹ ì´ ëœë‹¤.</li>
  <li>ì¦‰, í”„ë¡œê·¸ë¨ì´ íŠ¹ì • ê³„ì‚°ëŸ‰ ë‚´ì—ì„œ ì¢…ë£Œë˜ëŠ” ê²½ìš°ì—ë§Œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><strong>ê°€ìŠ¤ (Gas)</strong></p>
<ul>
  <li>ì´ëŸ¬ë””ì›€ì—ì„œëŠ” Block Gas Limitê¹Œì§€ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ”ë°, ê³ ì •ë˜ì–´ ìˆì§€ ì•Šê¸° ëŒ€ë¬¸ì— ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ Limitì„ ëŠ˜ë¦¬ëŠ” ê²ƒì— ë™ì˜í•  ìˆ˜ë„ ìˆë‹¤.</li>
  <li>ê°€ìŠ¤ëŠ” ì´ë”ë¦¬ì›€ ë¸”ë¡ì²´ì¸ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° í•„ìš”í•œ ê³„ì‚° ë° ìŠ¤í† ë¦¬ì§€ ìì›ì„ ì¸¡ì •í•˜ëŠ” ì´ë”ë¦¬ì›€ì˜ ë‹¨ìœ„ë‹¤.</li>
  <li>ë¹„íŠ¸ì½”ì¸ì€ KB ë‹¨ìœ„ì˜ TX í¬ê¸°ë§Œ ê³ ë ¤í•˜ì—¬ TX Feeë¥¼ ì¸¡ì •í•˜ì§€ë§Œ, ì´ë”ë¦¬ì›€ì€ TX ë° ì»¨íŠ¸ë™íŠ¸ ì½”ë“œ ì‹¤í–‰ì— ì˜í•´ ìˆ˜í–‰ë˜ëŠ” ëª¨ë“  ê³„ì‚° ë‹¨ê³„ë¥¼ ê³ ë ¤í•œë‹¤.</li>
</ul>

<p><strong>ê°€ìŠ¤ì˜ ì—­í• </strong></p>
<ul>
  <li>(1) ì´ë”ë¦¬ì›€ì˜ ê°€ê²© ë°©ì–´ ìˆ˜ë‹¨ ì—­í• </li>
  <li>(2) ì±„êµ´ìì— ëŒ€í•œ ë³´ìƒ ë²„í¼ ì—­í• </li>
  <li>(3) DoS ê³µê²©ì— ëŒ€í•œ ë°©ì–´ ìˆ˜ë‹¨ ì—­í•  (ë”°ë¼ì„œ ê³µê²©ìê°€ ìŠ¤íŒ¸ TXë¥¼ ë³´ë‚´ì§€ ëª»í•˜ê²Œ í•œë‹¤.)</li>
</ul>

<p><strong>ê°€ìŠ¤ ê³„ì‚°</strong></p>

<pre><code class="language-plain">   ì±„êµ´ ë¹„ìš© = Gas Used * Gas Price
   ì”ì—¬ ê°€ìŠ¤ = Gas Limit * Gas Used
   í™˜ë¶ˆ ETH = ì”ì—¬ ê°€ìŠ¤ * Gas Price
</code></pre>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<ul>
  <li>ìƒˆë¡œìš´ ë¸”ë¡ì„ ë§Œë“¤ ë•Œ ì´ë”ë¦¬ì›€ ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ì±„êµ´ìë“¤ì€ pending TXë“¤ ì¤‘ì—ì„œ ë” ë†’ì€ Gas Priceë¥¼ ì§€ë¶ˆí•˜ë ¤ëŠ” TXë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë”°ë¼ì„œ ë” ë†’ì€ Gas Priceë¥¼ ì œê³µí•˜ë©´ êµ´ìì—ê²Œ TXë¥¼ í¬í•¨í•˜ê³  ë” ë¹¨ë¦¬ í™•ì¸í•˜ë„ë¡ ìœ ë„í•  ê²ƒì´ë‹¤.</li>
</ul>

<p><strong>Negative Gas</strong></p>
<ul>
  <li>ì´ë”ë¦¬ì›€ì€ ì»¨íŠ¸ë™íŠ¸ ì‹¤í–‰ ì¤‘ì— ì‚¬ìš©ëœ Gas ì¤‘ ì¼ë¶€ë¥¼ í™˜ë¶ˆí•¨ìœ¼ë¡œì¨ ì‚¬ìš©ëœ ì €ì¥ ë³€ìˆ˜ ë° ê³„ì •ì„ ì‚­ì œí•˜ë„ë¡ ê¶Œì¥í•œë‹¤.</li>
  <li>í™˜ë¶ˆ ë©”ì»¤ë‹ˆì¦˜ì˜ ì•…ìš©ì„ í”¼í•˜ê¸° ìœ„í•´ ìµœëŒ€ í™˜ë¶ˆì•¡ì€ ì‚¬ìš©ëœ ì´ ê°€ìŠ¤ëŸ‰ì˜ 50%ë¡œ ì„¤ì •ëœë‹¤.</li>
</ul>

<pre><code class="language-plain">   1. ì»¨íŠ¸ë™íŠ¸ë¥¼ ì‚­ì œ(SELFDESTRUCT)í•˜ë©´ 24,000 Gasì˜ í™˜ê¸‰ ê°€ì¹˜ê°€ ìˆë‹¤.
   2. 0ì´ ì•„ë‹Œ ê°’ì—ì„œ 0ìœ¼ë¡œ ì €ì¥ ì£¼ì†Œë¥¼ ë³€ê²½í•˜ë©´ 15,000 Gasì˜ í™˜ê¸‰ ê°€ì¹˜ê°€ ìˆë‹¤.
</code></pre>
<blockquote>
  <p>ì‘ì„±ì: Joshua</p>
</blockquote>

<p><strong>Block Gas Limit</strong></p>
<ul>
  <li>ë¸”ë¡ì˜ ëª¨ë“  TXì—ì„œ ì†Œë¹„ë  ìˆ˜ ìˆëŠ” ê°€ìŠ¤ì˜ ìµœëŒ€ëŸ‰ì´ë©°, í•œ ë¸”ë¡ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” TX ê±´ìˆ˜ë¥¼ ì œí•œí•¨</li>
  <li>ì±„êµ´ìê°€ í˜„ì¬ Block Gas Limitì„ ì´ˆê³¼í•˜ëŠ” ê°€ìŠ¤ê°€ í•„ìš”í•œ TXë¥¼ í¬í•¨í•˜ë ¤ í•œë‹¤ë©´, ê·¸ ë¸”ë¡ì€ ë„¤íŠ¸ì›Œí¬ì— ì˜í•´ ê±°ì ˆë¨</li>
  <li>ëŒ€ë¶€ë¶„ì˜ ì´ë”ë¦¬ì›€ í´ë¼ì´ì–¸íŠ¸ëŠ” â€œtx exceeds block gas limitâ€ì˜ ê²½ê³ ë¥¼ í†µí•´ ê·¸ëŸ¬í•œ TXë¥¼ í•˜ì§€ ëª»í•˜ê²Œ í•  ê²ƒì„</li>
  <li>Block Gas Limitì€ ë„¤íŠ¸ì›Œí¬ì˜ ì±„êµ´ìë“¤ì´ ì§‘í•©ì ìœ¼ë¡œ ê²°ì •í•¨</li>
  <li>ì´ë”ë¦¬ì›€ í”„ë¡œí† ì½œì—ëŠ” ì±„êµ´ìê°€ Gas Limitì— íˆ¬í‘œí•  ìˆ˜ ìˆëŠ” ë©”ì»¤ë‹ˆì¦˜ì´ ë‚´ì¥ë˜ì–´ ìˆì–´ ì´í›„ ë¸”ë¡ì—ì„œ ìš©ëŸ‰ì„ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì¼ ìˆ˜ ìˆìŒ</li>
  <li>ê° ì±„êµ´ìë“¤ì€ +/- ì–´ëŠ ë°©í–¥ìœ¼ë¡œë“  1/1,024 (0.0976%)ì˜ ë¹„ìœ¨ë¡œ Block Gas Limitì„ ì¡°ì •í•˜ê¸° ìœ„í•´ íˆ¬í‘œí•  ìˆ˜ ìˆìŒ</li>
</ul>

<p><img src="/assets/2023-12-05-mastering-ethereum/etherscan-average-gas-limit.webp" alt="" /></p>
<blockquote>
  <p><a href="https://etherscan.io/chart/gaslimit">Source</a></p>
</blockquote>

<h1 id="15-chapter-14-consensus">15. [Chapter 14] Consensus</h1>

<p><strong>í•©ì˜ (Consensus)</strong></p>
<ul>
  <li>ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ê°ê¸° ë‹¤ë¥¸ ì°¸ì—¬ìê°€ í•œ ì‹œìŠ¤í…œì˜ ì „ ì²´ ìƒíƒœì— ëª¨ë‘ ë™ì˜í•˜ì—¬ ë™ê¸°í™”í•˜ê¸° ìœ„í•œ ê²ƒ</li>
  <li>ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì¤‘ì¬ì¸ì´ ì—†ìœ¼ë©´ ë‹¤ë¥¸ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ ë¶ˆì¼ì¹˜, ê¸°ë§Œ ë˜ëŠ” ì°¨ì´ì ì„ í•´ê²°í•´ì•¼ í•˜ëŠ”ë°, í•©ì˜ ì•Œê³ ë¦¬ì¦˜ì€ ë³´ì•ˆ ë° íƒˆì¤‘ì•™í™”ë¥¼ í•´ê²°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ê²ƒ</li>
</ul>

<p><strong>ë¹„íŠ¸ì½”ì¸ì˜ PoW í•©ì˜ ì•Œê³ ë¦¬ì¦˜</strong></p>
<ul>
  <li>ê°€ëŠ¥í•œ í•œ ë§ì€ ì°¸ê°€ìë¡œë¶€í„° íƒˆì¤‘ì•™í™”ëœ ì‹œìŠ¤í…œì— ëŒ€í•œ í†µì œê¶Œì„ ìœ ì§€í•˜ë©° ë¸”ë¡ì²´ì¸ì„ ë³´í˜¸í•˜ëŠ” ëª©ì ì„ ì§€ë‹ˆê³  ìˆë‹¤.</li>
</ul>

<p><strong>ì´ë”ë¦¬ì›€ì˜ PoW ì•Œê³ ë¦¬ì¦˜</strong></p>
<ul>
  <li>Ethashë¼ê³  ë¶€ë¥´ëŠ”ë°, ë¹„íŠ¸ì½”ì¸ì˜ PoW ì•Œê³ ë¦¬ì¦˜ê³¼ëŠ” ì•½ê°„ ë‹¤ë¥´ë‹¤.</li>
  <li>ë°©í–¥ì„± ë¹„ìˆœí™˜ ê·¸ë˜í”„(Directed Acyclic Graph, DAG)ë¡œ ì•Œë ¤ì§„ ëŒ€ê·œëª¨ ë°ì´í„° ì„¸íŠ¸ì˜ ìƒì„± ë° ë¶„ì„ì— ì˜ì¡´í•¨</li>
  <li>ì´ë”ë¦¬ì›€ PoWì—ëŠ”  <strong>ë‚œì´ë„ í­íƒ„(Difficulty Bomb)</strong>ì´ë¼ëŠ” í•¸ë””ìº¡ì´ ìˆìœ¼ë©°, ì´ëŠ” ì´ë”ë¦¬ì›€ ì±„êµ´ì„ ì ì°¨ ì–´ë µê²Œ ë§Œë“¤ì–´ì„œ PoWì—ì„œ PoSë¡œì˜ ì „í™˜ì„ ê°•ìš”í•˜ê³  ìˆë‹¤.</li>
  <li>ì´ë”ë¦¬ì›€ì˜ ê³„íšëœ PoS ì•Œê³ ë¦¬ì¦˜ì€  <strong>Casper</strong>ë¼ê³  ë¶ˆë¦¬ë©°, Casperë¥¼ ë„ì…í•˜ë ¤ëŠ” ì‹œë„ëŠ” ì—¬ëŸ¬ ë²ˆ ì—°ê¸°ë˜ì–´, ë‚œì´ë„í­íƒ„ì„ ì™„í™”í•˜ê³  ê°•ì œë¡œ ì—°ê¸°ì‹œí‚¤ëŠ” ê°œì…ì´ í•„ìš”í–ˆë‹¤.</li>
</ul>

<p><strong>ë°©í–¥ì„± ë¹„ìˆœí™˜ ê·¸ë˜í”„ (Directed Acyclic Graph, DAG)</strong></p>
<ul>
  <li>DAGì˜ ëª©ì : ìì£¼ ì ‘ê·¼í•˜ëŠ” ëŒ€ê·œëª¨ ë°ì´í„° êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ëŠ” ë° í•„ìš”í•œ Ethash PoW ì•Œê³ ë¦¬ì¦˜ì„ ë§Œë“œëŠ” ê²ƒ</li>
  <li>ì´ëŠ” Ethashê°€ ASIC ì €í•­ì„±ì„ ê°–ê²Œ ë§Œë“¤ë ¤ëŠ” ê²ƒìœ¼ë¡œ, ê³ ì† GPUë³´ë‹¤ í›¨ì”¬ ë¹ ë¥¸ ì£¼ë¬¸í˜• ë°˜ë„ì²´(ASIC) ì±„êµ´ ì¥ë¹„ë¥¼ ë§Œë“¤ê¸°ê°€ ë” ì–´ë ¤ì›Œì§„ë‹¤ëŠ” ì˜ë¯¸</li>
  <li>ì¦‰, ì œì¡° ê³µì¥ ë° ëŒ€ê·œëª¨ ì˜ˆì‚°ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒë“¤ì´ ì±„êµ´ ì¸í”„ë¼ë¥¼ ì§€ë°°í•˜ê³  í•©ì˜ ì•Œê³ ë¦¬ì¦˜ì˜ ë³´ì•ˆì„ í›¼ì†í•  ìˆ˜ ìˆëŠ” PoW ì±„êµ´ì˜ ì¤‘ì•™ ì§‘ì¤‘í™”ë¥¼ í”¼í•˜ê³ ì í•œ ê²ƒ</li>
</ul>

<p><strong>PoS ì•Œê³ ë¦¬ì¦˜</strong></p>

<ol>
  <li>ë¸”ë¡ì²´ì¸ì€ Validator ì§‘í•©ì„ ìœ ì§€í•˜ë©°, ë¸”ë¡ì²´ì¸ì˜ ê¸°ë³¸ ì•”í˜¸í™”í(ETH)ë¥¼ ë³´ìœ í•œ ì‚¬ëŒì€ ETHë¥¼ ì»¨íŠ¸ë™íŠ¸ì— ì˜ˆì¹˜ì‹œí‚¤ëŠ” íŠ¹ë³„í•œ ìœ í˜•ì˜ TXë¥¼ ë³´ëƒ„ìœ¼ë¡œì¨ Validatorê°€ ë  ìˆ˜ ìˆë‹¤.</li>
  <li>ValidatorëŠ” ìœ íš¨í•œ ë‹¤ìŒ ë¸”ë¡ì— ëŒ€í•´ ì œì•ˆí•˜ê³   íˆ¬í‘œí•˜ëŠ” ìˆœì„œë¥¼ ë”°ë¥´ë©°, ê° Validatorì˜ íˆ¬í‘œ ì¤‘ìš”ë„ëŠ” ë³´ì¦ê¸ˆ(ì§€ë¶„)ì˜ í¬ê²Œ ë”°ë¼ ë‹¤ë¥´ë‹¤.</li>
  <li>íŠ¹ì • Validatorê°€ ë³´ìœ í•œ ë¸”ë¡ì´ ëŒ€ë‹¤ìˆ˜ì˜ Validatorì— ì˜í•´ ê±°ë¶€ëœë‹¤ë©´ ë³´ì¦ê¸ˆì„ ìƒì„ ìœ„í—˜ì´ ìˆë‹¤.</li>
  <li>ë°˜ëŒ€ë¡œ, ëŒ€ë‹¤ìˆ˜ì˜ Validatorê°€ ìˆ˜ë½í•œ ëª¨ë“  ë¸”ë¡ì— ëŒ€í•´ ëˆ„ì ëœ ë³´ì¦ê¸ˆì— ë¹„ë¡€í•˜ì—¬ ì‘ì€ ë³´ìƒì„ ì–»ëŠ”ë‹¤.</li>
  <li>ë”°ë¼ì„œ PoSëŠ” Validatorì—ê²Œ ë³´ìƒ ë° ì²˜ë²Œ ì œë„ì— ë”°ë¼ ì •ì§í•˜ê²Œ í–‰ë™í•˜ê³  í•©ì˜ ê·œì¹™ì„ ë”°ë¥´ë„ë¡ í•œë‹¤.</li>
  <li>PoWì—ì„œëŠ” ì²˜ë²Œì´ ì™¸ì (ì „ê¸° ì‚¬ìš©ì— ë”°ë¥¸ ìê¸ˆ ì†ì‹¤)ì´ë¼ë©´, PoSì—ì„œ ì²˜ë²Œì€ ì²˜ë²Œì´ ë‚´ì¬ì (ì§€ë¶„ ì†ì‹¤)ì¸ ê²ƒì´ë‹¤.</li>
</ol>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="korean" /><category term="blockchain" /><summary type="html"><![CDATA[ê°œë°œì ì¸ ìš©ì–´ê°€ ë‚œë¬´í•´ì„œ ë‹¹ì‹œì—ëŠ” ë„ì €íˆ í¼ì³ ë³¼ ì—„ë‘ê°€ ì•ˆ ë‚¬ì§€ë§Œ, ì´ ì—…ê³„ì—ì„œ ì•½ 3ë…„ ê°€ê¹Œì´ êµ¬ë¥´ë‹¤ë³´ë‹ˆ ì–´ëŠ ì •ë„ ì˜ ì½íˆê²Œ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ 2023ë…„ 1ì›” 1ì¼ ìƒˆí•´ ëª©í‘œ ì¤‘ í•˜ë‚˜ë¡œ â€œë§ˆìŠ¤í„°ë§ ì´ë”ë¦¬ì›€ ì™„ë…í•˜ê³  ì •ë¦¬í•˜ê¸°â€ë¥¼ ì„¸ìš°ê²Œ ë˜ì—ˆë‹¤. ê·¸ë¦¬ê³  ì•½ 1ê°œì›” ë§Œì— ë‹¤ ì½ê²Œ ë˜ì—ˆë‹¤.]]></summary></entry><entry><title type="html">ë°ì´í„° ë¶„ì„ê°€ì˜ SQL ìµœì í™” ì¼ê¸°: SELF JOINì„ í”¼í•˜ëŠ” ë°©ë²•</title><link href="http://localhost:4000/how-to-avoid-self-joins/" rel="alternate" type="text/html" title="ë°ì´í„° ë¶„ì„ê°€ì˜ SQL ìµœì í™” ì¼ê¸°: SELF JOINì„ í”¼í•˜ëŠ” ë°©ë²•" /><published>2023-11-30T00:00:00+09:00</published><updated>2023-11-30T00:00:00+09:00</updated><id>http://localhost:4000/how-to-avoid-self-joins</id><content type="html" xml:base="http://localhost:4000/how-to-avoid-self-joins/"><![CDATA[<blockquote>
  <p>ëŒ€ê³ ê° ì„œë¹™ì„ ìœ„í•´ ì—„ì²­ë‚˜ê²Œ í° ì‚¬ì´ì¦ˆì˜ ì†ŒìŠ¤ í…Œì´ë¸”ë¡œë¶€í„° ìµœì í™”ëœ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ ê³ ë¯¼ì„ ë§ì´ í•˜ê³  ìˆëŠ” ë§Œí¼, ì´ë²ˆì—ëŠ” SELF JOIN ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ SQL ì„±ëŠ¥ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>

<h3 id="contents">CONTENTS</h3>
<ol>
  <li>ë“¤ì–´ê°€ëŠ” ê¸€</li>
  <li>Pythonê³¼ ë‹¬ë¦¬ ê±°ì¹ ê²Œ ì‚¬ê³ í•´ì•¼ í•˜ëŠ” SQL</li>
  <li>SELF JOINì„ í•˜ë©´ ì—°ì‚°ëŸ‰ì´ ì œê³±ìœ¼ë¡œ ëŠ˜ì–´ë‚œë‹¤.</li>
  <li>Subqueryì™€ EXISTS ì‚¬ìš©í•˜ê¸°</li>
  <li>ê²°ë¡ : ë¬´ì¡°ê±´ì  ìš°ì›”ì„±ì€ ì—†ë‹¤.</li>
</ol>

<hr />

<h3 id="disclaimer">DISCLAIMER</h3>

<p>ë³¸ ìë£ŒëŠ” ì‘ì„±ì ë³¸ì¸ì˜ ê²¬í•´ì¼ ë¿ì´ë©°, ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì˜ í™˜ê²½ì— ë”°ë¼ ì í•©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ ì¶œì²˜ë¥¼ ì œì™¸í•œ ëª¨ë“  ì¿¼ë¦¬ë¬¸ê³¼ ë‚´ìš©ì€ ë³¸ì¸ì˜ ê²½í—˜ì— ì˜í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì‘ì„±ëœ ì¿¼ë¦¬ë¬¸ì€ ìƒ˜í”Œë¡œ ì‘ì„±í•œ ê²ƒì´ë©°, ë³¸ì¸ì˜ ê³¼ê±° ë° í˜„ì¬ ì¬ì§ íšŒì‚¬ì˜ ì—…ë¬´ í˜„í™©ê³¼ ë¬´ê´€í•©ë‹ˆë‹¤.</p>

<h1 id="1-ë“¤ì–´ê°€ëŠ”-ê¸€">1. ë“¤ì–´ê°€ëŠ” ê¸€</h1>

<p><img src="/assets/2023-11-30-how-to-avoid-self-joins/join-meme.webp" alt="" /></p>
<blockquote>
  <p><a href="https://miro.medium.com/v2/resize:fit:800/1*DTET9ngrx2Gzu6ZJk0G9BQ.jpeg">Source</a></p>
</blockquote>

<p>ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” ì¹œêµ¬ë“¤ ì–¼êµ´ì„ ë³´ë©´ ìœ„ì™€ ê°™ì€ ì´ìƒí•œ ìƒê°ì„ í•˜ëŠ” ë°ì´í„° ë¶„ì„ê°€ Joshuaë¼ê³  í•©ë‹ˆë‹¤.</p>

<p>ì €ëŠ” ì¼ë°˜ì ì¸ B2C ê¸°ì—…ì—ì„œ ë°ì´í„° ë¶„ì„ê°€ë¡œ ê·¼ë¬´í•˜ë©°, GA4, Amplitude, BigQuery, Redash ë“±ì„ í™œìš©í•˜ì—¬ A/B í…ŒìŠ¤íŠ¸, ì§€í‘œ ëª¨ë‹ˆí„°ë§ ë“±ì„ ìˆ˜í–‰í•˜ë©° íšŒì‚¬ì˜ ë“±ëŒ€ ì—­í• ì„ í•˜ë©° ì§€ëƒˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ë¶„ë“¤ê³¼ ë¹„ìŠ·í•œ ì—­í• ì„ ìˆ˜í–‰í–ˆë˜ ê²ƒì´ì£ .</p>

<p>ë˜í•œ GA4, Amplitude ë“±ê³¼ ê°™ì€ B2B ë°ì´í„° ë¶„ì„ í”Œë«í¼ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“œëŠ” ê²½í—˜ë„ ì‚´ì§ í–ˆëŠ”ë°ìš”. ê·¸ëŸ¬ë‹¤ë³´ë‹ˆ ì €ì˜ R&amp;Rì€ ì„œë¹„ìŠ¤ ìì²´ì˜ ë°ì´í„° ë¶„ì„ ì—…ë¬´ ì™¸ì—ë„, ê³ ê°ë“¤ì—ê²Œ ë°ì´í„°ë¥¼ ì„œë¹™í•˜ê¸° ìœ„í•œ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ì™€ ìµœì í™” ì—…ë¬´ì— ì§‘ì¤‘ë˜ê¸°ë„ í–ˆìŠµë‹ˆë‹¤. ì œ íƒ€ì´í‹€ì„ ë©‹ìˆê²Œ ê°€ê³µí•˜ë©´ ìµœê·¼ì— ë– ì˜¤ë¥´ëŠ” í¬ì§€ì…˜ì¸ Analytics Engineer, ë°˜ìª½ ì§œë¦¬ ë°ì´í„° ì—”ì§€ë‹ˆì–´, ì•„ë‹ˆë©´ ëŒ€ì¶© ì¿¼ë¦¬ ë¨¸ì‹  í˜¹ì€ ë¶„ì§€ë‹ˆì–´(?)ì¸ ê²ƒ ê°™ê¸°ë„ í•©ë‹ˆë‹¤. ğŸ˜…</p>

<p>ëŒ€ê³ ê° ì„œë¹™ì„ ìœ„í•´ ì—„ì²­ë‚˜ê²Œ í° ì‚¬ì´ì¦ˆì˜ ì†ŒìŠ¤ í…Œì´ë¸”ë¡œë¶€í„° ìµœì í™”ëœ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ ê³ ë¯¼ì„ ë§ì´ í•˜ê³  ìˆëŠ” ë§Œí¼, ì´ë²ˆì—ëŠ” SELF JOIN ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ SQL ì„±ëŠ¥ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
(SQL ì „ë¬¸ê°€ ë¶„ë“¤ì´ ë§ì´ ê³„ì‹œëŠ” ë§Œí¼, ì œ ê¸€ì„ ë¹„íŒì ìœ¼ë¡œ ê³ ì°°í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„)</p>

<p>ì¿¼ë¦¬ë¡œ ê³ í†µ ë°›ìœ¼ë©° ëˆˆë™ìì— ë¹„ê°€ ë‚´ë ¸ë˜ ê²½í—˜ ì´ì•¼ê¸°, ì‹œì‘í•©ë‹ˆë‹¤! (ìš¸ì§€ë§ˆ~ ìš¸ì§€ë§ˆ~ ìš¸ì§€ë§ˆ~)</p>

<p><img src="/assets/2023-11-30-how-to-avoid-self-joins/crying-cat-meme.avif" alt="" /></p>
<blockquote>
  <p><a href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.dailydot.com%2Fnews%2Fcat-crying-memes-explainer%2F&amp;psig=AOvVaw1JpDJ5k_6Tx93h2YT8in_Y&amp;ust=1702536707113000&amp;source=images&amp;cd=vfe&amp;opi=89978449&amp;ved=0CBMQjRxqFwoTCMC01dLpi4MDFQAAAAAdAAAAABAD">Source</a></p>
</blockquote>

<h1 id="2-pythonê³¼-ë‹¬ë¦¬-ê±°ì¹ ê²Œ-ì‚¬ê³ í•´ì•¼-í•˜ëŠ”-sql">2. Pythonê³¼ ë‹¬ë¦¬ ê±°ì¹ ê²Œ ì‚¬ê³ í•´ì•¼ í•˜ëŠ” SQL</h1>

<p>SQLì„ í†µí•´ OLAP(Online Analytical Processing)ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ë¥¼ êµ¬ì¶•í•˜ë‹¤ë³´ë©´, ì¢…ì¢…  <strong>SELF JOIN</strong>ì´ í•„ìš”í•©ë‹ˆë‹¤. ê°€ë ¹, ì†ŒìŠ¤ í…Œì´ë¸”ì˜ ë³µì‚¬ë³¸ì¸ Staging Tableì„ Pivoting í•´ì•¼ í•˜ê±°ë‚˜, ì¹¼ëŸ¼ Aì™€ ì¹¼ëŸ¼ B ê°„ì˜ ê´€ê³„ ê·œì¹™ì„ ì°¾ì•„ Data Cleaningì„ í•´ì•¼ í•˜ëŠ” ê²½ìš°ì— íŠ¹íˆ ë°œìƒí•˜ëŠ” ê²ƒ ê°™ì•˜ì–´ìš”.</p>

<p>ê°€ë ¹, Pythonì˜ Pandas Dataframe í™˜ê²½ì—ì„œëŠ” ë©”ì†Œë“œë¥¼ í†µí•´ ë„ˆë¬´ë‚˜ë„ ì‰½ê²Œ Pivotingì„ í•˜ê±°ë‚˜, ë°˜ë³µë¬¸ê³¼ ì¡°ê±´ë¬¸ì„ í†µí•´ ì¹¼ëŸ¼ ì‚¬ì´ì˜ ê´€ê³„ ê·œì¹™ì„ ê³ ì‘ ëª‡ ì¤„ ì½”ë“œ ë§Œìœ¼ë¡œ Data Cleaningì„ í•  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pandas</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">pivot</span>
<span class="n">pandas</span><span class="p">.</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">value</span> <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="n">true</span> <span class="k">if</span> <span class="n">x</span> <span class="n">condition</span> <span class="k">else</span> <span class="n">value</span> <span class="n">of</span> <span class="n">condition</span> <span class="ow">is</span> <span class="n">false</span><span class="p">)</span>
</code></pre></div></div>

<p>í•˜ì§€ë§Œ ì•ˆíƒ€ê¹ê²Œë„ SQLì—ì„œëŠ” ë‹¤ì†Œ ê±°ì¹œ ë°©ë²•ìœ¼ë¡œ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ì•¼ í•˜ë¯€ë¡œ ì¢€ ë” í…Œì´ë¸” ìì²´ë¥¼ ê¸°ë°˜ì˜ Logical Thinkingì„ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>

<p>ê°€ë ¹ ë‹¤ìŒ ê¸°ë³¸ì ì¸ ì‚¬ë¡€ì™€ ê°™ì´, êµ­ê°€ ë³„ë¡œ MAUë¥¼ ì§‘ê³„í•  ê²½ìš°ì— SQLì€ í›¨ì”¬ ê±°ì¹ ê²Œ í‘œí˜„í•©ë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
   <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="s1">'MONTH'</span><span class="p">,</span> <span class="nb">datetime</span><span class="p">)</span> <span class="k">AS</span> <span class="n">yyyymm</span><span class="p">,</span>  
   <span class="n">country</span><span class="p">,</span>  
   <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">mau</span>  
<span class="k">FROM</span>  
   <span class="n">source_events</span>  
<span class="k">GROUP</span> <span class="k">BY</span>  
   <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>  
<span class="k">ORDER</span> <span class="k">BY</span>  
   <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>  
<span class="p">;</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">source_events</span><span class="p">[</span><span class="sh">'</span><span class="s">yyyymm</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">source_events</span><span class="p">[</span><span class="sh">'</span><span class="s">datetime</span><span class="sh">'</span><span class="p">]).</span><span class="n">dt</span><span class="p">.</span><span class="nf">to_period</span><span class="p">(</span><span class="sh">'</span><span class="s">M</span><span class="sh">'</span><span class="p">)</span>  
<span class="n">result_df</span> <span class="o">=</span> <span class="n">source_events</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="sh">'</span><span class="s">yyyymm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">]).</span><span class="nf">agg</span><span class="p">(</span><span class="n">mau</span><span class="o">=</span><span class="p">(</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nunique</span><span class="sh">'</span><span class="p">)).</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  
<span class="n">result_df</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">yyyymm</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">]).</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  
<span class="nf">print</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</code></pre></div></div>

<p>ì¦‰, íŒŒì´ì¬ì˜  <code class="language-plaintext highlighter-rouge">to_period</code>,  <code class="language-plaintext highlighter-rouge">groupby</code>,  <code class="language-plaintext highlighter-rouge">nunique</code>  ë“±ê³¼ ê°™ì€ ë‚´ì¥ ë©”ì†Œë“œì˜ ì—°ì‚° ì›ë¦¬ë¥¼ ì´í•´í•˜ì—¬ ì´ë¥¼  <code class="language-plaintext highlighter-rouge">DATE_TRUNC</code>,  <code class="language-plaintext highlighter-rouge">COUNT(DISTINCT â€¦)</code>,  <code class="language-plaintext highlighter-rouge">GROUP BY</code>  ë“±ì˜ SQL í•¨ìˆ˜ì™€ Statementë¡œ í‘œí˜„í•´ì•¼ í•˜ëŠ” ê²ƒì´ì£ .</p>

<h1 id="3-self-joinì„-í•˜ë©´-ì—°ì‚°ëŸ‰ì´-ì œê³±ìœ¼ë¡œ-ëŠ˜ì–´ë‚œë‹¤">3. SELF JOINì„ í•˜ë©´ ì—°ì‚°ëŸ‰ì´ ì œê³±ìœ¼ë¡œ ëŠ˜ì–´ë‚œë‹¤.</h1>

<p>ë¨¼ì € ë‹¤ìŒê³¼ ê°™ì€ ì¿¼ë¦¬ë¬¸ ì‚¬ë¡€ë¥¼ ì‚´í´ë³´ë„ë¡ í•˜ì£ .</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="nb">datetime</span><span class="p">,</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">session_id</span><span class="p">,</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">event_index</span><span class="p">,</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span><span class="p">,</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_key</span><span class="p">,</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_value</span>  
<span class="k">FROM</span>  
   <span class="n">source_events</span> <span class="n">MAIN</span>  
<span class="k">LEFT</span> <span class="k">JOIN</span>  
   <span class="n">source_events</span> <span class="n">SUB</span>  
   <span class="k">ON</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">user_id</span>  
      <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">session_id</span>  
      <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_index</span>  
<span class="k">WHERE</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">0</span>  
   <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">1</span>  
   <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">2</span>  
   <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">3</span>
</code></pre></div></div>

<p>ìœ„ ì‚¬ë¡€ëŠ” ê°€ë ¹ ì´ëŸ° ìƒí™©ìœ¼ë¡œ ì´í•´í•˜ì‹œë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì‚¬ìš©ìì˜ ì´ë²¤íŠ¸ ë¡œê·¸ ì†ŒìŠ¤ í…Œì´ë¸”ì—ì„œ ê° ì´ë²¤íŠ¸ì˜ íŒŒë¼ë¯¸í„° key-valueê°€ unnestedëœ ìƒíƒœë¡œ ì¡´ì¬í•˜ê±°ë‚˜, í˜¹ì€ íŠ¹ì • íŒŒë¼ë¯¸í„°ì˜ indexë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¸ì ‘í•œ íŒŒë¼ë¯¸í„° ì •ë³´ë“¤ë§Œ ì¶”ì¶œí•´ì•¼ í•˜ëŠ” ìƒí™©ì—ì„œ ìœ„ì™€ ê°™ì€ ì¿¼ë¦¬ë¬¸ ì‘ì„±ì´ í•„ìš”í•  ê²ƒì…ë‹ˆë‹¤.</p>

<p>SQLì˜ ì—°ì‚° ê³¼ì •ì€  <strong>FROM â†’ XXX JOIN â†’ WHERE â†’ GROUP BY â†’ SELECT â†’ HAVING â†’ ORDER BY</strong>  ë“±ì˜ ìˆœìœ¼ë¡œ ì§„í–‰ë˜ëŠ”ë°ìš”. ìœ„ ì¿¼ë¦¬ë¬¸ì„ ì—°ì‚°í•˜ëŠ” ê³¼ì •ì—ì„œ WHERE Statementì— ì§„ì…í•˜ê¸° ì „ì—, ë¨¼ì € FROMê³¼ LEFT JOINì„ í†µí•´ ëª¨ë“  Rowë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<p><img src="/assets/2023-11-30-how-to-avoid-self-joins/sql-processing.webp" alt="" /></p>
<blockquote>
  <p><a href="https://blog.kakaocdn.net/dn/ckOt66/btrjP1TVZsq/Ta9JdTTiEd9tddkKkFk2n1/img.png">Source</a></p>
</blockquote>

<p>ê°€ë ¹,  <code class="language-plaintext highlighter-rouge">source_events</code>  í…Œì´ë¸”ì´ 1,000,000ê°œì˜ Rowë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤ë©´, ìµœëŒ€ 1,000,000 * 1,000,000ê°œì˜ Rowê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ì˜¤ê²Œ ë˜ëŠ” ê²ƒì´ì£ . ì´ëŠ” ì¿¼ë¦¬ ì—”ì§„ì˜ ë©”ëª¨ë¦¬ ë° íŠ¸ë˜í”½ DevOps í™˜ê²½ì´ ì¤‘ìš”í•œ ê²½ìš° ë¶„ëª…íˆ ë¬¸ì œê°€ ë©ë‹ˆë‹¤. í˜¹ì€ Usage Limitì´ ê±¸ë ¤ ìˆì„ ê²½ìš°ì—ëŠ” ì¿¼ë¦¬ ì‹¤í–‰ì´ ëª‡ ì‹œê°„ ë™ì•ˆ ì§„í–‰ë˜ë‹¤ê°€ ì•„ì¹¨ì— ëˆˆì„ ë– ë³´ë©´ íŠ¸ë˜í”½ ì œí•œìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ì´ ì‹¤íŒ¨ë˜ì—ˆë‹¤ëŠ” ë§¤ìš° ìŠ¬í”„ê³  ì°¸ë‹´í•œ ìƒí™©ì— ë§ˆì£¼í•˜ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.</p>

<p><img src="/assets/2023-11-30-how-to-avoid-self-joins/crying-meme.webp" alt="" /></p>
<blockquote>
  <p><a href="https://res.heraldm.com/content/image/2021/07/16/20210716000671_0.jpg">Source</a></p>
</blockquote>

<p>ê·¸ë ‡ë‹¤ë©´, ì´ëŸ° ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ì¿¼ë¦¬ë¥¼ ìµœì í™”í•  ìˆ˜ ìˆì„ê¹Œìš”?</p>

<h1 id="4-subqueryì™€-exists-ì‚¬ìš©í•˜ê¸°">4. Subqueryì™€ EXISTS ì‚¬ìš©í•˜ê¸°</h1>

<p>ìœ„ì—ì„œ ë³´ì…¨ë˜ ì¿¼ë¦¬ë¬¸ì„ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•´ë´¤ìŠµë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
   <span class="nb">datetime</span><span class="p">,</span>  
   <span class="n">user_id</span><span class="p">,</span>  
   <span class="n">session_id</span><span class="p">,</span>  
   <span class="n">event_index</span><span class="p">,</span>  
   <span class="n">event_param_index</span><span class="p">,</span>  
   <span class="n">event_param_key</span><span class="p">,</span>  
   <span class="n">event_param_value</span>  
<span class="k">FROM</span>  
   <span class="n">source_events</span> <span class="n">MAIN</span>  
<span class="k">WHERE</span>  
   <span class="k">EXISTS</span> <span class="p">(</span>  
      <span class="k">SELECT</span> <span class="mi">1</span>  
      <span class="k">FROM</span> <span class="n">source_events</span> <span class="n">SUB</span>  
      <span class="k">WHERE</span>  
         <span class="n">event_type</span> <span class="o">=</span> <span class="s1">'click_button'</span>  
         <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">user_id</span>  
         <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">session_id</span>  
         <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_index</span>  
         <span class="k">AND</span> <span class="p">(</span>  
            <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">0</span>  
            <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">1</span>  
            <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">2</span>  
            <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">3</span>  
         <span class="p">)</span>  
   <span class="p">)</span>
</code></pre></div></div>

<p>ì, ì–´ë–»ê²Œ ë‹¬ë¼ì¡ŒëŠ”ì§€ ì°¨ê·¼ì°¨ê·¼ ì‚´í´ë³´ë„ë¡ í•˜ì£ .</p>

<h3 id="1-ë¨¼ì €-left-joinì´-ì‚¬ë¼ì§€ê³ -where-statementì˜-subqueryê°€-ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤">1. ë¨¼ì €, LEFT JOINì´ ì‚¬ë¼ì§€ê³ , WHERE Statementì˜ Subqueryê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.</h3>

<p>JOINë³´ë‹¤ Subqueryê°€ ë°˜ë“œì‹œ ëª¨ë“  ìƒí™©ì—ì„œ ì„±ëŠ¥ì´ ìš°ì›”í•˜ì§€ëŠ” ì•Šì§€ë§Œ, ì´ ìƒí™©ì—ì„œëŠ” ë©”ëª¨ë¦¬ ë°ì´í„°ì˜ ì‚¬ì´ì¦ˆëŠ” ìƒë‹¹ ë¶€ë¶„ í•´ì†Œë˜ì—ˆìŠµë‹ˆë‹¤. ì•ì„œ ë§ì”€ ë“œë¦° ê²ƒì²˜ëŸ¼, SQLì€ WHERE Statementë¥¼ ê³ ë ¤í•˜ê¸° ì „ì— ë¨¼ì € FROMê³¼ LEFT JOINì„ ë¨¼ì € ì‹¤í–‰í•˜ê²Œ ë˜ëŠ”ë°, WHERE Statementì˜ Subqueryë¡œ ì˜®ê¹€ìœ¼ë¡œì¨ LEFT JOINì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ëŠ” ì‘ì—…ì„ WHEREì—ì„œ ë™ì‹œì— ì—°ì‚°í•˜ì—¬ ë©”ëª¨ë¦¬ì— ì˜¬ë¦´ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ê°€ë ¹,  <code class="language-plaintext highlighter-rouge">source_events</code>  í…Œì´ë¸”ì˜ Row ìˆ˜ê°€ 1,000,000ê°œ ì´ê³ , WHEREë¥¼ í†µí•´ Filter outëœ Row ìˆ˜ê°€ 10,000ê°œë¼ë©´, ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°€ê²Œ ë˜ëŠ” Row ìˆ˜ëŠ” ì´ì „ì˜ ìµœëŒ€ 1,000,000 * 1,000,000ê°œì—ì„œ 1,000,000 * 10,000ê°œë¡œ 1% ìˆ˜ì¤€ìœ¼ë¡œ ê¸‰ê°í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<h3 id="2-inë³´ë‹¤-existsê°€-ì—°ì‚°-ì†ë„ê°€-ë”-ë¹ ë¦…ë‹ˆë‹¤">2. INë³´ë‹¤ EXISTSê°€ ì—°ì‚° ì†ë„ê°€ ë” ë¹ ë¦…ë‹ˆë‹¤.</h3>

<p>INê³¼ EXISTS ëª¨ë‘ â€œ<strong>XXXí•œ ê²½ìš°ê°€ ì¡´ì¬í•˜ë‹ˆ?</strong>â€ë¥¼ ì§ˆë¬¸í•˜ëŠ” ê³¼ì •ìœ¼ë¡œ ì¶”ìƒí™”í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì€ë°ìš”.</p>

<p>ë§Œì•½ INì„ í†µí•´ Filter outí•˜ë ¤ê³  í•˜ë©´ ê°€ë ¹ ì•„ë˜ì™€ ê°™ì€ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WHERE</span>  
   <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">0</span> <span class="k">FROM</span> <span class="p">...)</span>  
   <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="p">...)</span>  
   <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">2</span> <span class="k">FROM</span> <span class="p">...)</span>  
   <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">FROM</span> <span class="p">...)</span>  
<span class="p">...</span>
</code></pre></div></div>

<p>ìœ„ ê³¼ì •ì€ í•œ ê°€ì§€ ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.  <code class="language-plaintext highlighter-rouge">SUB.event_param_index</code>  ì¹¼ëŸ¼ì˜ ê°’ë“¤ì„ ì¼ì¼ì´ ì¶œë ¥í•´ì•¼ í•˜ëŠ”ë°ìš”. ì¦‰, ë‹¤ì–‘í•œ ê°’ë“¤ë¡œ êµ¬ì„±ëœ ì¹¼ëŸ¼ì„ ë©”ëª¨ë¦¬ì— ë¡œë“œí•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ì£ .</p>

<p>ê·¸ëŸ¬ë‚˜ EXISTSë¥¼ í†µí•´ Filter outí•˜ë ¤ê³  í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì¿¼ë¦¬ë¬¸ìœ¼ë¡œ ìˆ˜ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WHERE</span>  
   <span class="k">EXISTS</span> <span class="p">(</span>  
      <span class="k">SELECT</span> <span class="mi">1</span>  
      <span class="k">FROM</span> <span class="p">...</span>  
      <span class="k">WHERE</span>  
         <span class="p">...</span>  
         <span class="k">AND</span> <span class="p">(</span>  
         <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">0</span>  
         <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">1</span>  
         <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">2</span>  
         <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">3</span>  
   <span class="p">)</span>
</code></pre></div></div>

<p>ì´ ê³¼ì •ì€ ìœ„ì—ì„œ ë§ì”€ ë“œë¦° INì˜ ë‹¨ì ì„ ìƒë‹¹ ë¶€ë¶„ í•´ì†Œí•©ë‹ˆë‹¤.  <code class="language-plaintext highlighter-rouge">SUB.event_param_index</code>  ì¹¼ëŸ¼ì˜ ê°’ë“¤ì„ ì¼ì¼ì´ ì¶œë ¥í–ˆë˜ ê²ƒê³¼ ë‹¬ë¦¬, ì´ë²ˆì—ëŠ” ì¡°ê±´ì„ ë§Œì¡±í•˜ê¸°ë§Œ í•˜ë©´ ë‹¨ìˆœíˆ ì¼ê´„ì ìœ¼ë¡œ  <code class="language-plaintext highlighter-rouge">1</code>ë¡œë§Œ êµ¬ì„±ëœ ì¹¼ëŸ¼ì„ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ê²Œ ë©ë‹ˆë‹¤. Data Type ì¸¡ë©´ì—ì„œ í›¨ì”¬ ë©”ëª¨ë¦¬ì˜ ë¶€ë‹´ì„ ê²½ê°ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (í˜¹ì€ <code class="language-plaintext highlighter-rouge">1</code>ì´ ì•„ë‹ˆë¼,  <code class="language-plaintext highlighter-rouge">True</code>ë‚˜  <code class="language-plaintext highlighter-rouge">False</code>ì™€ ê°™ì€ Boolean íƒ€ì…ìœ¼ë¡œ ì¶œë ¥í•˜ë©´ ë” í™•ì‹¤í•˜ê²Œ ê²½ê°ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒ ê°™ë„¤ìš”.)</p>

<h1 id="5-ê²°ë¡ -ë¬´ì¡°ê±´ì -ìš°ì›”ì„±ì€-ì—†ë‹¤">5. ê²°ë¡ : ë¬´ì¡°ê±´ì  ìš°ì›”ì„±ì€ ì—†ë‹¤.</h1>

<p>ì ì´ì œ ë‹¤ì‹œ ìµœì í™”ëœ ì¿¼ë¦¬ë¬¸ ì „ì²´ë¥¼ ë³´ì‹œì£ .</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
   <span class="nb">datetime</span><span class="p">,</span>  
   <span class="n">user_id</span><span class="p">,</span>  
   <span class="n">session_id</span><span class="p">,</span>  
   <span class="n">event_index</span><span class="p">,</span>  
   <span class="n">event_param_index</span><span class="p">,</span>  
   <span class="n">event_param_key</span><span class="p">,</span>  
   <span class="n">event_param_value</span>  
<span class="k">FROM</span>  
   <span class="n">source_events</span> <span class="n">MAIN</span>  
<span class="k">WHERE</span>  
   <span class="k">EXISTS</span> <span class="p">(</span>  
      <span class="k">SELECT</span> <span class="mi">1</span>  
      <span class="k">FROM</span> <span class="n">source_events</span> <span class="n">SUB</span>  
      <span class="k">WHERE</span>  
         <span class="n">event_type</span> <span class="o">=</span> <span class="s1">'click_button'</span>  
         <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">user_id</span>  
         <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">session_id</span>  
         <span class="k">AND</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_index</span>  
         <span class="k">AND</span> <span class="p">(</span>  
            <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">0</span>  
            <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">1</span>  
            <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">2</span>  
            <span class="k">OR</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">=</span> <span class="n">SUB</span><span class="p">.</span><span class="n">event_param_index</span> <span class="o">+</span> <span class="mi">3</span>  
         <span class="p">)</span>  
   <span class="p">)</span>
</code></pre></div></div>

<p>í”„ë¡œê·¸ë˜ë°ì—ëŠ” ë°˜ë“œì‹œ â€œ<strong>ë°©ë²• Aê°€ ë°©ë²• Bë³´ë‹¤ ìš°ì›”í•˜ë‹¤.</strong>â€ë¼ëŠ” ê²ƒì€ ì¡´ì¬í•˜ì§€ ì•Šì€ ê²ƒì²˜ëŸ¼, ê°ìì˜ í™˜ê²½ì— ë”°ë¼ ì·¨ì‚¬ì„ íƒí•˜ë©° ìµœì í™”ë¥¼ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•  ê²ƒì…ë‹ˆë‹¤.</p>

<p>WHERE Statementì˜ Subqueryê°€ JOINë³´ë‹¤ ë°˜ë“œì‹œ ìš°ì›”í•œ ê²ƒë„ ì•„ë‹ˆê³ , ê²½ìš°ì— ë”°ë¼ EXISTSê°€ INë³´ë‹¤ ë°˜ë“œì‹œ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì´ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

<p>ë˜í•œ, ì¼ë°˜ì ìœ¼ë¡œ Subqueryì™€ EXISTS ë¬¸ë²•ì€ SQL ì´ˆê¸‰ ì‚¬ìš©ì ë¶„ë“¤ê»˜ëŠ” ì‚´ì§ íŒ”ë¡œì—…í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ê°€ë…ì„± ì¸¡ë©´ì—ì„œ ì¶”í›„ ìœ ì§€ë³´ìˆ˜ì˜ ì¥ì• ë¡œ ì‘ìš©í•  ìˆ˜ë„ ìˆì„ ê²ƒì…ë‹ˆë‹¤.</p>

<p><img src="/assets/2023-11-30-how-to-avoid-self-joins/infinite-challenge.webp" alt="" /></p>
<blockquote>
  <p><a href="https://i.pinimg.com/736x/cd/c3/57/cdc35735e9efc721d26a0f3f780178a4.jpg">Source</a></p>
</blockquote>

<p>ì•ìœ¼ë¡œ, ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ë‹¤ë£¨ì‹œë‹¤ê°€ SELF JOIN ë•Œë¬¸ì— íŠ¸ë˜í”½ ë¬¸ì œê°€ ë°œìƒí•˜ì‹ ë‹¤ë©´ ìœ„ì™€ ê°™ì€ ì‚¬ë¡€ë¡œë„ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì„ ì°¸ê³ í•˜ì‹œê³ , ê°ì ì²˜í•œ í™˜ê²½ì— ë”°ë¼ ìµœì í™”í•˜ì—¬ ê°€ì„±ë¹„ ì¢‹ì€ ë°ì´í„° ë¶„ì„ì„ í•˜ì‹œê¸¸ ë°”ë„ê²Œìš”. ë¶€ì¡±í•œ ê¸€ì„ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</p>

<p><img src="/assets/2023-11-30-how-to-avoid-self-joins/bye-guys.webp" alt="" /></p>
<blockquote>
  <p>í‡´ì‚¬í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ê°€ ì•„ë‹ˆë¼, ê³„ì† ì¿¼ë¦¬ ì‘ì„±í•˜ëŸ¬ ê°€ê² ë‹¤ëŠ” ì˜ë¯¸</p>
</blockquote>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="korean" /><category term="data_analytics" /><category term="sql" /><summary type="html"><![CDATA[ëŒ€ê³ ê° ì„œë¹™ì„ ìœ„í•´ ì—„ì²­ë‚˜ê²Œ í° ì‚¬ì´ì¦ˆì˜ ì†ŒìŠ¤ í…Œì´ë¸”ë¡œë¶€í„° ìµœì í™”ëœ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ ê³ ë¯¼ì„ ë§ì´ í•˜ê³  ìˆëŠ” ë§Œí¼, ì´ë²ˆì—ëŠ” SELF JOIN ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ SQL ì„±ëŠ¥ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.]]></summary></entry><entry><title type="html">Toastmasters Club Log #1</title><link href="http://localhost:4000/toastmasters-club-log-1/" rel="alternate" type="text/html" title="Toastmasters Club Log #1" /><published>2023-11-25T00:00:00+09:00</published><updated>2023-11-25T00:00:00+09:00</updated><id>http://localhost:4000/toastmasters-club-log-1</id><content type="html" xml:base="http://localhost:4000/toastmasters-club-log-1/"><![CDATA[<blockquote>
  <p>Having recently become a member of JBTM last month, today marked my inaugural participation in the weekly in-person meeting. This occasion introduced me to a diverse array of our old members and new guests.</p>
</blockquote>

<p>Iâ€™m crafting this article to reflect on my experience joining JBTM, short for Jamsil Brunch Toastmasters Club, situated in Seoul, South Korea.</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/jbtm-profile.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.toastmasters.org/Find-a-Club/04049432-jamsil-brunch-toastmasters">Source</a></p>
</blockquote>

<p>Having recently become a member of JBTM last month, today marked my inaugural participation in the weekly in-person meeting. This occasion introduced me to a diverse array of our old members and new guests.</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/jbtm-selfie.webp" alt="" /></p>
<blockquote>
  <p>JBTM in-place meeting near Jamsil Olympics Stadium, Seoul (Nov 25, 2023)</p>
</blockquote>

<p>For your context, Toastmasters Club is a global non-profit organization dedicated to professional public speaking education, with branches spanning across the globe.</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/all-about-toastmasters.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.toastmasters.org/about">Source</a></p>
</blockquote>

<p>Since my initial membership at FJUTM (Fu Jen Catholic University, è¼”å¤§åœ‹éš›è‹±èªæ¼”è¬›ç¤¾FJUTM) in New Taipei City, Taiwan, back in 2018, my journey has consistently intertwined with Toastmasters Clubs due to my profound passion for public speaking and connecting with many global friends.</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/fjutm.webp" alt="" /></p>
<blockquote>
  <p>FJUTM in-place meeting in Fu Jen Catholic University, New Taipei City (Oct 21, 2018)</p>
</blockquote>

<p>Today, as one of the newly joined members of JBTM, I undertook my icebreaker speech as part of my Toastmasters pathway titled â€œPresentation Mastery.â€</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/presentation-mastery.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.toastmasters.org/myhome">Source</a></p>
</blockquote>

<p>The purpose of my icebreaker speech was to familiarize the existing members with who I am, my character, and my personal growth journey. I titled it â€œJoshua, the Comfort Zone Haterâ€, signifying my continuous efforts to challenge myself across various academic studies, cultures, environments, and foreign languages.</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/the-comfort-zone-hater.webp" alt="" /></p>
<blockquote>
  <p>â€œJoshua, the Comfort Zone Haterâ€</p>
</blockquote>

<p>Assisted by the attentive and supportive members, I successfully completed my first role as a prepared speech deliverer.</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/feedback.webp" alt="" /></p>
<blockquote>
  <p>The lovely and grateful feedback on my icebreaker speech from our members of JBTM</p>
</blockquote>

<p>Individuals join Toastmasters Clubs for various reasons, such as learning foreign languages, making connections with local communities, conquering public speaking fears, and expressing their thoughts logically, persuasively, and coherently, step by step.</p>

<p>In my case, though I may not pinpoint precisely why Iâ€™m drawn to Toastmasters Club, I consistently find joy in expressing my thoughts, sharing feedback, and engaging in multilingual conversations. Regardless of my concrete motivations, my series of active participation in Toastmasters Clubs undeniably has instilled confidence in speaking across diverse settings. Thanks to the Toastmasters Club, I never feel lost or anxious when delivering speeches in business meetings or on official stages.</p>

<p>Stay tuned to witness my journey with Toastmasters Club as a comfort zone hater and a challenge lover!</p>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/membership-history.webp" alt="" /></p>
<blockquote>
  <p>My Toastmasters Membership History; New Taipei City, Austin TX, Suwon, and now Seoul.</p>
</blockquote>

<p><img src="/assets/2023-11-25-toastmasters-club-log-1/toastmasters-logo.webp" alt="" /></p>
<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Toastmasters_International">Source</a></p>
</blockquote>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="public_speaking" /><category term="toastmasters" /><summary type="html"><![CDATA[Having recently become a member of JBTM last month, today marked my inaugural participation in the weekly in-person meeting. This occasion introduced me to a diverse array of our old members and new guests.]]></summary></entry><entry><title type="html">ë°ì´í„° ë¶„ì„ê°€ì˜ SQL ìµœì í™” ì¼ê¸°: Static vs. Rolling Stickiness</title><link href="http://localhost:4000/static-vs-rolling-stickiness/" rel="alternate" type="text/html" title="ë°ì´í„° ë¶„ì„ê°€ì˜ SQL ìµœì í™” ì¼ê¸°: Static vs. Rolling Stickiness" /><published>2023-11-19T00:00:00+09:00</published><updated>2023-11-19T00:00:00+09:00</updated><id>http://localhost:4000/static-vs-rolling-stickiness</id><content type="html" xml:base="http://localhost:4000/static-vs-rolling-stickiness/"><![CDATA[<blockquote>
  <p>ëŒ€ê³ ê° ì„œë¹™ì„ ìœ„í•´ ì—„ì²­ë‚˜ê²Œ í° ì‚¬ì´ì¦ˆì˜ ì†ŒìŠ¤ í…Œì´ë¸”ë¡œë¶€í„° ìµœì í™”ëœ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ ê³ ë¯¼ì„ ë§ì´ í•˜ê³  ìˆëŠ” ë§Œí¼, Stickiness ì§€í‘œ ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ SQL ì„±ëŠ¥ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
</blockquote>

<h3 id="contents">CONTENTS</h3>
<ol>
  <li>ë“¤ì–´ê°€ëŠ” ê¸€</li>
  <li>Rolling MAU vs. 30ì¼ ì´ë™í‰ê· ì„ </li>
  <li>Static MAU</li>
  <li>Stickiness ì§€í‘œ</li>
  <li>Rolling Stickiness</li>
  <li>Static Stickiness</li>
  <li>Data Martë¥¼ í†µí•´ Rolling MAU ë„ì…í•˜ê¸°</li>
  <li>ê²°ë¡ : Query Cost vs Data Freshness</li>
</ol>

<hr />

<h3 id="disclaimer">DISCLAIMER</h3>
<blockquote>
  <p>ë³¸ ìë£ŒëŠ” ì‘ì„±ì ë³¸ì¸ì˜ ê²¬í•´ì¼ ë¿ì´ë©°, ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì˜ í™˜ê²½ì— ë”°ë¼ ì í•©í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ ì¶œì²˜ë¥¼ ì œì™¸í•œ ëª¨ë“  ì¿¼ë¦¬ë¬¸ê³¼ ë‚´ìš©ì€ ë³¸ì¸ì˜ ê²½í—˜ì— ì˜í•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì‘ì„±ëœ ì¿¼ë¦¬ë¬¸ì€ ìƒ˜í”Œë¡œ ì‘ì„±í•œ ê²ƒì´ë©°, ë³¸ì¸ì˜ ê³¼ê±° ë° í˜„ì¬ ì¬ì§ íšŒì‚¬ì˜ ì—…ë¬´ í˜„í™©ê³¼ ë¬´ê´€í•©ë‹ˆë‹¤.</p>
</blockquote>

<h1 id="1-ë“¤ì–´ê°€ëŠ”-ê¸€">1. ë“¤ì–´ê°€ëŠ” ê¸€</h1>

<p><img src="/assets/2023-11-19-static-vs-rolling-stickiness/unfinished-work.webp" alt="" /></p>
<blockquote>
  <p><a href="https://datasciencedojo.com/blog/data-science-memes/">Source</a></p>
</blockquote>

<p>ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” ìœ„ ì•„ì´ ì²˜ëŸ¼ ë°ì´í„° ë¶„ì„ê°€ë¡œ ê·¼ë¬´í•˜ê³  ìˆëŠ” Joshuaë¼ê³  í•©ë‹ˆë‹¤.</p>

<p>ì €ëŠ” ì¼ë°˜ì ì¸ B2C ê¸°ì—…ì—ì„œ ë°ì´í„° ë¶„ì„ê°€ë¡œ ê·¼ë¬´í•˜ë©°, GA4, Amplitude, BigQuery, Redash ë“±ì„ í™œìš©í•˜ì—¬ A/B í…ŒìŠ¤íŠ¸, ì§€í‘œ ëª¨ë‹ˆí„°ë§ ë“±ì„ ìˆ˜í–‰í•˜ë©° íšŒì‚¬ì˜ ë“±ëŒ€ ì—­í• ì„ í•˜ë©° ì§€ëƒˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ë¶„ë“¤ê³¼ ë¹„ìŠ·í•œ ì—­í• ì„ ìˆ˜í–‰í–ˆë˜ ê²ƒì´ì£ .</p>

<p>ë˜í•œ GA4, Amplitude ë“±ê³¼ ê°™ì€ B2B ë°ì´í„° ë¶„ì„ í”Œë«í¼ ì„œë¹„ìŠ¤ë¥¼ ë§Œë“œëŠ” ê²½í—˜ë„ ì‚´ì§ í–ˆëŠ”ë°ìš”. ê·¸ëŸ¬ë‹¤ë³´ë‹ˆ ì €ì˜ R&amp;Rì€ ì„œë¹„ìŠ¤ ìì²´ì˜ ë°ì´í„° ë¶„ì„ ì—…ë¬´ ì™¸ì—ë„, ê³ ê°ë“¤ì—ê²Œ ë°ì´í„°ë¥¼ ì„œë¹™í•˜ê¸° ìœ„í•œ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ì™€ ìµœì í™” ì—…ë¬´ì— ì§‘ì¤‘ë˜ê¸°ë„ í–ˆìŠµë‹ˆë‹¤. ì œ íƒ€ì´í‹€ì„ ë©‹ìˆê²Œ ê°€ê³µí•˜ë©´ ìµœê·¼ì— ë– ì˜¤ë¥´ëŠ” í¬ì§€ì…˜ì¸ Analytics Engineer, ë°˜ìª½ ì§œë¦¬ ë°ì´í„° ì—”ì§€ë‹ˆì–´, ì•„ë‹ˆë©´ ëŒ€ì¶© ì¿¼ë¦¬ ë¨¸ì‹  í˜¹ì€ ë¶„ì§€ë‹ˆì–´(?)ì¸ ê²ƒ ê°™ê¸°ë„ í•©ë‹ˆë‹¤. ğŸ˜…</p>

<p>ì•„ë¬´íŠ¼ ëŒ€ê³ ê° ì„œë¹™ì„ ìœ„í•´ ì—„ì²­ë‚˜ê²Œ í° ì‚¬ì´ì¦ˆì˜ ì†ŒìŠ¤ í…Œì´ë¸”ë¡œë¶€í„° ìµœì í™”ëœ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ ê³ ë¯¼ì„ ë§ì´ í•˜ê³  ìˆëŠ” ë§Œí¼, Stickiness ì§€í‘œ ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ SQL ì„±ëŠ¥ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<p>(SQL ì „ë¬¸ê°€ ë¶„ë“¤ì´ ë§ì´ ê³„ì‹œëŠ” ë§Œí¼, ì œ ê¸€ì„ ë¹„íŒì ìœ¼ë¡œ ê³ ì°°í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„)</p>

<h1 id="2-rolling-mau-vs-30ì¼-ì´ë™í‰ê· ì„ ">2. Rolling MAU vs. 30ì¼ ì´ë™í‰ê· ì„ </h1>

<p>Rolling MAUë€ ë§ˆì¹˜ 30ì¼ ì´ë™í‰ê· ì„  ì¸ë””ì¼€ì´í„° ë“±ê³¼ ìœ ì‚¬í•˜ê²Œ, ê° ì‹œì ë§ˆë‹¤ ìµœê·¼ 30ì¼ ë™ì•ˆì˜ MAUë¥¼ ì¸¡ì •í•˜ëŠ” ì§€í‘œì…ë‹ˆë‹¤. ì•„ë˜ GA4ì˜ ë¦¬í¬íŠ¸ëŠ” WAUì™€ MAUë¥¼ ëª¨ë‘ Rolling ë°©ì‹ìœ¼ë¡œ ì§‘ê³„í•˜ê³  ìˆëŠ” ëŒ€í‘œì ì¸ ì‚¬ë¡€ë¼ê³  í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ì„œ ê°€ì ¸ì™€ë´¤ì–´ìš”!</p>

<p><img src="/assets/2023-11-19-static-vs-rolling-stickiness/user-activity-over-time.webp" alt="" /></p>
<blockquote>
  <p><a href="https://measureschool.com/ga4-active-users/">Source</a></p>
</blockquote>

<p>í•˜ì§€ë§Œ, 30ì¼ ì´ë™í‰ê· ì„  ì¸ë””ì¼€ì´í„°ì™€ Rolling MAUì˜ ì—°ì‚° ë°©ì‹ì—ëŠ” ì¤‘ëŒ€í•œ ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤.</p>

<p><img src="/assets/2023-11-19-static-vs-rolling-stickiness/trading-view.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.tradingwithrayner.com/20-30-day-moving-average/">Source</a></p>
</blockquote>

<p>ë¨¼ì € 30ì¼ ì´ë™í‰ê· ì„ ì„ SQLìŠ¤ëŸ½ê²Œ ì‘ì„±í•´ë³¸ë‹¤ë©´, ë‹¨ìˆœíˆ  <code class="language-plaintext highlighter-rouge">AVG Window Functions</code>ë¥¼ í†µí•´ ì¦‰ê°ì ìœ¼ë¡œ ì—°ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Window FunctionsëŠ” ì´ë¯¸ ì¶œë ¥ëœ  <code class="language-plaintext highlighter-rouge">price</code>  ì¹¼ëŸ¼ ìì²´ë¥¼ í†µí•´ ì—°ì‚°í•˜ë¯€ë¡œ,  <code class="language-plaintext highlighter-rouge">daily_prices</code>  í…Œì´ë¸”ì„ ì¤‘ë³µìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šì•„ ì—°ì‚°ëŸ‰ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">CTE_ma_30d</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="nb">date</span><span class="p">,</span>
      <span class="n">price</span><span class="p">,</span>
      <span class="k">AVG</span><span class="p">(</span><span class="n">price</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span>
         <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">date</span>
         <span class="k">ROWS</span> <span class="k">BETWEEN</span> <span class="mi">29</span> <span class="k">PRECEDING</span> <span class="k">AND</span> <span class="k">CURRENT</span> <span class="k">ROW</span>
      <span class="p">)</span> <span class="k">AS</span> <span class="n">ma_30d</span>
   <span class="k">FROM</span>
      <span class="n">daily_prices</span>
   <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">CTE_ma_30d</span>
<span class="p">;</span>
</code></pre></div></div>

<p>ë°˜ë©´, Rolling MAUì˜ ì—°ì‚° ë°©ì‹ì€ ì¤‘ëŒ€í•œ ë¬¸ì œì ì´ ìˆìŠµë‹ˆë‹¤. ì¦‰, Window Functionsë¥¼ í†µí•´ ì—°ì‚°í•˜ëŠ” ê²ƒì´ ì–´ë µë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì•„ë˜ ì¿¼ë¦¬ë¬¸ì„ ì‚´í´ë³´ë©´,  <code class="language-plaintext highlighter-rouge">SELECT Statement</code>  ë‚´ ì„œë¸Œì¿¼ë¦¬ë¥¼ í†µí•´ Outer Tableì˜ ê°  <code class="language-plaintext highlighter-rouge">date</code>ë§ˆë‹¤ ì¼ì¼ì´ Inner Tableì˜ ê°€ë³€ì ì¸ ê¸°ê°„ë§ˆë‹¤ ëª¨ë“   <code class="language-plaintext highlighter-rouge">user_id</code>  ê³ ìœ ê°’ ê°œìˆ˜ë¥¼  <code class="language-plaintext highlighter-rouge">COUNT</code>í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰,  <code class="language-plaintext highlighter-rouge">session_starts</code>  í…Œì´ë¸” ë‚´ì˜  <code class="language-plaintext highlighter-rouge">date</code>  ê³ ìœ ê°’ ê°œìˆ˜ê°€ 365ê°œë¼ë©´, ê°  <code class="language-plaintext highlighter-rouge">rolling_mau</code>  ì¹¼ëŸ¼ì˜ ê°’ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œëŠ” ë™ì¼í•œ í…Œì´ë¸”ì„ 365ë²ˆì´ë‚˜ ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ì•¼ í•˜ëŠ” ê²ƒì´ì£ .</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">CTE_rolling_mau</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">MAIN</span><span class="p">.</span><span class="nb">date</span><span class="p">,</span>
      <span class="p">(</span>
         <span class="k">SELECT</span>
            <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span>
         <span class="k">FROM</span>
            <span class="n">session_starts</span> <span class="n">SUB</span>
         <span class="k">WHERE</span>
            <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="n">MAIN</span><span class="p">.</span><span class="nb">date</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SUB</span><span class="p">.</span><span class="nb">date</span>
            <span class="k">AND</span> <span class="n">SUB</span><span class="p">.</span><span class="nb">date</span> <span class="o">&lt;=</span> <span class="n">MAIN</span><span class="p">.</span><span class="nb">date</span>
      <span class="p">)</span> <span class="k">AS</span> <span class="n">rolling_mau</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span> <span class="n">MAIN</span>
   <span class="k">GROUP</span> <span class="k">BY</span>
      <span class="mi">1</span>
   <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">CTE_rolling_mau</span>
<span class="p">;</span>
</code></pre></div></div>

<p>ê²°êµ­, 30ì¼ ì´ë™í‰ê· ì„ ê³¼ ë‹¬ë¦¬ Rolling MAUì˜ ê²½ìš° ë‹¨ìˆœí•œ ì§‘ê³„ë¡œ ê°€ëŠ¥í•œ ì˜ì—­ì´ ì•„ë‹ˆë¼,  <code class="language-plaintext highlighter-rouge">COUNT(DISTINCT user_id)</code>ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ í…Œì´ë¸” ì¬íƒìƒ‰ì´ ê° Rowë§ˆë‹¤ ì¤‘ë³µ ë°œìƒí•´ì•¼ í•˜ëŠ” ì˜ì—­ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ëŠ” ì¿¼ë¦¬ë¬¸ì˜ ì„±ëŠ¥ê³¼ ë¹„ìš© ê´€ë¦¬ì— ë§¤ìš° ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¼ì¹˜ê²Œ ë©ë‹ˆë‹¤.</p>

<h1 id="3-static-mau">3. Static MAU</h1>

<p>Static MAUëŠ” ì œê°€ ì§ì ‘ ë§ˆìŒëŒ€ë¡œ ì§€ì–´ë³¸ ìš©ì–´ì¸ë°ìš”. ğŸ˜… Rolling MAUì—ì„œ ê²ªì€ ë¬¸ì œì ì— ëŒ€í•´ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ íƒ€í˜‘ì„ í•´ë´¤ìŠµë‹ˆë‹¤.</p>

<p><img src="/assets/2023-11-19-static-vs-rolling-stickiness/cat.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.reddit.com/r/ProgrammerHumor/comments/szxooa/the_difference_between_dynamic_vs_static_ip/?rdt=33714">Source</a></p>
</blockquote>

<p><strong>â€œì–´ì©” ìˆ˜ ì—†ë„¤. ê·¸ëŸ¼, MAUëŠ” Rolling ë°©ì‹ì´ ì•„ë‹Œ ê° ì›” ë³„ë¡œ Staticí•˜ê²Œ ì§‘ê³„í•´ë³´ì!â€</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">CTE_static_mau</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="s1">'MONTH'</span><span class="p">,</span> <span class="nb">date</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span><span class="p">,</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">static_mau</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span>
   <span class="k">GROUP</span> <span class="k">BY</span>
      <span class="mi">1</span>
   <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">CTE_static_mau</span>
<span class="p">;</span>
</code></pre></div></div>

<p>Static MAUëŠ” Rolling MAUì— ë¹„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì¥/ë‹¨ì ì´ ì¡´ì¬í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
<ul>
  <li><strong>ì¥ì </strong>: ì¿¼ë¦¬ ë¹„ìš©ì´ í¬ê²Œ ì ˆê°ë˜ê³  ì—°ì‚° ì†ë„ê°€ ë¹¨ë¼ì§‘ë‹ˆë‹¤.</li>
  <li><strong>ë‹¨ì </strong>: ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ëŠ” ì‹œì  ë‹¹ì›”ì˜ ê²½ìš°, ì›”ë§ì´ ë„ë˜í•˜ê¸° ì „ê¹Œì§€ëŠ” MAUê°€ ê³¼ì†Œí‰ê°€ë˜ì–´ ë°ì´í„° ë¶„ì„ì˜ Freshnessê°€ ì €í•˜ë©ë‹ˆë‹¤. ì¦‰, ì˜¤ëŠ˜ì´ 1ì›” 2ì¼ì´ë¼ë©´ 1ì›”ì˜ MAUëŠ” 1ì›” 1ì¼ë¶€í„° 1ì›” 2ì¼ê¹Œì§€ë§Œ ì§‘ê³„ë˜ê² ì£ .</li>
</ul>

<h1 id="4-stickiness-ì§€í‘œ">4. Stickiness ì§€í‘œ</h1>

<p>í•œí¸, í”íˆ <code class="language-plaintext highlighter-rouge">DAUâ—MAU</code>ë¡œ í‘œí˜„ë˜ëŠ” Stickiness(ì‚¬ìš©ì ê³ ì°©ë„)ë¥¼ ì¸¡ì •í•˜ëŠ” ê²½ìš°ì—ëŠ” Staticê³¼ Rolling ë°©ì‹ ì‚¬ì´ì˜ ê³ ë¯¼ì´ ë”ìš± ê¹Šì–´ì§€ê²Œ ë©ë‹ˆë‹¤.</p>

<p>Stickiness ì§€í‘œëŠ” í† ìŠ¤, Instagram, YouTube, TikTok, ë¸”ë¼ì¸ë“œ ë“± í™œì„± ì‚¬ìš©ìë“¤ì´ ìŠµê´€ì ìœ¼ë¡œ ì•±ì— ë°©ë¬¸í•¨ìœ¼ë¡œì¨ ê´‘ê³  ë…¸ì¶œ íš¨ê³¼ ë“±ì„ ê·¹ëŒ€í™”í•´ì•¼ í•˜ëŠ” ì„œë¹„ìŠ¤ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ì§€í‘œì…ë‹ˆë‹¤. ë‚˜ì˜ê²Œ ë§í•˜ë©´, ì‚¬ìš©ìì˜ ì¤‘ë…ë„ë¥¼ íŒŒì•…í•˜ê¸° ìœ„í•œ ì§€í‘œì¸ ê²ƒì´ì£ . ğŸ˜‚</p>

<p><img src="/assets/2023-11-19-static-vs-rolling-stickiness/facebook.webp" alt="" /></p>
<blockquote>
  <p><a href="https://velog.io/@datarian/retention4">Source</a></p>
</blockquote>

<h1 id="5-rolling-stickiness">5. Rolling Stickiness</h1>

<p>Stickinessë„ ë§ˆì°¬ê°€ì§€ë¡œ, Rolling Stickinessì™€ Static Stickinessë¡œ êµ¬ë¶„í•˜ì—¬ ì—°ì‚°í•  ìˆ˜ ìˆëŠ”ë°ìš”. (Static Stickinessë„ ì œê°€ ë§ˆìŒëŒ€ë¡œ ì§€ì–´ë³¸ ìš©ì–´ì…ë‹ˆë‹¤.) ë¨¼ì € Rolling Stickiness ì§€í‘œ ì‚°ì¶œì„ ìœ„í•œ ì¿¼ë¦¬ë¬¸ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
(ì°¸ê³ ë¡œ, ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” ì¼€ì´ìŠ¤ì˜ ê²½ìš°, 0ìœ¼ë¡œ ë°˜í™˜ë˜ë„ë¡  <code class="language-plaintext highlighter-rouge">COALSECE(TRY(â€¦), 0)</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. í˜¼ë™ì´ ì—†ìœ¼ì‹œê¸¸ ë°”ë„ê²Œìš”! ğŸ™ƒ)</p>

<p>ì´ ê²½ìš° Rolling MAU ì—°ì‚° ë°©ì‹ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, Outer Tableì˜ ê°  <code class="language-plaintext highlighter-rouge">date</code>ë§ˆë‹¤ ì¼ì¼ì´ Inner Tableì˜ ëª¨ë“   <code class="language-plaintext highlighter-rouge">user_id</code>  ê³ ìœ ê°’ ê°œìˆ˜ë¥¼  <code class="language-plaintext highlighter-rouge">COUNT</code>í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ê³¼ íŠ¸ë˜í”½ ìˆ˜ì¤€ì´ ê¸‰ê²©í•˜ê²Œ ìƒìŠ¹í•  ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">CTE_rolling_stickiness</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">MAIN</span><span class="p">.</span><span class="nb">date</span><span class="p">,</span>
      <span class="n">COALESCE</span><span class="p">(</span>
         <span class="n">TRY</span><span class="p">(</span>
            <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span>
            <span class="o">/</span>
            <span class="p">(</span>
               <span class="k">SELECT</span>
                  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span>
               <span class="k">FROM</span>
                  <span class="n">session_start</span> <span class="n">SUB</span>
               <span class="k">WHERE</span>
                  <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="n">MAIN</span><span class="p">.</span><span class="nb">date</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SUB</span><span class="p">.</span><span class="nb">date</span>
                  <span class="k">AND</span> <span class="n">SUB</span><span class="p">.</span><span class="nb">date</span> <span class="o">&lt;=</span> <span class="n">MAIN</span><span class="p">.</span><span class="nb">date</span>
            <span class="p">)</span>
         <span class="p">),</span>
         <span class="mi">0</span>
      <span class="p">)</span> <span class="k">AS</span> <span class="n">rolling_stickiness</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span> <span class="n">MAIN</span>
   <span class="k">GROUP</span> <span class="k">BY</span>
      <span class="mi">1</span>
   <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">CTE_rolling_stickiness</span>
<span class="p">;</span>
</code></pre></div></div>

<h1 id="6-static-stickiness">6. Static Stickiness</h1>

<p>ê·¸ëŸ¬ë‚˜ Static Stickiness ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•  ê²½ìš° ì¿¼ë¦¬ë¬¸ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. DAUì™€ Static MAUë¥¼ Inline Viewë¡œ ë¨¼ì € ê³„ì‚°í•œ í›„, ê° ì¼ì ë³„  <code class="language-plaintext highlighter-rouge">dau</code>ë¥¼ ê³ ì •ëœ ì›”ì˜  <code class="language-plaintext highlighter-rouge">mau</code>ë¡œ ë‚˜ëˆ„ì–´ì£¼ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì´ ê²½ìš°, ì¿¼ë¦¬ ë¹„ìš©ê³¼ ì—°ì‚° ì†ë„ë¥¼ í¬ê²Œ ê°œì„ í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">CTE_dau</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="nb">date</span><span class="p">,</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">dau</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span>
   <span class="k">GROUP</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">),</span>
<span class="n">CTE_static_mau</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="s1">'MONTH'</span><span class="p">,</span> <span class="nb">date</span><span class="p">)</span> <span class="k">AS</span> <span class="k">month</span><span class="p">,</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">static_mau</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span>
   <span class="k">GROUP</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">),</span>
<span class="n">CTE_static_stickiness</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">dau</span><span class="p">.</span><span class="nb">date</span><span class="p">,</span>
      <span class="n">COALESCE</span><span class="p">(</span>
         <span class="n">TRY</span><span class="p">(</span><span class="n">dau</span><span class="p">.</span><span class="n">dau</span> <span class="o">/</span> <span class="n">static_mau</span><span class="p">.</span><span class="n">static_mau</span><span class="p">),</span>
         <span class="mi">0</span>
      <span class="p">)</span> <span class="k">AS</span> <span class="n">static_stickiness</span>
   <span class="k">FROM</span>
      <span class="n">dau</span>
   <span class="k">LEFT</span> <span class="k">JOIN</span>
      <span class="n">static_mau</span>
      <span class="k">ON</span> <span class="n">DATE_TRUNC</span><span class="p">(</span><span class="s1">'MONTH'</span><span class="p">,</span> <span class="n">dau</span><span class="p">.</span><span class="nb">date</span><span class="p">)</span> <span class="o">=</span> <span class="n">static_mau</span><span class="p">.</span><span class="k">month</span>
   <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">CTE_static_stickiness</span>
<span class="p">;</span>
</code></pre></div></div>

<p>ë¬¼ë¡ , Static StickinessëŠ” Rolling Stickinessì— ë¹„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì¥/ë‹¨ì ì´ ì¡´ì¬í•©ë‹ˆë‹¤.</p>
<ul>
  <li><strong>ì¥ì </strong>: ì¿¼ë¦¬ ë¹„ìš©ì´ í¬ê²Œ ì ˆê°ë˜ê³  ì—°ì‚° ì†ë„ê°€ ë¹¨ë¼ì§‘ë‹ˆë‹¤.</li>
  <li><strong>ë‹¨ì </strong>: ë‹¹ì›”ì˜ ê²½ìš°, ì›”ë§ì´ ë„ë˜í•˜ê¸° ì „ê¹Œì§€ëŠ” MAUê°€ ê³¼ì†Œí‰ê°€ë˜ì–´ Stickinessê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ì€ ê°’ìœ¼ë¡œ ì¸¡ì •ë©ë‹ˆë‹¤. ì¦‰, ì˜¤ëŠ˜ì´ 1ì›” 1ì¼ì´ë¼ë©´,  <code class="language-plaintext highlighter-rouge">DAU=MAU</code>  ì´ë¯€ë¡œ  <code class="language-plaintext highlighter-rouge">Stickiness=100%</code>ì¸ ë§ë„ ì•ˆë˜ëŠ” ìˆ˜ì¹˜ê°€ ëŒ€ì‹œë³´ë“œì— í‘œì‹œë  ê²ƒì…ë‹ˆë‹¤.ğŸ˜¨</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">Stickiness=100%</code>  ë¡œ í‘œí˜„ë˜ë©´, ì‚¬ë‚´ êµ¬ì„±ì›ë“¤ì—ê²Œ ì˜ëª»ëœ ì˜ì‚¬ê²°ì •ì˜ ê·¼ê±°ë¥¼ ì „ë‹¬í•˜ê²Œ ë  ìœ„í—˜ì„±ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, Static Stickiness ë°©ì‹ì„ ì‚¬ë‚´ì— ë„ì…í•˜ê²Œ ë  ê²½ìš°, ë§¤ì›” ì´ˆ ìì •ì—ë§Œ Appendingë˜ë„ë¡ í•˜ëŠ” ìŠ¤ì¼€ì¤„ë§ì„ ë‘ì–´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤. ì¦‰, 1ì›” 1ì¼ë¶€í„° 1ì›” 31ì¼ê¹Œì§€ì˜ Stickiness ì§€í‘œëŠ” 2ì›” 1ì¼ì´ ë˜ì–´ì•¼ë§Œ ëŒ€ì‹œë³´ë“œì— í‘œí˜„ë˜ëŠ” ê²ƒì´ì£ . ê·¸ë ‡ë‹¤ë©´, Stickiness ì§€í‘œëŠ” ìµœëŒ€ 30ì¼ ì´ìƒ ì§€ì—°ë˜ì–´ ì„œë¹„ìŠ¤ì˜ ì‹ ì†í•œ Action Itemì„ ì‹¤í–‰í•˜ê¸°ê°€ ì–´ë ¤ì›Œì§ˆ ê²ƒì…ë‹ˆë‹¤. StickinessëŠ” Data Freshnessê°€ ì¤‘ìš”í•œ ì§€í‘œ ì¤‘ í•˜ë‚˜ì¸ë°ë„ ë¶ˆêµ¬í•˜ê³  ë§ì´ì£ .</p>

<h1 id="7-data-martë¥¼-í†µí•´-rolling-mau-ë„ì…í•˜ê¸°">7. Data Martë¥¼ í†µí•´ Rolling MAU ë„ì…í•˜ê¸°</h1>

<p>ê·¸ëŸ¬ë©´ ëŒ€ì•ˆì´ ì—†ì„ê¹Œìš”? ì—†ìœ¼ë©´ ì œê°€ ì´ ê¸€ì„ ì•ˆ ì¼ê² ì£ .ğŸ¤­ Data Mart ë‚´ì— Incremental Strategyë¥¼ ì ìš©í•œ <code class="language-plaintext highlighter-rouge">rolling_mau</code>  í…Œì´ë¸” ìŠ¤ì¼€ì¤„ë§ì„ êµ¬ì¶•í•œë‹¤ë©´ ì•ì„œ ì–¸ê¸‰í•œ Rolling Stickinessì˜ ì¹˜ëª…ì ì¸ ë‹¨ì ì„ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°€ë ¹, ë‹¤ìŒê³¼ ê°™ì´ ë§¤ì¼ ìì •ì— Appendingë˜ëŠ”  <code class="language-plaintext highlighter-rouge">fact_rolling_mau</code>  í…Œì´ë¸”ì„ ìƒì„±í•œë‹¤ê³  ê°€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">fact_rolling_mau</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">CURRENT_DATE</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">date</span><span class="p">,</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">rolling_mau</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span>
   <span class="k">WHERE</span>
      <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="k">CURRENT_DATE</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">date</span>
      <span class="k">AND</span> <span class="nb">date</span> <span class="o">&lt;=</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">CURRENT_DATE</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">fact_rolling_mau</span>
<span class="p">;</span>
</code></pre></div></div>

<p>ì¦‰ ë‹¤ìŒê³¼ ê°™ì´,  <code class="language-plaintext highlighter-rouge">fact_rolling_mau</code>  í…Œì´ë¸”ì€ ì¤‘ë³µ ì—°ì‚° ë¬¸ì œë¥¼ ë²—ì–´ë‚œ ì±„ ë§¤ì¼ ìƒˆë¡œìš´  <code class="language-plaintext highlighter-rouge">rolling_mau</code>  ê°’ì„ ì—…ë°ì´íŠ¸í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>date</strong></th>
      <th><strong>rolling_mau</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2023-01-01</td>
      <td>100,000</td>
    </tr>
    <tr>
      <td>2023-01-01</td>
      <td>101,000</td>
    </tr>
    <tr>
      <td>â€¦</td>
      <td>â€¦</td>
    </tr>
    <tr>
      <td>2023-01-01</td>
      <td>99,700</td>
    </tr>
    <tr>
      <td>2023-01-01</td>
      <td>110,000</td>
    </tr>
    <tr>
      <td>â€¦</td>
      <td>â€¦</td>
    </tr>
  </tbody>
</table>

<p>ì´ì œ ì´ë¯¸ ìƒì„±ëœ  <code class="language-plaintext highlighter-rouge">fact_rolling_mau</code>  í…Œì´ë¸”ì„ í†µí•´ Rolling Stickinessë¥¼ ê³„ì‚°í•˜ëŠ” ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>
<span class="n">CTE_dau</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="nb">date</span><span class="p">,</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">dau</span>
   <span class="k">FROM</span>
      <span class="n">session_starts</span>
   <span class="k">GROUP</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">),</span>
<span class="n">CTE_rolling_stickiness</span> <span class="k">AS</span> <span class="p">(</span>
   <span class="k">SELECT</span>
      <span class="n">dau</span><span class="p">.</span><span class="nb">date</span><span class="p">,</span>
      <span class="n">COALESCE</span><span class="p">(</span>
         <span class="n">TRY</span><span class="p">(</span><span class="n">dau</span><span class="p">.</span><span class="n">dau</span> <span class="o">/</span> <span class="n">fact_rolling_mau</span><span class="p">.</span><span class="n">rolling_mau</span><span class="p">),</span>
         <span class="mi">0</span>
      <span class="p">)</span> <span class="k">AS</span> <span class="n">rolling_stickiness</span>
   <span class="k">FROM</span>
      <span class="n">CTE_dau</span>
   <span class="k">LEFT</span> <span class="k">JOIN</span>
      <span class="n">fact_rolling_mau</span>
      <span class="k">ON</span> <span class="n">dau</span><span class="p">.</span><span class="nb">date</span> <span class="o">=</span> <span class="n">rolling_mau</span><span class="p">.</span><span class="nb">date</span>
   <span class="k">ORDER</span> <span class="k">BY</span>
      <span class="mi">1</span>
<span class="p">)</span>
<span class="k">SELECT</span>
   <span class="o">*</span>
<span class="k">FROM</span>
   <span class="n">CTE_rolling_stickiness</span>
<span class="p">;</span>
</code></pre></div></div>

<h1 id="8-ê²°ë¡ -query-cost-vs-data-freshness">8. ê²°ë¡ : Query Cost vs Data Freshness</h1>

<p>ê²°êµ­ Rolling MAU, Rolling Stickiness ì§€í‘œì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë‹¤ë£¨ë‹¤ë³´ë‹ˆ ìì—°ìŠ¤ëŸ½ê²Œ Data Martì˜ í•„ìš”ì„±ìœ¼ë¡œ ê·€ê²°ë˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. Data MartëŠ” ë‹¨ìˆœíˆ ì¿¼ë¦¬ ê²°ê³¼ì˜ ì •í™•ì„±ì´ë‚˜ ì¼ê´€ì„±ë§Œì„ ìœ„í•´ í•„ìš”í•œ ê²ƒì´ ì•„ë‹ˆë¼, ì´ì²˜ëŸ¼ Query Cost vs Data Freshness ì‚¬ì´ì˜ ìƒì¶© ê´€ê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ì„œë„ í•„ìš”í•˜ë‹¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ, ì„œë¹„ìŠ¤ì˜ ì‚¬ìš© ê·œëª¨ì— ë”°ë¼ ì†ŒìŠ¤ í…Œì´ë¸”ì˜ ì‚¬ì´ì¦ˆê°€ ë°©ëŒ€í•´ì§ˆìˆ˜ë¡ Data Martì˜ í™œìš©ì€ í•„ìˆ˜ì ì¼ ê²ƒì…ë‹ˆë‹¤. ë¶€ì¡±í•œ ê¸€ì„ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</p>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="korean" /><category term="data_analytics" /><category term="sql" /><category term="data_warehouse" /><summary type="html"><![CDATA[ëŒ€ê³ ê° ì„œë¹™ì„ ìœ„í•´ ì—„ì²­ë‚˜ê²Œ í° ì‚¬ì´ì¦ˆì˜ ì†ŒìŠ¤ í…Œì´ë¸”ë¡œë¶€í„° ìµœì í™”ëœ ë°ì´í„° ë§ˆíŠ¸ ì„¤ê³„ ê³ ë¯¼ì„ ë§ì´ í•˜ê³  ìˆëŠ” ë§Œí¼, Stickiness ì§€í‘œ ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ SQL ì„±ëŠ¥ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.]]></summary></entry><entry><title type="html">Near Protocol: Account Model and Transaction Story</title><link href="http://localhost:4000/near-protocol/" rel="alternate" type="text/html" title="Near Protocol: Account Model and Transaction Story" /><published>2023-11-18T00:00:00+09:00</published><updated>2023-11-18T00:00:00+09:00</updated><id>http://localhost:4000/near-protocol</id><content type="html" xml:base="http://localhost:4000/near-protocol/"><![CDATA[<blockquote>
  <p>Dive into the intricate world of blockchain with Joshua. Uncover the complexities of Near Protocolâ€™s account model, transaction stories, and personal insights. This article offers a captivating exploration of addresses, private keys, and the execution flow of transactions, providing a unique perspective on user experience and protocol design. Join me on this insightful journey, backed by personal research and a wealth of references from the blockchain realm.</p>
</blockquote>

<h3 id="contents">CONTENTS</h3>
<ol>
  <li>Account Model Story
    <ul>
      <li>1.1. Addresses</li>
      <li>1.2. Private Keys</li>
      <li>1.3. A Sample UX Case</li>
    </ul>
  </li>
  <li>Transaction Story
    <ul>
      <li>2.1. Transactions</li>
      <li>2.2. Actions</li>
      <li>2.3. Receipts</li>
      <li>2.4. A Sample Transactions Case</li>
    </ul>
  </li>
  <li>Personal Thoughts</li>
  <li>References</li>
</ol>

<hr />

<h3 id="disclaimer">DISCLAIMER</h3>
<blockquote>
  <p>This material is based on personal research and study; therefore, it may contain factual errors and cannot be relied upon for critical decision-making. Additionally, the opinions in the material are purely subjective and have no connection to any past or current companies that I have worked at.</p>
</blockquote>

<h1 id="1-account-model-story">1. Account Model Story</h1>

<p><img src="/assets/2023-11-18-near-protocol/account-model-story.webp" alt="" /></p>
<blockquote>
  <p><a href="https://docs.near.org/concepts/basics/accounts/model">Source</a></p>
</blockquote>

<h2 id="11-addresses">1.1. Addresses</h2>

<h3 id="there-are-two-types-of-accounts">There are Two Types of Accounts.</h3>

<p><strong>1. Named Account</strong></p>
<ul>
  <li>i.e.,  <code class="language-plaintext highlighter-rouge">alice.near</code>,  <code class="language-plaintext highlighter-rouge">bob.near</code>,  <code class="language-plaintext highlighter-rouge">usa.near</code>,  <code class="language-plaintext highlighter-rouge">texas.usa.near</code></li>
  <li>Formatically Same as DNS</li>
  <li>ğŸ™†ğŸ»â€â™‚ï¸  <code class="language-plaintext highlighter-rouge">usa.near</code>  â†’  <code class="language-plaintext highlighter-rouge">texas.usa.near</code>  can be created.</li>
  <li>ğŸ™…ğŸ»â€â™‚ï¸  <code class="language-plaintext highlighter-rouge">usa.near</code>  â†’  <code class="language-plaintext highlighter-rouge">texas.uk.near</code>  can NOT be created.</li>
</ul>

<p><strong>2. Implicit Account</strong></p>
<ul>
  <li>i.e.,  <code class="language-plaintext highlighter-rouge">98793cd91a3f870fb126f662858[...]</code></li>
  <li>Formatically Similar to the Traditional Way to Create Addresses such as Bitcoin and Ethereum (64 letters)</li>
</ul>

<h3 id="personal-thoughts">Personal Thoughts</h3>

<p><strong>1. Named Account</strong></p>
<ul>
  <li>Improves the end-user UX of the product because itâ€™s easy to memorize!</li>
  <li>While ENS is executed at the  <strong>contract layer</strong>, Nearâ€™s Named Account is executed at the  <strong>protocol layer</strong>.</li>
</ul>

<p><strong>2. Implicit Account</strong></p>
<ul>
  <li>For user groups that want to maintain pseudonymization!</li>
  <li>For developers accustomed to traditional address systems, especially hardware wallet service companies</li>
</ul>

<h2 id="12-private-keys">1.2. Private Keys</h2>

<h3 id="there-are-two-types-of-private-keys">There are Two Types of Private Keys.</h3>

<p><img src="/assets/2023-11-18-near-protocol/private-keys.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.vitalpoint.ai/understanding-near-keys/">Source</a></p>
</blockquote>

<p><strong>1. Full Access Key</strong></p>
<blockquote>
  <p><strong>The address can be used to sign transactions of all types.</strong></p>
</blockquote>

<ul>
  <li>The 8 Types of Transactions (<code class="language-plaintext highlighter-rouge">Transaction Actions</code>)
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Transfer</span><span class="p">,</span> <span class="c1"># Transfer Tokens  
</span><span class="n">CreateAccount</span><span class="p">,</span> <span class="c1"># Create Accounts  
</span><span class="n">DeleteAccount</span><span class="p">,</span> <span class="c1"># Delete Accounts  
</span><span class="n">DeployContract</span><span class="p">,</span> <span class="c1"># Deploy Contracts  
</span><span class="n">FunctionCall</span><span class="p">,</span> <span class="c1"># Call Functions of Contracts  
</span><span class="n">Stake</span><span class="p">,</span> <span class="c1"># Staking  
</span><span class="n">AddKey</span><span class="p">,</span> <span class="c1"># Add Keys  
</span><span class="n">DeleteKey</span> <span class="c1"># Delete Keys
</span></code></pre></div>    </div>
  </li>
</ul>

<p><strong>2. Function Call Key</strong></p>
<blockquote>
  <p><strong>The address can be used to sign the following restricted transactions.</strong></p>
</blockquote>

<ul>
  <li>Transactions are restricted to  <strong>specific function(s)</strong>  within  <strong>a specific contract</strong>.</li>
  <li>Sending Native Token, $NEAR, is NOT possible.
    <ul>
      <li>Gas Fees can be paid, however.</li>
      <li>Of course, if you set it so that you canâ€™t even pay Gas Fees, only functions related to View methods can be called.</li>
    </ul>
  </li>
  <li>Purpose of Using Function Call Keys
    <ul>
      <li>By passing it to the dAppâ€™s client, creating an environment where the dApp can immediately invoke contract calls with limited permissions.</li>
    </ul>
  </li>
</ul>

<h3 id="parameters">Parameters</h3>

<p><strong>1. Full Access Key</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">pub</span> <span class="kr">enum</span> <span class="nx">AccessKeyPermission</span> <span class="p">{</span>  
    <span class="nc">FunctionCall</span><span class="p">(</span><span class="nx">FunctionCallPermission</span><span class="p">),</span>  
    <span class="nx">FullAccess</span><span class="p">,</span>  
<span class="p">}</span>
</code></pre></div></div>

<p><strong>2. Function Call Key</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">pub</span> <span class="nx">struct</span> <span class="nx">FunctionCallPermission</span> <span class="p">{</span>  
    <span class="nx">pub</span> <span class="nx">receiver_id</span><span class="p">:</span> <span class="nx">AccountId</span><span class="p">,</span> <span class="c1">// a Specific Contract  </span>
    <span class="nx">pub</span> <span class="nx">method_names</span><span class="p">:</span> <span class="nx">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span> <span class="c1">// Specific Functions  </span>
    <span class="nx">pub</span> <span class="nx">allowance</span><span class="p">:</span> <span class="nx">Option</span><span class="o">&lt;</span><span class="nx">Balance</span><span class="o">&gt;</span><span class="p">,</span> <span class="c1">// Max Gas Fee Payment Amount  </span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="locked-account">Locked Account</h3>
<ul>
  <li>Simply remove all keys through the transaction of the  <code class="language-plaintext highlighter-rouge">DeleteKey</code>  action.</li>
  <li>No one will be able to control the account.</li>
  <li>In other words, after deploying the smart contract account itself, it can be made fully decentralized, allowing only internal transactions to occur.</li>
</ul>

<h2 id="13-a-sample-ux-case">1.3. A Sample UX Case</h2>

<h3 id="typical-dapp-transaction-signing-architecture">Typical dApp Transaction Signing Architecture</h3>

<p><img src="/assets/2023-11-18-near-protocol/Typical dApp Transaction Signing Architecture.webp" alt="" /></p>
<blockquote>
  <p><a href="https://docs.near.org/concepts/web3/near">Source</a></p>
</blockquote>

<ul>
  <li>To execute a specific transaction within the dApp, the user must undergo repeated redirection between the wallet and the client.</li>
  <li><strong>Advantage</strong>: Excellent  <strong>security</strong>  as the private key is not exposed to the client.</li>
  <li><strong>Disadvantage</strong>: Repeated redirections can be annoying for  <strong>users</strong>.</li>
</ul>

<h3 id="dapp-transaction-signing-architecture-using-function-call-key">dApp Transaction Signing Architecture Using Function Call Key</h3>
<blockquote>
  <p>It is possible to address the Disadvantage without significantly compromising the Advantage.</p>
</blockquote>

<p><strong>1. Add Key</strong></p>

<p><img src="/assets/2023-11-18-near-protocol/add-key.webp" alt="" /></p>
<blockquote>
  <p><a href="https://docs.near.org/concepts/web3/near">Source</a></p>
</blockquote>

<p><strong>2. Call a Specific Function within a dAppâ€™s Contract</strong></p>

<p><img src="/assets/2023-11-18-near-protocol/call a specific function within a dapps contract.webp" alt="" /></p>
<blockquote>
  <p><a href="https://docs.near.org/concepts/web3/near">Source</a></p>
</blockquote>

<h1 id="2-transaction-story">2. Transaction Story</h1>

<p><strong>Overall Execution Flow of the Transactions</strong></p>

<p><img src="/assets/2023-11-18-near-protocol/transaction-story.webp" alt="" /></p>
<blockquote>
  <p><a href="https://www.youtube.com/@NEARProtocol">Source</a></p>
</blockquote>

<p><strong>Important Terms</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">Transaction</code></li>
  <li><code class="language-plaintext highlighter-rouge">Action</code></li>
  <li><code class="language-plaintext highlighter-rouge">Receipt</code></li>
</ul>

<h2 id="21-transactions">2.1. Transactions</h2>
<p><strong>A Transaction is:</strong></p>
<ul>
  <li>a set of  <code class="language-plaintext highlighter-rouge">actions</code>  that need to be performed on the receiving account.</li>
  <li>ğŸ™…ğŸ»â€â™‚ï¸ In other words, a transaction is NOT the atomic unit driving state changes in Near Blockchain.</li>
</ul>

<h2 id="22-actions">2.2. Actions</h2>
<p><strong>An Action is:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">the unit of work</code>  that the virtual machine needs to process through a transaction.</li>
  <li>There are a total of 8 types recognizable by the Near Protocol. (You have already checked them above!)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Transfer</span><span class="p">,</span> <span class="c1"># Transfer Tokens  
</span><span class="n">CreateAccount</span><span class="p">,</span> <span class="c1"># Create Accounts  
</span><span class="n">DeleteAccount</span><span class="p">,</span> <span class="c1"># Delete Accounts  
</span><span class="n">DeployContract</span><span class="p">,</span> <span class="c1"># Deploy Contracts  
</span><span class="n">FunctionCall</span><span class="p">,</span> <span class="c1"># Call Functions of Contracts  
</span><span class="n">Stake</span><span class="p">,</span> <span class="c1"># Staking  
</span><span class="n">AddKey</span><span class="p">,</span> <span class="c1"># Add Keys  
</span><span class="n">DeleteKey</span> <span class="c1"># Delete Keys
</span></code></pre></div></div>

<h2 id="23-receipts">2.3. Receipts</h2>
<p><strong>A Receipt is:</strong></p>
<ul>
  <li>the smallest unit executed by the virtual machine, in other words,  <code class="language-plaintext highlighter-rouge">the execution object</code>.</li>
</ul>

<h2 id="24-a-sample-transaction-case">2.4. A Sample Transaction Case</h2>

<h3 id="a-randomly-chosen-transaction-case">A Randomly Chosen Transaction Case</h3>

<p><strong>1. A Transaction Sending 0.02 NEAR</strong></p>

<p><img src="/assets/2023-11-18-near-protocol/A Transaction Sending 0.02 NEAR.webp" alt="" /></p>
<blockquote>
  <p><a href="https://nearblocks.io/txns/6aqjvabatzFkvoBzYmnpEZbAfnLbGo6PsUM6WdpUYxmG#">Source</a></p>
</blockquote>

<p><strong>2. Receipt Executions - (1) TRANSFER Action</strong></p>

<p><img src="/assets/2023-11-18-near-protocol/Receipt Executions TRANSFER Action.webp" alt="" /></p>
<blockquote>
  <p><a href="https://nearblocks.io/txns/6aqjvabatzFkvoBzYmnpEZbAfnLbGo6PsUM6WdpUYxmG#">Source</a></p>
</blockquote>

<p><strong>2. Receipt Executions - (2) Receiving a Refund for the difference between Gas Limit and Gas Used</strong></p>

<p><img src="/assets/2023-11-18-near-protocol/Receipt Executions Receiving a Refund for the difference between Gas Limit and Gas Used.webp" alt="" /></p>
<blockquote>
  <p><a href="https://nearblocks.io/txns/6aqjvabatzFkvoBzYmnpEZbAfnLbGo6PsUM6WdpUYxmG#">Source</a></p>
</blockquote>

<h1 id="3-personal-thoughts">3. Personal Thoughts</h1>

<h3 id="1-protocolized-address-system-for-dns">1. Protocolized Address System for DNS</h3>

<p>It seems that the computational burden on nodes has been compromised to become a user-friendly blockchain. (Due to the increased size of dtypeâ€¦)</p>
<ul>
  <li>Wouldnâ€™t there be a slowdown and an increase in gas fees then?</li>
  <li>It seems that this has been addressed by dividing a block into multiple chunks to create the block.</li>
  <li>Let me study deeper when I have more expertise to check out if there are any potential security drawbacks of this approach. ğŸ˜</li>
</ul>

<p><img src="/assets/2023-11-18-near-protocol/nightshade.webp" alt="" /></p>
<blockquote>
  <p><a href="https://near.org/papers/nightshade">Source</a></p>
</blockquote>

<h3 id="2-key-generation-structure-for-dapp-end-user-ux">2. Key Generation Structure for dApp End-User UX</h3>

<p>Of course, in the initial Add Key situation, wallet redirection still occurs, so it may not be possible to completely alleviate user confusion.</p>
<ul>
  <li>ğŸ—£ï¸<strong>Picky Users (say, Joshua)</strong>: â€œEarlier, my signature was required, but why are you executing things now without it?â€ ğŸ˜ ğŸ˜¡</li>
</ul>

<p><img src="/assets/2023-11-18-near-protocol/add-key.webp" alt="" /></p>
<blockquote>
  <p><a href="https://docs.near.org/concepts/web3/near">Source</a></p>
</blockquote>

<h1 id="4-references">4. References</h1>
<ul>
  <li><strong>Near</strong>  <strong>Whitepaper</strong>:  <a href="https://near.org/papers/nightshade">https://near.org/papers/nightshade</a></li>
  <li><strong>Near Official Docs</strong>:  <a href="https://docs.near.org/">https://docs.near.org</a></li>
  <li><strong>Near Official Dev Docs</strong>:  <a href="https://nomicon.io/">https://nomicon.io</a></li>
  <li><strong>Near Official YouTube Channel</strong>:  <a href="https://www.youtube.com/@NEARProtocol">https://www.youtube.com/@NEARProtocol</a></li>
  <li><strong>Blockchain Explorer (Nearblocks)</strong>:  <a href="https://nearblocks.io/">https://nearblocks.io</a></li>
  <li><strong>Vital Point AI Content</strong>:  <a href="https://www.vitalpoint.ai/understanding-near-keys">https://www.vitalpoint.ai/understanding-near-keys</a></li>
</ul>

<p><img src="/assets/2023-11-18-near-protocol/near-logo.webp" alt="" /></p>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="blockchain" /><summary type="html"><![CDATA[Dive into the intricate world of blockchain with Joshua. Uncover the complexities of Near Protocolâ€™s account model, transaction stories, and personal insights. This article offers a captivating exploration of addresses, private keys, and the execution flow of transactions, providing a unique perspective on user experience and protocol design. Join me on this insightful journey, backed by personal research and a wealth of references from the blockchain realm.]]></summary></entry><entry><title type="html">Intro to Encoding &amp;amp; Decoding Ethereum Contract Functions</title><link href="http://localhost:4000/encoding-and-decoding-ethereum-contract-functions/" rel="alternate" type="text/html" title="Intro to Encoding &amp;amp; Decoding Ethereum Contract Functions" /><published>2023-10-16T00:00:00+09:00</published><updated>2023-10-16T00:00:00+09:00</updated><id>http://localhost:4000/encoding-and-decoding-ethereum-contract-functions</id><content type="html" xml:base="http://localhost:4000/encoding-and-decoding-ethereum-contract-functions/"><![CDATA[<blockquote>
  <p>In this article, I will briefly explore the Ethereum ABI Specification and show you how to decode contract functions when conducting on-chain data analysis. Additionally, I will demonstrate a simple data extraction and analysis case about â€œWho are the Top 10 Recipients of USDT approve Functions?â€ using DuneSQL while handling ABIs.</p>
</blockquote>

<h3 id="contents">CONTENTS</h3>
<ol>
  <li>Argument Types Key Content
    <ul>
      <li>1.1. Elementary Types</li>
      <li>1.2. Fixed-size Types</li>
      <li>1.3. Dynamic-size Types</li>
    </ul>
  </li>
  <li>Key Points of Argument Padding to 32 Bytes Rules</li>
  <li>A Contract Example
    <ul>
      <li>3.1. How to Call <code class="language-plaintext highlighter-rouge">baz(uint32 x, bool y)</code></li>
      <li>3.2. How to Call <code class="language-plaintext highlighter-rouge">bar(bytes3[2])</code></li>
      <li>3.3. How to Call <code class="language-plaintext highlighter-rouge">sam(bytes, bool, uint[])</code></li>
    </ul>
  </li>
  <li>Case Study: Who are the Top 10 Recipients of USDT <code class="language-plaintext highlighter-rouge">approve</code> Functions?
    <ul>
      <li>4.1. Function Selector</li>
      <li>4.2. Extract only the transactions that have called the <code class="language-plaintext highlighter-rouge">approve</code> function on the USDT Contract.</li>
      <li>4.3. Extract the first argument value, <code class="language-plaintext highlighter-rouge">address</code>, from the functions.</li>
      <li>4.4. Now, aggregate the number of unique addresses that executed <code class="language-plaintext highlighter-rouge">approve</code> function, grouped by each <code class="language-plaintext highlighter-rouge">approve</code> recipient, over the past week.</li>
      <li>4.5. Label the <code class="language-plaintext highlighter-rouge">approve</code> recipient addresses based on Dune Tables regarding â€œaddress labelingâ€.</li>
      <li>4.6. The Final Query Results</li>
    </ul>
  </li>
  <li>Letâ€™s Conclude!</li>
  <li>References</li>
</ol>

<hr />

<h1 id="1-argument-types-key-content">1. Argument Types Key Content</h1>

<p>Before diving into the Ethereum ABI specification, letâ€™s take a quick look at the argument data types of Ethereum contracts. Ethereum contract functions can have various parameter data types, and among them, I have listed some of the important types and summarize their key characteristics.</p>

<h2 id="11-elementary-types">1.1. Elementary Types</h2>

<p><code class="language-plaintext highlighter-rouge">uint</code></p>
<ul>
  <li>Same as  <code class="language-plaintext highlighter-rouge">uint256</code>,</li>
  <li>which means it should be considered as  <code class="language-plaintext highlighter-rouge">uint256</code>  type during encoding.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">int</code></p>
<ul>
  <li>Same as  <code class="language-plaintext highlighter-rouge">int256</code>,</li>
  <li>which means it should be considered as  <code class="language-plaintext highlighter-rouge">int256</code>  type during encoding.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">bool</code></p>
<ul>
  <li>Same as  <code class="language-plaintext highlighter-rouge">uint8</code>,</li>
  <li>which means only 0 or 1 can be assigned to it.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">bytes{n}</code></p>
<ul>
  <li>Binary type with a length of n bytes (0 &lt; n â‰¤ 32)</li>
</ul>

<h2 id="12-fixed-size-types">1.2. Fixed-size Types</h2>

<p><code class="language-plaintext highlighter-rouge">{type_name}[{n}]</code></p>
<ul>
  <li>An array with n elements (n â‰¥ 0)</li>
</ul>

<h2 id="13-dynamic-size-types">1.3. Dynamic-size Types</h2>

<p><code class="language-plaintext highlighter-rouge">bytes</code></p>
<ul>
  <li>Binary type with a dynamic length of bytes</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">string</code></p>
<ul>
  <li>A dynamically sized string (assuming itâ€™s UTF-8 encoded)</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">{type_name}[]</code></p>
<ul>
  <li>An array with a dynamic number of elements</li>
</ul>

<h1 id="2-key-points-of-argument-padding-to-32-bytes-rules">2. Key Points of Argument Padding to 32 Bytes Rules</h1>

<p>When calling Ethereum contract functions, you need to encode each argument and input them concatenated. In this process, there are rules regarding â€œlength.â€ To avoid confusion, Iâ€™ve summarized the key rules for you in advance.</p>

<p><code class="language-plaintext highlighter-rouge">uint{n}</code></p>
<ul>
  <li>Padding with preceding 0 to achieve a length of 32 bytes</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">int{n}</code></p>
<ul>
  <li>Padding with preceding 0 to achieve a length of 32 bytes</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">bytes{n}</code></p>
<ul>
  <li>Padding with trailing 0 to achieve a length of 32 bytes</li>
</ul>

<h1 id="3-a-contract-example">3. A Contract Example</h1>

<p>The following example has been taken from  <a href="https://docs.soliditylang.org/en/develop/abi-spec.html#examples">Contract ABI Specification Docs</a>. Let me explain this in simpler terms.</p>

<p><strong>Given the Contract:</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">pragma</span> <span class="nx">solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">16</span><span class="p">;</span>  
  
<span class="nx">contract</span> <span class="nx">Foo</span> <span class="p">{</span>  
  <span class="kd">function</span> <span class="nf">baz</span><span class="p">(</span><span class="nx">uint32</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">bool</span> <span class="nx">y</span><span class="p">)</span> <span class="kr">public</span> <span class="nx">pure</span> <span class="nf">returns </span><span class="p">(</span><span class="nx">bool</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">32</span> <span class="o">||</span> <span class="nx">y</span><span class="p">;</span> <span class="p">}</span>  
  <span class="kd">function</span> <span class="nf">bar</span><span class="p">(</span><span class="nx">bytes3</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kr">public</span> <span class="nx">pure</span> <span class="p">{}</span>  
  <span class="kd">function</span> <span class="nf">sam</span><span class="p">(</span><span class="nx">bytes</span><span class="p">,</span> <span class="nx">bool</span><span class="p">,</span> <span class="nx">uint</span><span class="p">[])</span> <span class="kr">public</span> <span class="nx">pure</span> <span class="p">{}</span>  
<span class="p">}</span>
</code></pre></div></div>

<h2 id="31-how-to-call-bazuint32-x-bool-y">3.1. How to Call <code class="language-plaintext highlighter-rouge">baz(uint32 x, bool y)</code></h2>

<p>Letâ€™s say youâ€™re calling the function in the format of:  <code class="language-plaintext highlighter-rouge">baz(69, true)</code></p>

<p><strong>Function Selector</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">baz(uint32,bool)</code>  â†’ Keccak-256 Hash
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xcdcd77c0992ec5bbfc459984220f8c45084cc24d9b6efed1fae540db8de801d2</span>
</code></pre></div>    </div>
  </li>
  <li>Slice the left 4 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xcdcd77c0</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Parameter 1:</strong>  <code class="language-plaintext highlighter-rouge">69</code></p>
<ul>
  <li>Convert it to hexadecimal.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x45</span>
</code></pre></div>    </div>
  </li>
  <li>Left pad it to a length of 32 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000045</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Parameter 2:</strong>  <code class="language-plaintext highlighter-rouge">true</code></p>
<ul>
  <li>Convert it to uint8.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span>
</code></pre></div>    </div>
  </li>
  <li>Left pad it to a length of 32 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000001</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>The Final Encoding with Concatenating All</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xcdcd77c0</span> <span class="c1"># Function Selector  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000045</span> <span class="c1"># 69  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000001</span> <span class="c1"># true  
</span>  
<span class="c1"># Concat  
</span><span class="mh">0xdcdcd77c000000000000000000000000000000000000000000000000000000000000000450000000000000000000000000000000000000000000000000000000000000001</span>
</code></pre></div></div>

<h2 id="32-how-to-call-barbytes32">3.2. How to Call <code class="language-plaintext highlighter-rouge">bar(bytes3[2])</code></h2>

<p>Letâ€™s say youâ€™re calling the function in the format of:  <code class="language-plaintext highlighter-rouge">baz("abc", "def")</code></p>

<p><strong>Function Selector</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">bar(bytes3[2])</code>  â†’ Keccak-256 Hash
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xfce353f601a3db60cb33e4b6ef4f91e4465eaf93c292b64fcde1bf4ba6819b6a</span>
</code></pre></div>    </div>
  </li>
  <li>Slice the left 4 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xfce353f6</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Parameter 1:</strong>  <code class="language-plaintext highlighter-rouge">â€œabcâ€</code></p>
<ul>
  <li>Convert it to utf-8 bytes (<a href="https://onlinetools.com/utf8/convert-utf8-to-bytes">String to UTF-8 Bytes Convertor</a>)
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">616263</span>
</code></pre></div>    </div>
  </li>
  <li>Right pad it to a length of 32 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x6162630000000000000000000000000000000000000000000000000000000000</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Parameter 2</strong>:  <code class="language-plaintext highlighter-rouge">â€œdefâ€</code></p>
<ul>
  <li>Convert it to utf-8 bytes (<a href="https://onlinetools.com/utf8/convert-utf8-to-bytes">String to UTF-8 Bytes Convertor</a>)
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">646566</span>
</code></pre></div>    </div>
  </li>
  <li>Right pad it to a length of 32 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x6465660000000000000000000000000000000000000000000000000000000000</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>The Final Encoding with Concatenating All</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xfce353f6</span> <span class="c1"># Function Selector  
</span><span class="mi">6162630000000000000000000000000000000000000000000000000000000000</span> <span class="c1"># "abc"  
</span><span class="mi">6465660000000000000000000000000000000000000000000000000000000000</span> <span class="c1"># "def"  
</span>  
<span class="c1"># Concat  
</span><span class="mh">0xfce353f661626300000000000000000000000000000000000000000000000000000000006465660000000000000000000000000000000000000000000000000000000000</span>
</code></pre></div></div>

<h2 id="33-how-to-call-sambytes-bool-uint">3.3. How to Call <code class="language-plaintext highlighter-rouge">sam(bytes, bool, uint[])</code></h2>

<p>Letâ€™s say youâ€™re calling the function in the format of:  <code class="language-plaintext highlighter-rouge">sam(â€œdaveâ€, true, [1, 2, 3])</code></p>

<p><strong>Function Selector</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">sam(bytes,bool,uint256[])</code>  â†’ Keccak-256 Hash</li>
  <li>Note that  <code class="language-plaintext highlighter-rouge">uint</code>  is replaced with its canonical representation  <code class="language-plaintext highlighter-rouge">uint256</code>.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xa5643bf27e2786816613d3eeb0b62650200b5a98766dfcfd4428f296fb56d043</span>
</code></pre></div>    </div>
  </li>
  <li>Slice the left 4 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xa5643bf2</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>Parameters</strong></p>
<ul>
  <li>In the order of: â€œ<strong>iLoc &gt; Len &gt; Value</strong>â€</li>
</ul>

<p><img src="/assets/2023-10-16-encoding-and-decoding-ethereum-contract-functions/parameters.webp" alt="" /></p>
<blockquote>
  <p>made by Joshua</p>
</blockquote>

<p><strong>The Final Encoding with Concatenating All</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0xa5643bf2</span> <span class="c1"># Function Selector  
</span>  
<span class="mh">0x0000000000000000000000000000000000000000000000000000000000000060</span> <span class="c1"># 1st Param iLoc : 96 bytes  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000001</span> <span class="c1"># 2nd Param Value : true   
</span><span class="mh">0x00000000000000000000000000000000000000000000000000000000000000a0</span> <span class="c1"># 3rd Param iLoc : 160 bytes  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000004</span> <span class="c1"># 1st Param Len : 4 bytes  
</span><span class="mh">0x6461766500000000000000000000000000000000000000000000000000000000</span> <span class="c1"># 1sst Param Value : "dave"  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000003</span> <span class="c1"># 3rd Params Len : 3 items  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000001</span> <span class="c1"># 3rd Param Value (item 0) : 1  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000002</span> <span class="c1"># 3rd Param Value (item 1) : 2  
</span><span class="mh">0x0000000000000000000000000000000000000000000000000000000000000003</span> <span class="c1"># 3rd Param Value (item 2) : 3  
</span>  
<span class="c1"># Concat  
</span><span class="mh">0xa5643bf20000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000464617665000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000003</span>
</code></pre></div></div>

<h1 id="4-case-study-who-are-the-top-10-recipients-of-usdt-approve-functions">4. Case Study: Who are the Top 10 Recipients of USDT <code class="language-plaintext highlighter-rouge">approve</code> Functions?</h1>

<p>According to  <a href="https://docs.openzeppelin.com/contracts/2.x/api/token/erc20">ERC-20 Interface</a>, it is possible to delegate the permission to use a specific token (the authority to transfer the token, specifically) to a particular account using the <code class="language-plaintext highlighter-rouge">approve</code> function. This permission is frequently requested, particularly in DeFi platforms. In this case study, I aim to aggregate and analyze the top 10 accounts that people commonly delegate their USDT through <code class="language-plaintext highlighter-rouge">approve</code> function.</p>

<h2 id="41-function-selector">4.1. Function Selector</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">approve(address,uint256)</code>  â†’ Keccak-256 Hash
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x095ea7b334ae44009aa867bfb386f5c3b4b443ac6f0ee573fa91c4608fbadfba</span>
</code></pre></div>    </div>
  </li>
  <li>Slice the left 4 bytes.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x095ea7b3</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="42-extract-only-the-transactions-that-have-called-the-approve-function-on-the-usdt-contract">4.2. Extract only the transactions that have called the <code class="language-plaintext highlighter-rouge">approve</code> function on the USDT Contract.</h2>

<ul>
  <li>For more info about <code class="language-plaintext highlighter-rouge">BYTEARRAY_STARTS_WITH</code> Function, click  <a href="https://dune.com/docs/query/DuneSQL-reference/Functions-and-operators/varbinary/#bytearray_starts_with">here</a>.</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
    <span class="o">*</span>  
<span class="k">FROM</span>  
    <span class="n">ethereum</span><span class="p">.</span><span class="n">transactions</span>  
<span class="k">WHERE</span>  
    <span class="nv">"to"</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xdAC17F958D2ee523a2206206994597C13D831ec7</span> <span class="c1">-- USDT ERC-20 Contract  </span>
    <span class="k">AND</span> <span class="n">BYTEARRAY_STARTS_WITH</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">0</span><span class="n">x095ea7b3</span><span class="p">)</span> <span class="c1">-- approve(address,uint256) Function Call</span>
</code></pre></div></div>

<h2 id="43-extract-the-first-argument-value-address-from-the-functions">4.3. Extract the first argument value, <code class="language-plaintext highlighter-rouge">address</code>, from the functions.</h2>

<ul>
  <li>For more info about <code class="language-plaintext highlighter-rouge">BYTEARRAY_SUBSTRING</code> Function, click  <a href="https://dune.com/docs/query/DuneSQL-reference/Functions-and-operators/varbinary/#bytearray_substring">here</a>.</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
    <span class="n">BYTEARRAY_SUBSTRING</span><span class="p">(</span>  
        <span class="n">BYTEARRAY_SUBSTRING</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>  
        <span class="mi">13</span><span class="p">,</span>  
        <span class="mi">20</span>  
    <span class="p">)</span> <span class="k">AS</span> <span class="n">approved_to</span>  
<span class="k">FROM</span>  
    <span class="n">ethereum</span><span class="p">.</span><span class="n">transactions</span>  
<span class="k">WHERE</span>  
    <span class="nv">"to"</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xdAC17F958D2ee523a2206206994597C13D831ec7</span> <span class="c1">-- USDT ERC-20 Contract  </span>
    <span class="k">AND</span> <span class="n">BYTEARRAY_STARTS_WITH</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">0</span><span class="n">x095ea7b3</span><span class="p">)</span> <span class="c1">-- approve(address,uint256) Function Call</span>
</code></pre></div></div>

<h2 id="44-now-aggregate-the-number-of-unique-addresses-that-executed-approve-function-grouped-by-each-approve-recipient-over-the-past-week">4.4. Now, aggregate the number of unique addresses that executed <code class="language-plaintext highlighter-rouge">approve</code> function, grouped by each <code class="language-plaintext highlighter-rouge">approve</code> recipient, over the past week.</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>  
    <span class="n">BYTEARRAY_SUBSTRING</span><span class="p">(</span>  
        <span class="n">BYTEARRAY_SUBSTRING</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>  
        <span class="mi">13</span><span class="p">,</span>  
        <span class="mi">20</span>  
    <span class="p">)</span> <span class="k">AS</span> <span class="n">approved_to</span><span class="p">,</span>  
    <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="nv">"from"</span><span class="p">)</span> <span class="k">AS</span> <span class="n">approved_from_cnt</span>  
<span class="k">FROM</span>  
    <span class="n">ethereum</span><span class="p">.</span><span class="n">transactions</span>  
<span class="k">WHERE</span>  
    <span class="k">CAST</span><span class="p">(</span><span class="n">block_date</span> <span class="k">AS</span> <span class="nb">DATE</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="k">CURRENT_DATE</span><span class="p">)</span> <span class="c1">-- Recent 7 Days  </span>
    <span class="k">AND</span> <span class="nv">"to"</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xdAC17F958D2ee523a2206206994597C13D831ec7</span> <span class="c1">-- USDT ERC-20 Contract  </span>
    <span class="k">AND</span> <span class="n">BYTEARRAY_STARTS_WITH</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">0</span><span class="n">x095ea7b3</span><span class="p">)</span> <span class="c1">-- approve(address,uint256) Function Call  </span>
<span class="k">GROUP</span> <span class="k">BY</span>  
    <span class="mi">1</span>
</code></pre></div></div>

<h2 id="45-label-the-approve-recipient-addresses-based-on-dune-tables-regarding-address-labeling">4.5. Label the <code class="language-plaintext highlighter-rouge">approve</code> recipient addresses based on Dune Tables regarding â€œaddress labelingâ€.</h2>

<ul>
  <li>Looking at the original address values alone does not provide any meaningful information, as yâ€™all know here.</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span>  
<span class="n">CTE_approves</span> <span class="k">AS</span> <span class="p">(</span>  
    <span class="k">SELECT</span>  
        <span class="n">BYTEARRAY_SUBSTRING</span><span class="p">(</span>  
            <span class="n">BYTEARRAY_SUBSTRING</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>  
            <span class="mi">13</span><span class="p">,</span>  
            <span class="mi">20</span>  
        <span class="p">)</span> <span class="k">AS</span> <span class="n">approved_to</span><span class="p">,</span>  
        <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="nv">"from"</span><span class="p">)</span> <span class="k">AS</span> <span class="n">approved_from_cnt</span>  
    <span class="k">FROM</span>  
        <span class="n">ethereum</span><span class="p">.</span><span class="n">transactions</span>  
    <span class="k">WHERE</span>  
        <span class="k">CAST</span><span class="p">(</span><span class="n">block_date</span> <span class="k">AS</span> <span class="nb">DATE</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">DATE_ADD</span><span class="p">(</span><span class="s1">'DAY'</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="k">CURRENT_DATE</span><span class="p">)</span> <span class="c1">-- Recent 7 Days  </span>
        <span class="k">AND</span> <span class="nv">"to"</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xdAC17F958D2ee523a2206206994597C13D831ec7</span> <span class="c1">-- USDT ERC-20 Contract  </span>
        <span class="k">AND</span> <span class="n">BYTEARRAY_STARTS_WITH</span><span class="p">(</span><span class="k">data</span><span class="p">,</span> <span class="mi">0</span><span class="n">x095ea7b3</span><span class="p">)</span> <span class="c1">-- approve(address,uint256) Function Call  </span>
    <span class="k">GROUP</span> <span class="k">BY</span>  
        <span class="mi">1</span>  
<span class="p">)</span>  
  
<span class="k">SELECT</span>  
    <span class="n">MAIN</span><span class="p">.</span><span class="n">approved_to</span><span class="p">,</span>  
    <span class="n">COALESCE</span><span class="p">(</span>  
        <span class="n">SUB1</span><span class="p">.</span><span class="n">dex_name</span> <span class="o">||</span> <span class="s1">' - '</span> <span class="o">||</span> <span class="n">SUB1</span><span class="p">.</span><span class="n">distinct_name</span><span class="p">,</span>  
        <span class="n">SUB2</span><span class="p">.</span><span class="n">project</span> <span class="o">||</span> <span class="s1">' - '</span> <span class="o">||</span> <span class="n">SUB2</span><span class="p">.</span><span class="n">project_type</span><span class="p">,</span>  
        <span class="n">SUB3</span><span class="p">.</span><span class="n">bridge_name</span> <span class="o">||</span> <span class="s1">' - '</span> <span class="o">||</span> <span class="n">SUB3</span><span class="p">.</span><span class="n">description</span><span class="p">,</span>  
        <span class="n">SUB4</span><span class="p">.</span><span class="n">cex_name</span> <span class="o">||</span> <span class="s1">' - '</span> <span class="o">||</span> <span class="n">SUB4</span><span class="p">.</span><span class="n">distinct_name</span><span class="p">,</span>  
        <span class="s1">'Unknown'</span>  
    <span class="p">)</span> <span class="k">AS</span> <span class="n">name</span><span class="p">,</span>  
    <span class="n">MAIN</span><span class="p">.</span><span class="n">approved_from_cnt</span> <span class="k">AS</span> <span class="n">addresses_cnt</span>  
<span class="k">FROM</span>  
    <span class="n">CTE_approves</span> <span class="n">MAIN</span>  
<span class="k">LEFT</span> <span class="k">JOIN</span>  
    <span class="n">addresses_ethereum</span><span class="p">.</span><span class="n">dex</span> <span class="n">SUB1</span> <span class="c1">-- DEX named addresses  </span>
    <span class="k">ON</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">approved_to</span> <span class="o">=</span> <span class="n">SUB1</span><span class="p">.</span><span class="n">address</span>  
<span class="k">LEFT</span> <span class="k">JOIN</span>  
    <span class="n">addresses_ethereum</span><span class="p">.</span><span class="n">defi</span> <span class="n">SUB2</span> <span class="c1">-- DeFi named addresses  </span>
    <span class="k">ON</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">approved_to</span> <span class="o">=</span> <span class="n">SUB2</span><span class="p">.</span><span class="n">address</span>  
<span class="k">LEFT</span> <span class="k">JOIN</span>  
    <span class="n">addresses_ethereum</span><span class="p">.</span><span class="n">bridges</span> <span class="n">SUB3</span> <span class="c1">-- Bridge named addresses  </span>
    <span class="k">ON</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">approved_to</span> <span class="o">=</span> <span class="n">SUB3</span><span class="p">.</span><span class="n">address</span>  
<span class="k">LEFT</span> <span class="k">JOIN</span>  
    <span class="n">addresses_ethereum</span><span class="p">.</span><span class="n">cex</span> <span class="n">SUB4</span> <span class="c1">-- CEX named addresses  </span>
    <span class="k">ON</span> <span class="n">MAIN</span><span class="p">.</span><span class="n">approved_to</span> <span class="o">=</span> <span class="n">SUB4</span><span class="p">.</span><span class="n">address</span>  
<span class="k">ORDER</span> <span class="k">BY</span>  
    <span class="mi">3</span> <span class="k">DESC</span>  
<span class="k">LIMIT</span>  
    <span class="mi">10</span>  
<span class="p">;</span>
</code></pre></div></div>

<h2 id="46-the-final-query-results">4.6. The Final Query Results</h2>

<p><img src="/assets/2023-10-16-encoding-and-decoding-ethereum-contract-functions/query-results.webp" alt="" /></p>
<blockquote>
  <p>Dune Analytics</p>
</blockquote>

<h1 id="5-lets-conclude">5. Letâ€™s Conclude!</h1>

<p>So far, we have delved into <strong>the Ethereumâ€™s ABI Specification</strong>, learned how data is encoded when transactions call contract functions, and understood how to extract meaningful insights by decoding specific function names and arguments from Ethereum transactions data.</p>

<p>In fact, Dune Analytics, Etherscan, and many other on-chain data platforms all incorporate these decoding processes internally.</p>

<p>Hopefully this article will serve as an excellent foundation for your future, more detailed and complex on-chain data analysis endeavors.</p>

<h1 id="6-references">6. References</h1>

<ul>
  <li><a href="https://docs.soliditylang.org/en/develop/abi-spec.html#function-selector-and-argument-encoding">Contract ABI Specification</a></li>
  <li><a href="https://docs.openzeppelin.com/contracts/4.x/api/token/erc721">OpenZeppelin Docs</a></li>
  <li><a href="https://dune.com/joshua_web3">Dune Analytics</a></li>
</ul>

<hr />

<h2 id="published-by-joshua-kim"><em>Published by</em> Joshua Kim</h2>
<p><img src="/assets/profile/joshua-profile.png" alt="Joshua Kim" /></p>]]></content><author><name></name></author><category term="english" /><category term="blockchain" /><category term="on_chain_data" /><category term="sql" /><summary type="html"><![CDATA[In this article, I will briefly explore the Ethereum ABI Specification and show you how to decode contract functions when conducting on-chain data analysis. Additionally, I will demonstrate a simple data extraction and analysis case about â€œWho are the Top 10 Recipients of USDT approve Functions?â€ using DuneSQL while handling ABIs.]]></summary></entry></feed>